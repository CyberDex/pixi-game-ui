var qc=Object.defineProperty;var Kc=(i,t,e)=>t in i?qc(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var ot=(i,t,e)=>(Kc(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();var Pi=(i=>(i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2",i))(Pi||{}),zh=(i=>(i[i.UNKNOWN=0]="UNKNOWN",i[i.WEBGL=1]="WEBGL",i[i.CANVAS=2]="CANVAS",i))(zh||{}),Qn=(i=>(i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL",i))(Qn||{}),N=(i=>(i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR",i))(N||{}),je=(i=>(i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN",i))(je||{}),P=(i=>(i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL",i))(P||{}),Xi=(i=>(i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",i))(Xi||{}),K=(i=>(i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT",i))(K||{}),to=(i=>(i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT",i))(to||{}),De=(i=>(i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR",i))(De||{}),Ps=(i=>(i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",i))(Ps||{}),Ei=(i=>(i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL",i))(Ei||{}),ni=(i=>(i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",i))(ni||{}),di=(i=>(i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT",i))(di||{}),Wo=(i=>(i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL",i))(Wo||{}),re=(i=>(i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp",i))(re||{}),wt=(i=>(i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE",i[i.COLOR=4]="COLOR",i))(wt||{}),xt=(i=>(i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH",i))(xt||{}),Me=(i=>(i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",i))(Me||{});const Zc={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")},O={ADAPTER:Zc,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var yn=/iPhone/i,Ta=/iPod/i,Sa=/iPad/i,Ea=/\biOS-universal(?:.+)Mac\b/i,xn=/\bAndroid(?:.+)Mobile\b/i,Aa=/Android/i,ki=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Qs=/Silk/i,Le=/Windows Phone/i,Ca=/\bWindows(?:.+)ARM\b/i,Ia=/BlackBerry/i,Ra=/BB10/i,Pa=/Opera Mini/i,Ma=/\b(CriOS|Chrome)(?:.+)Mobile/i,ka=/Mobile(?:.+)Firefox\b/i,Ba=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function Jc(i){return function(t){return t.test(i)}}function La(i){var t={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var e=t.userAgent,s=e.split("[FBAN");typeof s[1]<"u"&&(e=s[0]),s=e.split("Twitter"),typeof s[1]<"u"&&(e=s[0]);var r=Jc(e),n={apple:{phone:r(yn)&&!r(Le),ipod:r(Ta),tablet:!r(yn)&&(r(Sa)||Ba(t))&&!r(Le),universal:r(Ea),device:(r(yn)||r(Ta)||r(Sa)||r(Ea)||Ba(t))&&!r(Le)},amazon:{phone:r(ki),tablet:!r(ki)&&r(Qs),device:r(ki)||r(Qs)},android:{phone:!r(Le)&&r(ki)||!r(Le)&&r(xn),tablet:!r(Le)&&!r(ki)&&!r(xn)&&(r(Qs)||r(Aa)),device:!r(Le)&&(r(ki)||r(Qs)||r(xn)||r(Aa))||r(/\bokhttp\b/i)},windows:{phone:r(Le),tablet:r(Ca),device:r(Le)||r(Ca)},other:{blackberry:r(Ia),blackberry10:r(Ra),opera:r(Pa),firefox:r(ka),chrome:r(Ma),device:r(Ia)||r(Ra)||r(Pa)||r(ka)||r(Ma)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const Qc=La.default??La,xi=Qc(globalThis.navigator);O.RETINA_PREFIX=/@([0-9\.]+)x/;O.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ai={},tu={get exports(){return Ai},set exports(i){Ai=i}};(function(i){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function r(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function n(h,l,c,d,u){if(typeof c!="function")throw new TypeError("The listener must be a function");var p=new r(c,d||h,u),f=e?e+l:l;return h._events[f]?h._events[f].fn?h._events[f]=[h._events[f],p]:h._events[f].push(p):(h._events[f]=p,h._eventsCount++),h}function o(h,l){--h._eventsCount===0?h._events=new s:delete h._events[l]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],c,d;if(this._eventsCount===0)return l;for(d in c=this._events)t.call(c,d)&&l.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},a.prototype.listeners=function(l){var c=e?e+l:l,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var u=0,p=d.length,f=new Array(p);u<p;u++)f[u]=d[u].fn;return f},a.prototype.listenerCount=function(l){var c=e?e+l:l,d=this._events[c];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,c,d,u,p,f){var g=e?e+l:l;if(!this._events[g])return!1;var m=this._events[g],x=arguments.length,y,_;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),x){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,d),!0;case 4:return m.fn.call(m.context,c,d,u),!0;case 5:return m.fn.call(m.context,c,d,u,p),!0;case 6:return m.fn.call(m.context,c,d,u,p,f),!0}for(_=1,y=new Array(x-1);_<x;_++)y[_-1]=arguments[_];m.fn.apply(m.context,y)}else{var v=m.length,w;for(_=0;_<v;_++)switch(m[_].once&&this.removeListener(l,m[_].fn,void 0,!0),x){case 1:m[_].fn.call(m[_].context);break;case 2:m[_].fn.call(m[_].context,c);break;case 3:m[_].fn.call(m[_].context,c,d);break;case 4:m[_].fn.call(m[_].context,c,d,u);break;default:if(!y)for(w=1,y=new Array(x-1);w<x;w++)y[w-1]=arguments[w];m[_].fn.apply(m[_].context,y)}}return!0},a.prototype.on=function(l,c,d){return n(this,l,c,d,!1)},a.prototype.once=function(l,c,d){return n(this,l,c,d,!0)},a.prototype.removeListener=function(l,c,d,u){var p=e?e+l:l;if(!this._events[p])return this;if(!c)return o(this,p),this;var f=this._events[p];if(f.fn)f.fn===c&&(!u||f.once)&&(!d||f.context===d)&&o(this,p);else{for(var g=0,m=[],x=f.length;g<x;g++)(f[g].fn!==c||u&&!f[g].once||d&&f[g].context!==d)&&m.push(f[g]);m.length?this._events[p]=m.length===1?m[0]:m:o(this,p)}return this},a.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&o(this,c)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,i.exports=a})(tu);var Er={},eu={get exports(){return Er},set exports(i){Er=i}};eu.exports=Xr;Er.default=Xr;function Xr(i,t,e){e=e||2;var s=t&&t.length,r=s?t[0]*e:i.length,n=Hh(i,0,r,e,!0),o=[];if(!n||n.next===n.prev)return o;var a,h,l,c,d,u,p;if(s&&(n=ou(i,t,n,e)),i.length>80*e){a=l=i[0],h=c=i[1];for(var f=e;f<r;f+=e)d=i[f],u=i[f+1],d<a&&(a=d),u<h&&(h=u),d>l&&(l=d),u>c&&(c=u);p=Math.max(l-a,c-h),p=p!==0?32767/p:0}return Ms(n,o,e,a,h,p,0),o}function Hh(i,t,e,s,r){var n,o;if(r===so(i,t,e,s)>0)for(n=t;n<e;n+=s)o=Oa(n,i[n],i[n+1],o);else for(n=e-s;n>=t;n-=s)o=Oa(n,i[n],i[n+1],o);return o&&$r(o,o.next)&&(Bs(o),o=o.next),o}function Ci(i,t){if(!i)return i;t||(t=i);var e=i,s;do if(s=!1,!e.steiner&&($r(e,e.next)||ut(e.prev,e,e.next)===0)){if(Bs(e),e=t=e.prev,e===e.next)break;s=!0}else e=e.next;while(s||e!==t);return t}function Ms(i,t,e,s,r,n,o){if(i){!o&&n&&uu(i,s,r,n);for(var a=i,h,l;i.prev!==i.next;){if(h=i.prev,l=i.next,n?su(i,s,r,n):iu(i)){t.push(h.i/e|0),t.push(i.i/e|0),t.push(l.i/e|0),Bs(i),i=l.next,a=l.next;continue}if(i=l,i===a){o?o===1?(i=ru(Ci(i),t,e),Ms(i,t,e,s,r,n,2)):o===2&&nu(i,t,e,s,r,n):Ms(Ci(i),t,e,s,r,n,1);break}}}}function iu(i){var t=i.prev,e=i,s=i.next;if(ut(t,e,s)>=0)return!1;for(var r=t.x,n=e.x,o=s.x,a=t.y,h=e.y,l=s.y,c=r<n?r<o?r:o:n<o?n:o,d=a<h?a<l?a:l:h<l?h:l,u=r>n?r>o?r:o:n>o?n:o,p=a>h?a>l?a:l:h>l?h:l,f=s.next;f!==t;){if(f.x>=c&&f.x<=u&&f.y>=d&&f.y<=p&&Di(r,a,n,h,o,l,f.x,f.y)&&ut(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function su(i,t,e,s){var r=i.prev,n=i,o=i.next;if(ut(r,n,o)>=0)return!1;for(var a=r.x,h=n.x,l=o.x,c=r.y,d=n.y,u=o.y,p=a<h?a<l?a:l:h<l?h:l,f=c<d?c<u?c:u:d<u?d:u,g=a>h?a>l?a:l:h>l?h:l,m=c>d?c>u?c:u:d>u?d:u,x=eo(p,f,t,e,s),y=eo(g,m,t,e,s),_=i.prevZ,v=i.nextZ;_&&_.z>=x&&v&&v.z<=y;){if(_.x>=p&&_.x<=g&&_.y>=f&&_.y<=m&&_!==r&&_!==o&&Di(a,c,h,d,l,u,_.x,_.y)&&ut(_.prev,_,_.next)>=0||(_=_.prevZ,v.x>=p&&v.x<=g&&v.y>=f&&v.y<=m&&v!==r&&v!==o&&Di(a,c,h,d,l,u,v.x,v.y)&&ut(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;_&&_.z>=x;){if(_.x>=p&&_.x<=g&&_.y>=f&&_.y<=m&&_!==r&&_!==o&&Di(a,c,h,d,l,u,_.x,_.y)&&ut(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;v&&v.z<=y;){if(v.x>=p&&v.x<=g&&v.y>=f&&v.y<=m&&v!==r&&v!==o&&Di(a,c,h,d,l,u,v.x,v.y)&&ut(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function ru(i,t,e){var s=i;do{var r=s.prev,n=s.next.next;!$r(r,n)&&Wh(r,s,s.next,n)&&ks(r,n)&&ks(n,r)&&(t.push(r.i/e|0),t.push(s.i/e|0),t.push(n.i/e|0),Bs(s),Bs(s.next),s=i=n),s=s.next}while(s!==i);return Ci(s)}function nu(i,t,e,s,r,n){var o=i;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&pu(o,a)){var h=Xh(o,a);o=Ci(o,o.next),h=Ci(h,h.next),Ms(o,t,e,s,r,n,0),Ms(h,t,e,s,r,n,0);return}a=a.next}o=o.next}while(o!==i)}function ou(i,t,e,s){var r=[],n,o,a,h,l;for(n=0,o=t.length;n<o;n++)a=t[n]*s,h=n<o-1?t[n+1]*s:i.length,l=Hh(i,a,h,s,!1),l===l.next&&(l.steiner=!0),r.push(fu(l));for(r.sort(au),n=0;n<r.length;n++)e=hu(r[n],e);return e}function au(i,t){return i.x-t.x}function hu(i,t){var e=lu(i,t);if(!e)return t;var s=Xh(e,i);return Ci(s,s.next),Ci(e,e.next)}function lu(i,t){var e=t,s=i.x,r=i.y,n=-1/0,o;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var a=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=s&&a>n&&(n=a,o=e.x<e.next.x?e:e.next,a===s))return o}e=e.next}while(e!==t);if(!o)return null;var h=o,l=o.x,c=o.y,d=1/0,u;e=o;do s>=e.x&&e.x>=l&&s!==e.x&&Di(r<c?s:n,r,l,c,r<c?n:s,r,e.x,e.y)&&(u=Math.abs(r-e.y)/(s-e.x),ks(e,i)&&(u<d||u===d&&(e.x>o.x||e.x===o.x&&cu(o,e)))&&(o=e,d=u)),e=e.next;while(e!==h);return o}function cu(i,t){return ut(i.prev,i,t.prev)<0&&ut(t.next,i,i.next)<0}function uu(i,t,e,s){var r=i;do r.z===0&&(r.z=eo(r.x,r.y,t,e,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,du(r)}function du(i){var t,e,s,r,n,o,a,h,l=1;do{for(e=i,i=null,n=null,o=0;e;){for(o++,s=e,a=0,t=0;t<l&&(a++,s=s.nextZ,!!s);t++);for(h=l;a>0||h>0&&s;)a!==0&&(h===0||!s||e.z<=s.z)?(r=e,e=e.nextZ,a--):(r=s,s=s.nextZ,h--),n?n.nextZ=r:i=r,r.prevZ=n,n=r;e=s}n.nextZ=null,l*=2}while(o>1);return i}function eo(i,t,e,s,r){return i=(i-e)*r|0,t=(t-s)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function fu(i){var t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function Di(i,t,e,s,r,n,o,a){return(r-o)*(t-a)>=(i-o)*(n-a)&&(i-o)*(s-a)>=(e-o)*(t-a)&&(e-o)*(n-a)>=(r-o)*(s-a)}function pu(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!gu(i,t)&&(ks(i,t)&&ks(t,i)&&mu(i,t)&&(ut(i.prev,i,t.prev)||ut(i,t.prev,t))||$r(i,t)&&ut(i.prev,i,i.next)>0&&ut(t.prev,t,t.next)>0)}function ut(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function $r(i,t){return i.x===t.x&&i.y===t.y}function Wh(i,t,e,s){var r=er(ut(i,t,e)),n=er(ut(i,t,s)),o=er(ut(e,s,i)),a=er(ut(e,s,t));return!!(r!==n&&o!==a||r===0&&tr(i,e,t)||n===0&&tr(i,s,t)||o===0&&tr(e,i,s)||a===0&&tr(e,t,s))}function tr(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function er(i){return i>0?1:i<0?-1:0}function gu(i,t){var e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&Wh(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function ks(i,t){return ut(i.prev,i,i.next)<0?ut(i,t,i.next)>=0&&ut(i,i.prev,t)>=0:ut(i,t,i.prev)<0||ut(i,i.next,t)<0}function mu(i,t){var e=i,s=!1,r=(i.x+t.x)/2,n=(i.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&r<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(s=!s),e=e.next;while(e!==i);return s}function Xh(i,t){var e=new io(i.i,i.x,i.y),s=new io(t.i,t.x,t.y),r=i.next,n=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,s.next=e,e.prev=s,n.next=s,s.prev=n,s}function Oa(i,t,e,s){var r=new io(i,t,e);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function Bs(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function io(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Xr.deviation=function(i,t,e,s){var r=t&&t.length,n=r?t[0]*e:i.length,o=Math.abs(so(i,0,n,e));if(r)for(var a=0,h=t.length;a<h;a++){var l=t[a]*e,c=a<h-1?t[a+1]*e:i.length;o-=Math.abs(so(i,l,c,e))}var d=0;for(a=0;a<s.length;a+=3){var u=s[a]*e,p=s[a+1]*e,f=s[a+2]*e;d+=Math.abs((i[u]-i[f])*(i[p+1]-i[u+1])-(i[u]-i[p])*(i[f+1]-i[u+1]))}return o===0&&d===0?0:Math.abs((d-o)/o)};function so(i,t,e,s){for(var r=0,n=t,o=e-s;n<e;n+=s)r+=(i[o]-i[n])*(i[n+1]+i[o+1]),o=n;return r}Xr.flatten=function(i){for(var t=i[0][0].length,e={vertices:[],holes:[],dimensions:t},s=0,r=0;r<i.length;r++){for(var n=0;n<i[r].length;n++)for(var o=0;o<t;o++)e.vertices.push(i[r][n][o]);r>0&&(s+=i[r-1].length,e.holes.push(s))}return e};var Ar={},_u={get exports(){return Ar},set exports(i){Ar=i}};/*! https://mths.be/punycode v1.3.2 by @mathias */(function(i,t){(function(e){var s=t&&!t.nodeType&&t,r=i&&!i.nodeType&&i,n=typeof vn=="object"&&vn;(n.global===n||n.window===n||n.self===n)&&(e=n);var o,a=2147483647,h=36,l=1,c=26,d=38,u=700,p=72,f=128,g="-",m=/^xn--/,x=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},v=h-l,w=Math.floor,E=String.fromCharCode,T;function b(R){throw RangeError(_[R])}function S(R,B){for(var G=R.length,Z=[];G--;)Z[G]=B(R[G]);return Z}function A(R,B){var G=R.split("@"),Z="";G.length>1&&(Z=G[0]+"@",R=G[1]),R=R.replace(y,".");var z=R.split("."),nt=S(z,B).join(".");return Z+nt}function L(R){for(var B=[],G=0,Z=R.length,z,nt;G<Z;)z=R.charCodeAt(G++),z>=55296&&z<=56319&&G<Z?(nt=R.charCodeAt(G++),(nt&64512)==56320?B.push(((z&1023)<<10)+(nt&1023)+65536):(B.push(z),G--)):B.push(z);return B}function Y(R){return S(R,function(B){var G="";return B>65535&&(B-=65536,G+=E(B>>>10&1023|55296),B=56320|B&1023),G+=E(B),G}).join("")}function C(R){return R-48<10?R-22:R-65<26?R-65:R-97<26?R-97:h}function I(R,B){return R+22+75*(R<26)-((B!=0)<<5)}function q(R,B,G){var Z=0;for(R=G?w(R/u):R>>1,R+=w(R/B);R>v*c>>1;Z+=h)R=w(R/v);return w(Z+(v+1)*R/(R+d))}function Q(R){var B=[],G=R.length,Z,z=0,nt=f,_t=p,At,Bt,Yt,Pt,ht,yt,bt,we,Te;for(At=R.lastIndexOf(g),At<0&&(At=0),Bt=0;Bt<At;++Bt)R.charCodeAt(Bt)>=128&&b("not-basic"),B.push(R.charCodeAt(Bt));for(Yt=At>0?At+1:0;Yt<G;){for(Pt=z,ht=1,yt=h;Yt>=G&&b("invalid-input"),bt=C(R.charCodeAt(Yt++)),(bt>=h||bt>w((a-z)/ht))&&b("overflow"),z+=bt*ht,we=yt<=_t?l:yt>=_t+c?c:yt-_t,!(bt<we);yt+=h)Te=h-we,ht>w(a/Te)&&b("overflow"),ht*=Te;Z=B.length+1,_t=q(z-Pt,Z,Pt==0),w(z/Z)>a-nt&&b("overflow"),nt+=w(z/Z),z%=Z,B.splice(z++,0,nt)}return Y(B)}function F(R){var B,G,Z,z,nt,_t,At,Bt,Yt,Pt,ht,yt=[],bt,we,Te,us;for(R=L(R),bt=R.length,B=f,G=0,nt=p,_t=0;_t<bt;++_t)ht=R[_t],ht<128&&yt.push(E(ht));for(Z=z=yt.length,z&&yt.push(g);Z<bt;){for(At=a,_t=0;_t<bt;++_t)ht=R[_t],ht>=B&&ht<At&&(At=ht);for(we=Z+1,At-B>w((a-G)/we)&&b("overflow"),G+=(At-B)*we,B=At,_t=0;_t<bt;++_t)if(ht=R[_t],ht<B&&++G>a&&b("overflow"),ht==B){for(Bt=G,Yt=h;Pt=Yt<=nt?l:Yt>=nt+c?c:Yt-nt,!(Bt<Pt);Yt+=h)us=Bt-Pt,Te=h-Pt,yt.push(E(I(Pt+us%Te,0))),Bt=w(us/Te);yt.push(E(I(Bt,0))),nt=q(G,we,Z==z),G=0,++Z}++G,++B}return yt.join("")}function rt(R){return A(R,function(B){return m.test(B)?Q(B.slice(4).toLowerCase()):B})}function Nt(R){return A(R,function(B){return x.test(B)?"xn--"+F(B):B})}if(o={version:"1.3.2",ucs2:{decode:L,encode:Y},decode:Q,encode:F,toASCII:Nt,toUnicode:rt},s&&r)if(i.exports==s)r.exports=o;else for(T in o)o.hasOwnProperty(T)&&(s[T]=o[T]);else e.punycode=o})(vn)})(_u,Ar);var yu={isString:function(i){return typeof i=="string"},isObject:function(i){return typeof i=="object"&&i!==null},isNull:function(i){return i===null},isNullOrUndefined:function(i){return i==null}},Ls={};function xu(i,t){return Object.prototype.hasOwnProperty.call(i,t)}var vu=function(i,t,e,s){t=t||"&",e=e||"=";var r={};if(typeof i!="string"||i.length===0)return r;var n=/\+/g;i=i.split(t);var o=1e3;s&&typeof s.maxKeys=="number"&&(o=s.maxKeys);var a=i.length;o>0&&a>o&&(a=o);for(var h=0;h<a;++h){var l=i[h].replace(n,"%20"),c=l.indexOf(e),d,u,p,f;c>=0?(d=l.substr(0,c),u=l.substr(c+1)):(d=l,u=""),p=decodeURIComponent(d),f=decodeURIComponent(u),xu(r,p)?Array.isArray(r[p])?r[p].push(f):r[p]=[r[p],f]:r[p]=f}return r},ds=function(i){switch(typeof i){case"string":return i;case"boolean":return i?"true":"false";case"number":return isFinite(i)?i:"";default:return""}},bu=function(i,t,e,s){return t=t||"&",e=e||"=",i===null&&(i=void 0),typeof i=="object"?Object.keys(i).map(function(r){var n=encodeURIComponent(ds(r))+e;return Array.isArray(i[r])?i[r].map(function(o){return n+encodeURIComponent(ds(o))}).join(t):n+encodeURIComponent(ds(i[r]))}).join(t):s?encodeURIComponent(ds(s))+e+encodeURIComponent(ds(i)):""};Ls.decode=Ls.parse=vu;Ls.encode=Ls.stringify=bu;var wu=Ar,Ce=yu,Tu=jr,Su=Ou,Eu=Lu;function _e(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Au=/^([a-z0-9.+-]+:)/i,Cu=/:[0-9]*$/,Iu=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Ru=["<",">",'"',"`"," ","\r",`
`,"	"],Pu=["{","}","|","\\","^","`"].concat(Ru),ro=["'"].concat(Pu),Fa=["%","/","?",";","#"].concat(ro),Na=["/","?","#"],Mu=255,Da=/^[+a-z0-9A-Z_-]{0,63}$/,ku=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Bu={javascript:!0,"javascript:":!0},no={javascript:!0,"javascript:":!0},$i={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},oo=Ls;function jr(i,t,e){if(i&&Ce.isObject(i)&&i instanceof _e)return i;var s=new _e;return s.parse(i,t,e),s}_e.prototype.parse=function(i,t,e){if(!Ce.isString(i))throw new TypeError("Parameter 'url' must be a string, not "+typeof i);var s=i.indexOf("?"),r=s!==-1&&s<i.indexOf("#")?"?":"#",n=i.split(r),o=/\\/g;n[0]=n[0].replace(o,"/"),i=n.join(r);var a=i;if(a=a.trim(),!e&&i.split("#").length===1){var h=Iu.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],t?this.query=oo.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=Au.exec(a);if(l){l=l[0];var c=l.toLowerCase();this.protocol=c,a=a.substr(l.length)}if(e||l||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var d=a.substr(0,2)==="//";d&&!(l&&no[l])&&(a=a.substr(2),this.slashes=!0)}if(!no[l]&&(d||l&&!$i[l])){for(var u=-1,p=0;p<Na.length;p++){var f=a.indexOf(Na[p]);f!==-1&&(u===-1||f<u)&&(u=f)}var g,m;u===-1?m=a.lastIndexOf("@"):m=a.lastIndexOf("@",u),m!==-1&&(g=a.slice(0,m),a=a.slice(m+1),this.auth=decodeURIComponent(g)),u=-1;for(var p=0;p<Fa.length;p++){var f=a.indexOf(Fa[p]);f!==-1&&(u===-1||f<u)&&(u=f)}u===-1&&(u=a.length),this.host=a.slice(0,u),a=a.slice(u),this.parseHost(),this.hostname=this.hostname||"";var x=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!x)for(var y=this.hostname.split(/\./),p=0,_=y.length;p<_;p++){var v=y[p];if(v&&!v.match(Da)){for(var w="",E=0,T=v.length;E<T;E++)v.charCodeAt(E)>127?w+="x":w+=v[E];if(!w.match(Da)){var b=y.slice(0,p),S=y.slice(p+1),A=v.match(ku);A&&(b.push(A[1]),S.unshift(A[2])),S.length&&(a="/"+S.join(".")+a),this.hostname=b.join(".");break}}}this.hostname.length>Mu?this.hostname="":this.hostname=this.hostname.toLowerCase(),x||(this.hostname=wu.toASCII(this.hostname));var L=this.port?":"+this.port:"",Y=this.hostname||"";this.host=Y+L,this.href+=this.host,x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Bu[c])for(var p=0,_=ro.length;p<_;p++){var C=ro[p];if(a.indexOf(C)!==-1){var I=encodeURIComponent(C);I===C&&(I=escape(C)),a=a.split(C).join(I)}}var q=a.indexOf("#");q!==-1&&(this.hash=a.substr(q),a=a.slice(0,q));var Q=a.indexOf("?");if(Q!==-1?(this.search=a.substr(Q),this.query=a.substr(Q+1),t&&(this.query=oo.parse(this.query)),a=a.slice(0,Q)):t&&(this.search="",this.query={}),a&&(this.pathname=a),$i[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",F=this.search||"";this.path=L+F}return this.href=this.format(),this};function Lu(i){return Ce.isString(i)&&(i=jr(i)),i instanceof _e?i.format():_e.prototype.format.call(i)}_e.prototype.format=function(){var i=this.auth||"";i&&(i=encodeURIComponent(i),i=i.replace(/%3A/i,":"),i+="@");var t=this.protocol||"",e=this.pathname||"",s=this.hash||"",r=!1,n="";this.host?r=i+this.host:this.hostname&&(r=i+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&Ce.isObject(this.query)&&Object.keys(this.query).length&&(n=oo.stringify(this.query));var o=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||$i[t])&&r!==!1?(r="//"+(r||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):r||(r=""),s&&s.charAt(0)!=="#"&&(s="#"+s),o&&o.charAt(0)!=="?"&&(o="?"+o),e=e.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+r+e+o+s};function Ou(i,t){return jr(i,!1,!0).resolve(t)}_e.prototype.resolve=function(i){return this.resolveObject(jr(i,!1,!0)).format()};_e.prototype.resolveObject=function(i){if(Ce.isString(i)){var t=new _e;t.parse(i,!1,!0),i=t}for(var e=new _e,s=Object.keys(this),r=0;r<s.length;r++){var n=s[r];e[n]=this[n]}if(e.hash=i.hash,i.href==="")return e.href=e.format(),e;if(i.slashes&&!i.protocol){for(var o=Object.keys(i),a=0;a<o.length;a++){var h=o[a];h!=="protocol"&&(e[h]=i[h])}return $i[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(i.protocol&&i.protocol!==e.protocol){if(!$i[i.protocol]){for(var l=Object.keys(i),c=0;c<l.length;c++){var d=l[c];e[d]=i[d]}return e.href=e.format(),e}if(e.protocol=i.protocol,!i.host&&!no[i.protocol]){for(var _=(i.pathname||"").split("/");_.length&&!(i.host=_.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),e.pathname=_.join("/")}else e.pathname=i.pathname;if(e.search=i.search,e.query=i.query,e.host=i.host||"",e.auth=i.auth,e.hostname=i.hostname||i.host,e.port=i.port,e.pathname||e.search){var u=e.pathname||"",p=e.search||"";e.path=u+p}return e.slashes=e.slashes||i.slashes,e.href=e.format(),e}var f=e.pathname&&e.pathname.charAt(0)==="/",g=i.host||i.pathname&&i.pathname.charAt(0)==="/",m=g||f||e.host&&i.pathname,x=m,y=e.pathname&&e.pathname.split("/")||[],_=i.pathname&&i.pathname.split("/")||[],v=e.protocol&&!$i[e.protocol];if(v&&(e.hostname="",e.port=null,e.host&&(y[0]===""?y[0]=e.host:y.unshift(e.host)),e.host="",i.protocol&&(i.hostname=null,i.port=null,i.host&&(_[0]===""?_[0]=i.host:_.unshift(i.host)),i.host=null),m=m&&(_[0]===""||y[0]==="")),g)e.host=i.host||i.host===""?i.host:e.host,e.hostname=i.hostname||i.hostname===""?i.hostname:e.hostname,e.search=i.search,e.query=i.query,y=_;else if(_.length)y||(y=[]),y.pop(),y=y.concat(_),e.search=i.search,e.query=i.query;else if(!Ce.isNullOrUndefined(i.search)){if(v){e.hostname=e.host=y.shift();var w=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;w&&(e.auth=w.shift(),e.host=e.hostname=w.shift())}return e.search=i.search,e.query=i.query,(!Ce.isNull(e.pathname)||!Ce.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!y.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var E=y.slice(-1)[0],T=(e.host||i.host||y.length>1)&&(E==="."||E==="..")||E==="",b=0,S=y.length;S>=0;S--)E=y[S],E==="."?y.splice(S,1):E===".."?(y.splice(S,1),b++):b&&(y.splice(S,1),b--);if(!m&&!x)for(;b--;b)y.unshift("..");m&&y[0]!==""&&(!y[0]||y[0].charAt(0)!=="/")&&y.unshift(""),T&&y.join("/").substr(-1)!=="/"&&y.push("");var A=y[0]===""||y[0]&&y[0].charAt(0)==="/";if(v){e.hostname=e.host=A?"":y.length?y.shift():"";var w=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;w&&(e.auth=w.shift(),e.host=e.hostname=w.shift())}return m=m||e.host&&y.length,m&&!A&&y.unshift(""),y.length?e.pathname=y.join("/"):(e.pathname=null,e.path=null),(!Ce.isNull(e.pathname)||!Ce.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=i.auth||e.auth,e.slashes=e.slashes||i.slashes,e.href=e.format(),e};_e.prototype.parseHost=function(){var i=this.host,t=Cu.exec(i);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),i=i.substr(0,i.length-t.length)),i&&(this.hostname=i)};const Fu={parse:Tu,format:Eu,resolve:Su};function ce(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function fs(i){return i.split("?")[0].split("#")[0]}function Nu(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Du(i,t,e){return i.replace(new RegExp(Nu(t),"g"),e)}function Uu(i,t){let e="",s=0,r=-1,n=0,o=-1;for(let a=0;a<=i.length;++a){if(a<i.length)o=i.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(e.length<2||s!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",s=0):(e=e.slice(0,h),s=e.length-1-e.lastIndexOf("/")),r=a,n=0;continue}}else if(e.length===2||e.length===1){e="",s=0,r=a,n=0;continue}}t&&(e.length>0?e+="/..":e="..",s=2)}else e.length>0?e+=`/${i.slice(r+1,a)}`:e=i.slice(r+1,a),s=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const ei={toPosix(i){return Du(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},hasProtocol(i){return/^[^/:]+:\//.test(this.toPosix(i))},getProtocol(i){ce(i),i=this.toPosix(i);let t="";const e=/^file:\/\/\//.exec(i),s=/^[^/:]+:\/\//.exec(i),r=/^[^/:]+:\//.exec(i);if(e||s||r){const n=(e==null?void 0:e[0])||(s==null?void 0:s[0])||(r==null?void 0:r[0]);t=n,i=i.slice(n.length)}return t},toAbsolute(i,t,e){if(this.isDataUrl(i))return i;const s=fs(this.toPosix(t??O.ADAPTER.getBaseUrl())),r=fs(this.toPosix(e??this.rootname(s)));return ce(i),i=this.toPosix(i),i.startsWith("/")?ei.join(r,i.slice(1)):this.isAbsolute(i)?i:this.join(s,i)},normalize(i){if(i=this.toPosix(i),ce(i),i.length===0)return".";let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const s=i.endsWith("/");return i=Uu(i,!1),i.length>0&&s&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return ce(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const s=i[e];if(ce(s),s.length>0)if(t===void 0)t=s;else{const r=i[e-1]??"";this.extname(r)?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(ce(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let s=-1,r=!0;const n=this.getProtocol(i),o=i;i=i.slice(n.length);for(let a=i.length-1;a>=1;--a)if(t=i.charCodeAt(a),t===47){if(!r){s=a;break}}else r=!1;return s===-1?e?"/":this.isUrl(o)?n+i:n:e&&s===1?"//":n+i.slice(0,s)},rootname(i){ce(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){ce(i),t&&ce(t),i=fs(this.toPosix(i));let e=0,s=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let o=t.length-1,a=-1;for(n=i.length-1;n>=0;--n){const h=i.charCodeAt(n);if(h===47){if(!r){e=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(s=n):(o=-1,s=a))}return e===s?s=a:s===-1&&(s=i.length),i.slice(e,s)}for(n=i.length-1;n>=0;--n)if(i.charCodeAt(n)===47){if(!r){e=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":i.slice(e,s)},extname(i){ce(i),i=fs(this.toPosix(i));let t=-1,e=0,s=-1,r=!0,n=0;for(let o=i.length-1;o>=0;--o){const a=i.charCodeAt(o);if(a===47){if(!r){e=o+1;break}continue}s===-1&&(r=!1,s=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||s===-1||n===0||n===1&&t===s-1&&t===e+1?"":i.slice(t,s)},parse(i){ce(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=fs(this.toPosix(i));let e=i.charCodeAt(0);const s=this.isAbsolute(i);let r;t.root=this.rootname(i),s||this.hasProtocol(i)?r=1:r=0;let n=-1,o=0,a=-1,h=!0,l=i.length-1,c=0;for(;l>=r;--l){if(e=i.charCodeAt(l),e===47){if(!h){o=l+1;break}continue}a===-1&&(h=!1,a=l+1),e===46?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||a===-1||c===0||c===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&s?t.base=t.name=i.slice(1,a):t.base=t.name=i.slice(o,a)):(o===0&&s?(t.name=i.slice(1,n),t.base=i.slice(1,a)):(t.name=i.slice(o,n),t.base=i.slice(o,a)),t.ext=i.slice(n,a)),t.dir=this.dirname(i),t},sep:"/",delimiter:":"},Ua={};function $(i,t,e=3){if(Ua[t])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`):(s=s.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${i}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`),console.warn(s))),Ua[t]=!0}let bn;function Gu(){return typeof bn>"u"&&(bn=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:O.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!O.ADAPTER.getWebGLRenderingContext())return!1;const s=O.ADAPTER.createCanvas();let r=s.getContext("webgl",t)||s.getContext("experimental-webgl",t);const n=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}return r=null,n}catch{return!1}}()),bn}var Vu={grad:.9,turn:360,rad:360/(2*Math.PI)},Oe=function(i){return typeof i=="string"?i.length>0:typeof i=="number"},Ct=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*i)/e+0},ne=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),i>e?e:i>t?i:t},$h=function(i){return(i=isFinite(i)?i%360:0)>0?i:i+360},Ga=function(i){return{r:ne(i.r,0,255),g:ne(i.g,0,255),b:ne(i.b,0,255),a:ne(i.a)}},wn=function(i){return{r:Ct(i.r),g:Ct(i.g),b:Ct(i.b),a:Ct(i.a,3)}},zu=/^#([0-9a-f]{3,8})$/i,ir=function(i){var t=i.toString(16);return t.length<2?"0"+t:t},jh=function(i){var t=i.r,e=i.g,s=i.b,r=i.a,n=Math.max(t,e,s),o=n-Math.min(t,e,s),a=o?n===t?(e-s)/o:n===e?2+(s-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:r}},Yh=function(i){var t=i.h,e=i.s,s=i.v,r=i.a;t=t/360*6,e/=100,s/=100;var n=Math.floor(t),o=s*(1-e),a=s*(1-(t-n)*e),h=s*(1-(1-t+n)*e),l=n%6;return{r:255*[s,a,o,o,h,s][l],g:255*[h,s,s,a,o,o][l],b:255*[o,o,h,s,s,a][l],a:r}},Va=function(i){return{h:$h(i.h),s:ne(i.s,0,100),l:ne(i.l,0,100),a:ne(i.a)}},za=function(i){return{h:Ct(i.h),s:Ct(i.s),l:Ct(i.l),a:Ct(i.a,3)}},Ha=function(i){return Yh((e=(t=i).s,{h:t.h,s:(e*=((s=t.l)<50?s:100-s)/100)>0?2*e/(s+e)*100:0,v:s+e,a:t.a}));var t,e,s},Es=function(i){return{h:(t=jh(i)).h,s:(r=(200-(e=t.s))*(s=t.v)/100)>0&&r<200?e*s/100/(r<=100?r:200-r)*100:0,l:r/2,a:t.a};var t,e,s,r},Hu=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Wu=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Xu=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,$u=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ao={string:[[function(i){var t=zu.exec(i);return t?(i=t[1]).length<=4?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?Ct(parseInt(i[3]+i[3],16)/255,2):1}:i.length===6||i.length===8?{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16),a:i.length===8?Ct(parseInt(i.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(i){var t=Xu.exec(i)||$u.exec(i);return t?t[2]!==t[4]||t[4]!==t[6]?null:Ga({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(i){var t=Hu.exec(i)||Wu.exec(i);if(!t)return null;var e,s,r=Va({h:(e=t[1],s=t[2],s===void 0&&(s="deg"),Number(e)*(Vu[s]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Ha(r)},"hsl"]],object:[[function(i){var t=i.r,e=i.g,s=i.b,r=i.a,n=r===void 0?1:r;return Oe(t)&&Oe(e)&&Oe(s)?Ga({r:Number(t),g:Number(e),b:Number(s),a:Number(n)}):null},"rgb"],[function(i){var t=i.h,e=i.s,s=i.l,r=i.a,n=r===void 0?1:r;if(!Oe(t)||!Oe(e)||!Oe(s))return null;var o=Va({h:Number(t),s:Number(e),l:Number(s),a:Number(n)});return Ha(o)},"hsl"],[function(i){var t=i.h,e=i.s,s=i.v,r=i.a,n=r===void 0?1:r;if(!Oe(t)||!Oe(e)||!Oe(s))return null;var o=function(a){return{h:$h(a.h),s:ne(a.s,0,100),v:ne(a.v,0,100),a:ne(a.a)}}({h:Number(t),s:Number(e),v:Number(s),a:Number(n)});return Yh(o)},"hsv"]]},Wa=function(i,t){for(var e=0;e<t.length;e++){var s=t[e][0](i);if(s)return[s,t[e][1]]}return[null,void 0]},ju=function(i){return typeof i=="string"?Wa(i.trim(),ao.string):typeof i=="object"&&i!==null?Wa(i,ao.object):[null,void 0]},Tn=function(i,t){var e=Es(i);return{h:e.h,s:ne(e.s+100*t,0,100),l:e.l,a:e.a}},Sn=function(i){return(299*i.r+587*i.g+114*i.b)/1e3/255},Xa=function(i,t){var e=Es(i);return{h:e.h,s:e.s,l:ne(e.l+100*t,0,100),a:e.a}},ho=function(){function i(t){this.parsed=ju(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return i.prototype.isValid=function(){return this.parsed!==null},i.prototype.brightness=function(){return Ct(Sn(this.rgba),2)},i.prototype.isDark=function(){return Sn(this.rgba)<.5},i.prototype.isLight=function(){return Sn(this.rgba)>=.5},i.prototype.toHex=function(){return t=wn(this.rgba),e=t.r,s=t.g,r=t.b,o=(n=t.a)<1?ir(Ct(255*n)):"","#"+ir(e)+ir(s)+ir(r)+o;var t,e,s,r,n,o},i.prototype.toRgb=function(){return wn(this.rgba)},i.prototype.toRgbString=function(){return t=wn(this.rgba),e=t.r,s=t.g,r=t.b,(n=t.a)<1?"rgba("+e+", "+s+", "+r+", "+n+")":"rgb("+e+", "+s+", "+r+")";var t,e,s,r,n},i.prototype.toHsl=function(){return za(Es(this.rgba))},i.prototype.toHslString=function(){return t=za(Es(this.rgba)),e=t.h,s=t.s,r=t.l,(n=t.a)<1?"hsla("+e+", "+s+"%, "+r+"%, "+n+")":"hsl("+e+", "+s+"%, "+r+"%)";var t,e,s,r,n},i.prototype.toHsv=function(){return t=jh(this.rgba),{h:Ct(t.h),s:Ct(t.s),v:Ct(t.v),a:Ct(t.a,3)};var t},i.prototype.invert=function(){return Ee({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},i.prototype.saturate=function(t){return t===void 0&&(t=.1),Ee(Tn(this.rgba,t))},i.prototype.desaturate=function(t){return t===void 0&&(t=.1),Ee(Tn(this.rgba,-t))},i.prototype.grayscale=function(){return Ee(Tn(this.rgba,-1))},i.prototype.lighten=function(t){return t===void 0&&(t=.1),Ee(Xa(this.rgba,t))},i.prototype.darken=function(t){return t===void 0&&(t=.1),Ee(Xa(this.rgba,-t))},i.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},i.prototype.alpha=function(t){return typeof t=="number"?Ee({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):Ct(this.rgba.a,3);var e},i.prototype.hue=function(t){var e=Es(this.rgba);return typeof t=="number"?Ee({h:t,s:e.s,l:e.l,a:e.a}):Ct(e.h)},i.prototype.isEqual=function(t){return this.toHex()===Ee(t).toHex()},i}(),Ee=function(i){return i instanceof ho?i:new ho(i)},$a=[],Yu=function(i){i.forEach(function(t){$a.indexOf(t)<0&&(t(ho,ao),$a.push(t))})};function qu(i,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var r in e)s[e[r]]=r;var n={};i.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,h,l=s[this.toHex()];if(l)return l;if(o!=null&&o.closest){var c=this.toRgb(),d=1/0,u="black";if(!n.length)for(var p in e)n[p]=new i(e[p]).toRgb();for(var f in e){var g=(a=c,h=n[f],Math.pow(a.r-h.r,2)+Math.pow(a.g-h.g,2)+Math.pow(a.b-h.b,2));g<d&&(d=g,u=f)}return u}},t.string.push([function(o){var a=o.toLowerCase(),h=a==="transparent"?"#0000":e[a];return h?new i(h).toRgb():null},"name"])}Yu([qu]);const ji=class{constructor(i=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=i}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(i){return this.value=i,this}set value(i){if(i instanceof ji)this._value=this.cloneSource(i._value),this._int=i._int,this._components.set(i._components);else{if(i===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,i))&&(this.normalize(i),this._value=this.cloneSource(i))}}get value(){return this._value}cloneSource(i){return typeof i=="string"||typeof i=="number"||i instanceof Number||i===null?i:Array.isArray(i)||ArrayBuffer.isView(i)?i.slice(0):typeof i=="object"&&i!==null?{...i}:i}isSourceEqual(i,t){const e=typeof i;if(e!==typeof t)return!1;if(e==="number"||e==="string"||i instanceof Number)return i===t;if(Array.isArray(i)&&Array.isArray(t)||ArrayBuffer.isView(i)&&ArrayBuffer.isView(t))return i.length!==t.length?!1:i.every((r,n)=>r===t[n]);if(i!==null&&t!==null){const r=Object.keys(i),n=Object.keys(t);return r.length!==n.length?!1:r.every(o=>i[o]===t[o])}return i===t}toRgba(){const[i,t,e,s]=this._components;return{r:i,g:t,b:e,a:s}}toRgb(){const[i,t,e]=this._components;return{r:i,g:t,b:e}}toRgbaString(){const[i,t,e]=this.toUint8RgbArray();return`rgba(${i},${t},${e},${this.alpha})`}toUint8RgbArray(i){const[t,e,s]=this._components;return i=i??[],i[0]=Math.round(t*255),i[1]=Math.round(e*255),i[2]=Math.round(s*255),i}toRgbArray(i){i=i??[];const[t,e,s]=this._components;return i[0]=t,i[1]=e,i[2]=s,i}toNumber(){return this._int}toLittleEndianNumber(){const i=this._int;return(i>>16)+(i&65280)+((i&255)<<16)}multiply(i){const[t,e,s,r]=ji.temp.setValue(i)._components;return this._components[0]*=t,this._components[1]*=e,this._components[2]*=s,this._components[3]*=r,this.refreshInt(),this._value=null,this}premultiply(i,t=!0){return t&&(this._components[0]*=i,this._components[1]*=i,this._components[2]*=i),this._components[3]=i,this.refreshInt(),this._value=null,this}toPremultiplied(i){if(i===1)return(i*255<<24)+this._int;if(i===0)return 0;let t=this._int>>16&255,e=this._int>>8&255,s=this._int&255;return t=t*i+.5|0,e=e*i+.5|0,s=s*i+.5|0,(i*255<<24)+(t<<16)+(e<<8)+s}toHex(){const i=this._int.toString(16);return`#${"000000".substring(0,6-i.length)+i}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(i){return this._components[3]=i,this}round(i){const[t,e,s]=this._components;return this._components.set([Math.min(255,t/i*i),Math.min(255,e/i*i),Math.min(255,s/i*i)]),this.refreshInt(),this._value=null,this}toArray(i){i=i??[];const[t,e,s,r]=this._components;return i[0]=t,i[1]=e,i[2]=s,i[3]=r,i}normalize(i){let t;if((typeof i=="number"||i instanceof Number)&&i>=0&&i<=16777215){const e=i;t=[(e>>16&255)/255,(e>>8&255)/255,(e&255)/255,1]}else if((Array.isArray(i)||i instanceof Float32Array)&&i.length>=3&&i.length<=4&&i.every(e=>e<=1&&e>=0)){const[e,s,r,n=1]=i;t=[e,s,r,n]}else if((i instanceof Uint8Array||i instanceof Uint8ClampedArray)&&i.length>=3&&i.length<=4){const[e,s,r,n=255]=i;t=[e/255,s/255,r/255,n/255]}else if(typeof i=="string"||typeof i=="object"){if(typeof i=="string"){const s=ji.HEX_PATTERN.exec(i);s&&(i=`#${s[2]}`)}const e=Ee(i);if(e.isValid()){const{r:s,g:r,b:n,a:o}=e.rgba;t=[s/255,r/255,n/255,o]}}if(t)this._components.set(t),this.refreshInt();else throw new Error(`Unable to convert color ${i}`)}refreshInt(){this._components.forEach((s,r)=>this._components[r]=Math.min(Math.max(s,0),1));const[i,t,e]=this._components;this._int=(i*255<<16)+(t*255<<8)+(e*255|0)}};let St=ji;St.shared=new ji;St.temp=new ji;St.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function qh(i){return $("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),St.shared.setValue(i).toNumber()}function Ku(i){return $("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),St.shared.setValue(i).toNumber()}function Zu(){const i=[],t=[];for(let s=0;s<32;s++)i[s]=s,t[s]=s;i[N.NORMAL_NPM]=N.NORMAL,i[N.ADD_NPM]=N.ADD,i[N.SCREEN_NPM]=N.SCREEN,t[N.NORMAL]=N.NORMAL_NPM,t[N.ADD]=N.ADD_NPM,t[N.SCREEN]=N.SCREEN_NPM;const e=[];return e.push(t),e.push(i),e}const Ju=Zu();function Kh(i){if(i.BYTES_PER_ELEMENT===4)return i instanceof Float32Array?"Float32Array":i instanceof Uint32Array?"Uint32Array":"Int32Array";if(i.BYTES_PER_ELEMENT===2){if(i instanceof Uint16Array)return"Uint16Array"}else if(i.BYTES_PER_ELEMENT===1&&i instanceof Uint8Array)return"Uint8Array";return null}function Cr(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function ja(i){return!(i&i-1)&&!!i}function Ya(i){let t=(i>65535?1:0)<<4;i>>>=t;let e=(i>255?1:0)<<3;return i>>>=e,t|=e,e=(i>15?1:0)<<2,i>>>=e,t|=e,e=(i>3?1:0)<<1,i>>>=e,t|=e,t|i>>1}function mr(i,t,e){const s=i.length;let r;if(t>=s||e===0)return;e=t+e>s?s-t:e;const n=s-e;for(r=t;r<n;++r)i[r]=i[r+e];i.length=n}function Ui(i){return i===0?0:i<0?-1:1}let Qu=0;function Os(){return++Qu}const Zh=class{constructor(i,t,e,s){this.left=i,this.top=t,this.right=e,this.bottom=s}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let lo=Zh;lo.EMPTY=new Zh(0,0,0,0);const qa={},Ae=Object.create(null),Xe=Object.create(null);function Ka(i,t,e){for(let s=0,r=4*e*t;s<t;++s,r+=4)if(i[r+3]!==0)return!1;return!0}function Za(i,t,e,s,r){const n=4*t;for(let o=s,a=s*n+4*e;o<=r;++o,a+=n)if(i[a+3]!==0)return!1;return!0}function td(i){const{width:t,height:e}=i,s=i.getContext("2d",{willReadFrequently:!0});if(s===null)throw new TypeError("Failed to get canvas 2D context");const n=s.getImageData(0,0,t,e).data;let o=0,a=0,h=t-1,l=e-1;for(;a<e&&Ka(n,t,a);)++a;if(a===e)return lo.EMPTY;for(;Ka(n,t,l);)--l;for(;Za(n,t,o,a,l);)++o;for(;Za(n,t,h,a,l);)--h;return++h,++l,new lo(o,a,h,l)}function ed(i){const t=td(i),{width:e,height:s}=t;let r=null;if(!t.isEmpty()){const n=i.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");r=n.getImageData(t.left,t.top,e,s)}return{width:e,height:s,data:r}}let sr;function id(i,t=globalThis.location){if(i.startsWith("data:"))return"";t=t||globalThis.location,sr||(sr=document.createElement("a")),sr.href=i;const e=Fu.parse(sr.href),s=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!s||e.protocol!==t.protocol?"anonymous":""}function Ir(i,t=1){var s;const e=(s=O.RETINA_PREFIX)==null?void 0:s.exec(i);return e?parseFloat(e[1]):t}var k=(i=>(i.Renderer="renderer",i.Application="application",i.RendererSystem="renderer-webgl-system",i.RendererPlugin="renderer-webgl-plugin",i.CanvasRendererSystem="renderer-canvas-system",i.CanvasRendererPlugin="renderer-canvas-plugin",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i))(k||{});const co=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},Ja=(i,t)=>co(i).priority??t,D={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(co).forEach(t=>{t.type.forEach(e=>{var s,r;return(r=(s=this._removeHandlers)[e])==null?void 0:r.call(s,t)})}),this},add(...i){return i.map(co).forEach(t=>{t.type.forEach(e=>{const s=this._addHandlers,r=this._queue;s[e]?s[e](t):(r[e]=r[e]||[],r[e].push(t))})}),this},handle(i,t,e){const s=this._addHandlers,r=this._removeHandlers;if(s[i]||r[i])throw new Error(`Extension type ${i} already has a handler`);s[i]=t,r[i]=e;const n=this._queue;return n[i]&&(n[i].forEach(o=>t(o)),delete n[i]),this},handleByMap(i,t){return this.handle(i,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(i,t,e=-1){return this.handle(i,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((r,n)=>Ja(n,e)-Ja(r,e)))},s=>{const r=t.indexOf(s.ref);r!==-1&&t.splice(r,1)})}};class sd{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const rd=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function nd(i){let t="";for(let e=0;e<i;++e)e>0&&(t+=`
else `),e<i-1&&(t+=`if(test == ${e}.0){}`);return t}function od(i,t){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const s=rd.replace(/%forloop%/gi,nd(i));if(t.shaderSource(e,s),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))i=i/2|0;else break}return i}const En=0,An=1,Cn=2,In=3,Rn=4,Pn=5;class hs{constructor(){this.data=0,this.blendMode=N.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<En)}set blend(t){!!(this.data&1<<En)!==t&&(this.data^=1<<En)}get offsets(){return!!(this.data&1<<An)}set offsets(t){!!(this.data&1<<An)!==t&&(this.data^=1<<An)}get culling(){return!!(this.data&1<<Cn)}set culling(t){!!(this.data&1<<Cn)!==t&&(this.data^=1<<Cn)}get depthTest(){return!!(this.data&1<<In)}set depthTest(t){!!(this.data&1<<In)!==t&&(this.data^=1<<In)}get depthMask(){return!!(this.data&1<<Pn)}set depthMask(t){!!(this.data&1<<Pn)!==t&&(this.data^=1<<Pn)}get clockwiseFrontFace(){return!!(this.data&1<<Rn)}set clockwiseFrontFace(t){!!(this.data&1<<Rn)!==t&&(this.data^=1<<Rn)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==N.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new hs;return t.depthTest=!1,t.blend=!0,t}}const uo=[];function Jh(i,t){if(!i)return null;let e="";if(typeof i=="string"){const s=/\.(\w{3,4})(?:$|\?|#)/i.exec(i);s&&(e=s[1].toLowerCase())}for(let s=uo.length-1;s>=0;--s){const r=uo[s];if(r.test&&r.test(i,e))return new r(i,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class ye{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,s,r,n,o,a,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:c}=this;this._aliasCount++;for(let d=0,u=c.length;d<u;d++)c[d][l](t,e,s,r,n,o,a,h);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(ye.prototype,{dispatch:{value:ye.prototype.emit},run:{value:ye.prototype.emit}});class Fs{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ye("setRealSize"),this.onUpdate=new ye("update"),this.onError=new ye("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,s){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class Xo extends Fs{constructor(t,e){const{width:s,height:r}=e||{};if(!s||!r)throw new Error("BufferResource width or height invalid");super(s,r),this.data=t}upload(t,e,s){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ni.UNPACK);const n=e.realWidth,o=e.realHeight;return s.width===n&&s.height===o?r.texSubImage2D(e.target,0,0,0,n,o,e.format,s.type,this.data):(s.width=n,s.height=o,r.texImage2D(e.target,0,s.internalFormat,n,o,0,e.format,s.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const ad={scaleMode:De.NEAREST,format:P.RGBA,alphaMode:ni.NPM},Fi=class extends Ai{constructor(i=null,t=null){super(),t=Object.assign({},Fi.defaultOptions,t);const{alphaMode:e,mipmap:s,anisotropicLevel:r,scaleMode:n,width:o,height:a,wrapMode:h,format:l,type:c,target:d,resolution:u,resourceOptions:p}=t;i&&!(i instanceof Fs)&&(i=Jh(i,p),i.internal=!0),this.resolution=u||O.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=r,this._wrapMode=h,this._scaleMode=n,this.format=l,this.type=c,this.target=d,this.alphaMode=e,this.uid=Os(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(i)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(i){this._mipmap!==i&&(this._mipmap=i,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(i){this._scaleMode!==i&&(this._scaleMode=i,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(i){this._wrapMode!==i&&(this._wrapMode=i,this.dirtyStyleId++)}setStyle(i,t){let e;return i!==void 0&&i!==this.scaleMode&&(this.scaleMode=i,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(i,t,e){return e=e||this.resolution,this.setRealSize(i*e,t*e,e)}setRealSize(i,t,e){return this.resolution=e||this.resolution,this.width=Math.round(i)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=ja(this.realWidth)&&ja(this.realHeight)}setResolution(i){const t=this.resolution;return t===i?this:(this.resolution=i,this.valid&&(this.width=Math.round(this.width*t)/i,this.height=Math.round(this.height*t)/i,this.emit("update",this)),this._refreshPOT(),this)}setResource(i){if(this.resource===i)return this;if(this.resource)throw new Error("Resource can be set only once");return i.bind(this),this.resource=i,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(i){this.emit("error",this,i)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Xe[this.cacheId],delete Ae[this.cacheId],this.cacheId=null),this.dispose(),Fi.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(i,t,e=O.STRICT_TEXTURE_CACHE){const s=typeof i=="string";let r=null;if(s)r=i;else{if(!i._pixiId){const o=(t==null?void 0:t.pixiIdPrefix)||"pixiid";i._pixiId=`${o}_${Os()}`}r=i._pixiId}let n=Xe[r];if(s&&e&&!n)throw new Error(`The cacheId "${r}" does not exist in BaseTextureCache.`);return n||(n=new Fi(i,t),n.cacheId=r,Fi.addToCache(n,r)),n}static fromBuffer(i,t,e,s){i=i||new Float32Array(t*e*4);const r=new Xo(i,{width:t,height:e}),n=i instanceof Float32Array?K.FLOAT:K.UNSIGNED_BYTE;return new Fi(r,Object.assign({},ad,s||{width:t,height:e,type:n}))}static addToCache(i,t){t&&(i.textureCacheIds.includes(t)||i.textureCacheIds.push(t),Xe[t]&&Xe[t]!==i&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Xe[t]=i)}static removeFromCache(i){if(typeof i=="string"){const t=Xe[i];if(t){const e=t.textureCacheIds.indexOf(i);return e>-1&&t.textureCacheIds.splice(e,1),delete Xe[i],t}}else if(i!=null&&i.textureCacheIds){for(let t=0;t<i.textureCacheIds.length;++t)delete Xe[i.textureCacheIds[t]];return i.textureCacheIds.length=0,i}return null}};let W=Fi;W.defaultOptions={mipmap:Ei.POW2,anisotropicLevel:0,scaleMode:De.LINEAR,wrapMode:Ps.CLAMP,alphaMode:ni.UNPACK,target:Xi.TEXTURE_2D,format:P.RGBA,type:K.UNSIGNED_BYTE};W._globalBatch=0;class fo{constructor(){this.texArray=null,this.blend=0,this.type=je.TRIANGLES,this.start=0,this.size=0,this.data=null}}let hd=0;class Dt{constructor(t,e=!0,s=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=s,this.static=e,this.id=hd++,this.disposeRunner=new ye("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Me.ELEMENT_ARRAY_BUFFER:Me.ARRAY_BUFFER}get index(){return this.type===Me.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Dt(t)}}class Rr{constructor(t,e=0,s=!1,r=K.FLOAT,n,o,a,h=1){this.buffer=t,this.size=e,this.normalized=s,this.type=r,this.stride=n,this.start=o,this.instance=a,this.divisor=h}destroy(){this.buffer=null}static from(t,e,s,r,n){return new Rr(t,e,s,r,n)}}const ld={Float32Array,Uint32Array,Int32Array,Uint8Array};function cd(i,t){let e=0,s=0;const r={};for(let h=0;h<i.length;h++)s+=t[h],e+=i[h].length;const n=new ArrayBuffer(e*4);let o=null,a=0;for(let h=0;h<i.length;h++){const l=t[h],c=i[h],d=Kh(c);r[d]||(r[d]=new ld[d](n)),o=r[d];for(let u=0;u<c.length;u++){const p=(u/l|0)*s+a,f=u%l;o[p+f]=c[u]}a+=l}return new Float32Array(n)}const Qa={5126:4,5123:2,5121:1};let ud=0;const dd={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Ji{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=ud++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ye("disposeGeometry"),this.refCount=0}addAttribute(t,e,s=0,r=!1,n,o,a,h=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Dt||(e instanceof Array&&(e=new Float32Array(e)),e=new Dt(e));const l=t.split("|");if(l.length>1){for(let d=0;d<l.length;d++)this.addAttribute(l[d],e,s,r,n);return this}let c=this.buffers.indexOf(e);return c===-1&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new Rr(c,s,r,n,o,a,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Dt||(t instanceof Array&&(t=new Uint16Array(t)),t=new Dt(t)),t.type=Me.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],s=new Dt;let r;for(r in this.attributes){const n=this.attributes[r],o=this.buffers[n.buffer];t.push(o.data),e.push(n.size*Qa[n.type]/4),n.buffer=0}for(s.data=cd(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Ji;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Dt(this.buffers[e].data.slice(0));for(const e in this.attributes){const s=this.attributes[e];t.attributes[e]=new Rr(s.buffer,s.size,s.normalized,s.type,s.stride,s.start,s.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Me.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new Ji,s=[],r=[],n=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)r[h]=r[h]||0,r[h]+=o.buffers[h].data.length,n[h]=0}for(let a=0;a<o.buffers.length;a++)s[a]=new dd[Kh(o.buffers[a].data)](r[a]),e.buffers[a]=new Dt(s[a]);for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)s[h].set(o.buffers[h].data,n[h]),n[h]+=o.buffers[h].data.length}if(e.attributes=o.attributes,o.indexBuffer){e.indexBuffer=e.buffers[o.buffers.indexOf(o.indexBuffer)],e.indexBuffer.type=Me.ELEMENT_ARRAY_BUFFER;let a=0,h=0,l=0,c=0;for(let d=0;d<o.buffers.length;d++)if(o.buffers[d]!==o.indexBuffer){c=d;break}for(const d in o.attributes){const u=o.attributes[d];(u.buffer|0)===c&&(h+=u.size*Qa[u.type]/4)}for(let d=0;d<t.length;d++){const u=t[d].indexBuffer.data;for(let p=0;p<u.length;p++)e.indexBuffer.data[p+l]+=a;a+=t[d].buffers[c].data.length/h,l+=u.length}}return e}}class Qh extends Ji{constructor(t=!1){super(),this._buffer=new Dt(null,t,!1),this._indexBuffer=new Dt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,K.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,K.FLOAT).addAttribute("aColor",this._buffer,4,!0,K.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,K.FLOAT).addIndex(this._indexBuffer)}}const Pr=Math.PI*2,fd=180/Math.PI,pd=Math.PI/180;var kt=(i=>(i[i.POLY=0]="POLY",i[i.RECT=1]="RECT",i[i.CIRC=2]="CIRC",i[i.ELIP=3]="ELIP",i[i.RREC=4]="RREC",i))(kt||{});class tt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new tt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const rr=[new tt,new tt,new tt,new tt];class j{constructor(t=0,e=0,s=0,r=0){this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(r),this.type=kt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new j(0,0,0,0)}clone(){return new j(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const b=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=b)return!1;const A=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>A}const s=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=s||o<=n)return!1;const a=rr[0].set(t.left,t.top),h=rr[1].set(t.left,t.bottom),l=rr[2].set(t.right,t.top),c=rr[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;const d=Math.sign(e.a*e.d-e.b*e.c);if(d===0||(e.apply(a,a),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(a.x,h.x,l.x,c.x)<=s||Math.min(a.x,h.x,l.x,c.x)>=r||Math.max(a.y,h.y,l.y,c.y)<=n||Math.min(a.y,h.y,l.y,c.y)>=o))return!1;const u=d*(h.y-a.y),p=d*(a.x-h.x),f=u*s+p*n,g=u*r+p*n,m=u*s+p*o,x=u*r+p*o;if(Math.max(f,g,m,x)<=u*a.x+p*a.y||Math.min(f,g,m,x)>=u*c.x+p*c.y)return!1;const y=d*(a.y-l.y),_=d*(l.x-a.x),v=y*s+_*n,w=y*r+_*n,E=y*s+_*o,T=y*r+_*o;return!(Math.max(v,w,E,T)<=y*a.x+_*a.y||Math.min(v,w,E,T)>=y*c.x+_*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=r,this.height=n-r,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class $o{constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.radius=s,this.type=kt.CIRC}clone(){return new $o(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=s}getBounds(){return new j(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class jo{constructor(t=0,e=0,s=0,r=0){this.x=t,this.y=e,this.width=s,this.height=r,this.type=kt.ELIP}clone(){return new jo(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let s=(t-this.x)/this.width,r=(e-this.y)/this.height;return s*=s,r*=r,s+r<=1}getBounds(){return new j(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class As{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const s=[];for(let r=0,n=e.length;r<n;r++)s.push(e[r].x,e[r].y);e=s}this.points=e,this.type=kt.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new As(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let s=!1;const r=this.points.length/2;for(let n=0,o=r-1;n<r;o=n++){const a=this.points[n*2],h=this.points[n*2+1],l=this.points[o*2],c=this.points[o*2+1];h>e!=c>e&&t<(l-a)*((e-h)/(c-h))+a&&(s=!s)}return s}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}}class Yo{constructor(t=0,e=0,s=0,r=0,n=20){this.x=t,this.y=e,this.width=s,this.height=r,this.radius=n,this.type=kt.RREC}clone(){return new Yo(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let r=t-(this.x+s),n=e-(this.y+s);const o=s*s;if(r*r+n*n<=o||(r=t-(this.x+this.width-s),r*r+n*n<=o)||(n=e-(this.y+this.height-s),r*r+n*n<=o)||(r=t-(this.x+s),r*r+n*n<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class Et{constructor(t=1,e=0,s=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,r,n,o){return this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new tt;const s=t.x,r=t.y;return e.x=this.a*s+this.c*r+this.tx,e.y=this.b*s+this.d*r+this.ty,e}applyInverse(t,e){e=e||new tt;const s=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*s*r+-this.c*s*n+(this.ty*this.c-this.tx*this.d)*s,e.y=this.a*s*n+-this.b*s*r+(-this.ty*this.a+this.tx*this.b)*s,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*s,this.b=r*s+this.b*e,this.c=n*e-this.d*s,this.d=n*s+this.d*e,this.tx=o*e-this.ty*s,this.ty=o*s+this.ty*e,this}append(t){const e=this.a,s=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*s+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*s+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*s+t.ty*n+this.ty,this}setTransform(t,e,s,r,n,o,a,h,l){return this.a=Math.cos(a+l)*n,this.b=Math.sin(a+l)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(s*this.a+r*this.c),this.ty=e-(s*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,r=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),h=Math.atan2(s,e),l=Math.abs(a+h);return l<1e-5||Math.abs(Pr-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*s+o.y*n),t}invert(){const t=this.a,e=this.b,s=this.c,r=this.d,n=this.tx,o=t*r-e*s;return this.a=r/o,this.b=-e/o,this.c=-s/o,this.d=t/o,this.tx=(s*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Et;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Et}static get TEMP_MATRIX(){return new Et}}const fi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],pi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],gi=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],mi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],po=[],tl=[],nr=Math.sign;function gd(){for(let i=0;i<16;i++){const t=[];po.push(t);for(let e=0;e<16;e++){const s=nr(fi[i]*fi[e]+gi[i]*pi[e]),r=nr(pi[i]*fi[e]+mi[i]*pi[e]),n=nr(fi[i]*gi[e]+gi[i]*mi[e]),o=nr(pi[i]*gi[e]+mi[i]*mi[e]);for(let a=0;a<16;a++)if(fi[a]===s&&pi[a]===r&&gi[a]===n&&mi[a]===o){t.push(a);break}}}for(let i=0;i<16;i++){const t=new Et;t.set(fi[i],pi[i],gi[i],mi[i],0,0),tl.push(t)}}gd();const lt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>fi[i],uY:i=>pi[i],vX:i=>gi[i],vY:i=>mi[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>po[i][t],sub:(i,t)=>po[i][lt.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?lt.S:lt.N:Math.abs(t)*2<=Math.abs(i)?i>0?lt.E:lt.W:t>0?i>0?lt.SE:lt.SW:i>0?lt.NE:lt.NW,matrixAppendRotationInv:(i,t,e=0,s=0)=>{const r=tl[lt.inv(t)];r.tx=e,r.ty=s,i.append(r)}};class Ye{constructor(t,e,s=0,r=0){this._x=s,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new Ye(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const el=class{constructor(){this.worldTransform=new Et,this.localTransform=new Et,this.position=new Ye(this.onChange,this,0,0),this.scale=new Ye(this.onChange,this,1,1),this.pivot=new Ye(this.onChange,this,0,0),this.skew=new Ye(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const i=this.localTransform;this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(i){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==i._worldID){const e=i.worldTransform,s=this.worldTransform;s.a=t.a*e.a+t.b*e.c,s.b=t.a*e.b+t.b*e.d,s.c=t.c*e.a+t.d*e.c,s.d=t.c*e.b+t.d*e.d,s.tx=t.tx*e.a+t.ty*e.c+e.tx,s.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=i._worldID,this._worldID++}}setFromMatrix(i){i.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(i){this._rotation!==i&&(this._rotation=i,this.updateSkew())}};let qo=el;qo.IDENTITY=new el;var md=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,_d=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function th(i,t,e){const s=i.createShader(t);return i.shaderSource(s,e),i.compileShader(s),s}function Mn(i){const t=new Array(i);for(let e=0;e<t.length;e++)t[e]=!1;return t}function il(i,t){switch(i){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Mn(2*t);case"bvec3":return Mn(3*t);case"bvec4":return Mn(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Yi=[{test:i=>i.type==="float"&&i.size===1&&!i.isArray,code:i=>`
            if(uv["${i}"] !== ud["${i}"].value)
            {
                ud["${i}"].value = uv["${i}"]
                gl.uniform1f(ud["${i}"].location, uv["${i}"])
            }
            `},{test:(i,t)=>(i.type==="sampler2D"||i.type==="samplerCube"||i.type==="sampler2DArray")&&i.size===1&&!i.isArray&&(t==null||t.castToBaseTexture!==void 0),code:i=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${i}"], t);

            if(ud["${i}"].value !== t)
            {
                ud["${i}"].value = t;
                gl.uniform1i(ud["${i}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(i,t)=>i.type==="mat3"&&i.size===1&&!i.isArray&&t.a!==void 0,code:i=>`
            gl.uniformMatrix3fv(ud["${i}"].location, false, uv["${i}"].toArray(true));
            `,codeUbo:i=>`
                var ${i}_matrix = uv.${i}.toArray(true);

                data[offset] = ${i}_matrix[0];
                data[offset+1] = ${i}_matrix[1];
                data[offset+2] = ${i}_matrix[2];
        
                data[offset + 4] = ${i}_matrix[3];
                data[offset + 5] = ${i}_matrix[4];
                data[offset + 6] = ${i}_matrix[5];
        
                data[offset + 8] = ${i}_matrix[6];
                data[offset + 9] = ${i}_matrix[7];
                data[offset + 10] = ${i}_matrix[8];
            `},{test:(i,t)=>i.type==="vec2"&&i.size===1&&!i.isArray&&t.x!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${i}"].location, v.x, v.y);
                }`,codeUbo:i=>`
                v = uv.${i};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:i=>i.type==="vec2"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${i}"].location, v[0], v[1]);
                }
            `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.width!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${i}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.red!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${i}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(i,t)=>i.type==="vec3"&&i.size===1&&!i.isArray&&t.red!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${i}"].location, v.red, v.green, v.blue)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:i=>i.type==="vec4"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${i}"].location, v[0], v[1], v[2], v[3])
                }`}],yd={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},xd={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function vd(i,t){var s;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in i.uniforms){const n=t[r];if(!n){(s=i.uniforms[r])!=null&&s.group&&(i.uniforms[r].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const o=i.uniforms[r];let a=!1;for(let h=0;h<Yi.length;h++)if(Yi[h].test(n,o)){e.push(Yi[h].code(r,o)),a=!0;break}if(!a){const l=(n.size===1&&!n.isArray?yd:xd)[n.type].replace("location",`ud["${r}"].location`);e.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const sl={};let Bi=sl;function bd(){if(Bi===sl||Bi!=null&&Bi.isContextLost()){const i=O.ADAPTER.createCanvas();let t;O.PREFER_ENV>=Pi.WEBGL2&&(t=i.getContext("webgl2",{})),t||(t=i.getContext("webgl",{})||i.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Bi=t}return Bi}let or;function wd(){if(!or){or=re.MEDIUM;const i=bd();i&&i.getShaderPrecisionFormat&&(or=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision?re.HIGH:re.MEDIUM)}return or}function eh(i,t){const e=i.getShaderSource(t).split(`
`).map((l,c)=>`${c}: ${l}`),s=i.getShaderInfoLog(t),r=s.split(`
`),n={},o=r.map(l=>parseFloat(l.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(l=>l&&!n[l]?(n[l]=!0,!0):!1),a=[""];o.forEach(l=>{e[l-1]=`%c${e[l-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=e.join(`
`);a[0]=h,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function Td(i,t,e,s){i.getProgramParameter(t,i.LINK_STATUS)||(i.getShaderParameter(e,i.COMPILE_STATUS)||eh(i,e),i.getShaderParameter(s,i.COMPILE_STATUS)||eh(i,s),console.error("PixiJS Error: Could not initialize shader."),i.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",i.getProgramInfoLog(t)))}const Sd={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function rl(i){return Sd[i]}let ar=null;const ih={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function nl(i,t){if(!ar){const e=Object.keys(ih);ar={};for(let s=0;s<e.length;++s){const r=e[s];ar[i[r]]=ih[r]}}return ar[t]}function sh(i,t,e){if(i.substring(0,9)!=="precision"){let s=t;return t===re.HIGH&&e!==re.HIGH&&(s=re.MEDIUM),`precision ${s} float;
${i}`}else if(e!==re.HIGH&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}let ps;function Ed(){if(typeof ps=="boolean")return ps;try{ps=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{ps=!1}return ps}let Ad=0;const hr={},Ni=class{constructor(i,t,e="pixi-shader",s={}){this.extra={},this.id=Ad++,this.vertexSrc=i||Ni.defaultVertexSrc,this.fragmentSrc=t||Ni.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),hr[e]?(hr[e]++,e+=`-${hr[e]}`):hr[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=sh(this.vertexSrc,Ni.defaultVertexPrecision,re.HIGH),this.fragmentSrc=sh(this.fragmentSrc,Ni.defaultFragmentPrecision,wd())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return _d}static get defaultFragmentSrc(){return md}static from(i,t,e){const s=i+t;let r=qa[s];return r||(qa[s]=r=new Ni(i,t,e)),r}};let Ue=Ni;Ue.defaultVertexPrecision=re.HIGH;Ue.defaultFragmentPrecision=xi.apple.device?re.HIGH:re.MEDIUM;let Cd=0;class xe{constructor(t,e,s){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Cd++,this.static=!!e,this.ubo=!!s,t instanceof Dt?(this.buffer=t,this.buffer.type=Me.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Dt(new Float32Array(1)),this.buffer.type=Me.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,s){if(!this.ubo)this.uniforms[t]=new xe(e,s);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,s){return new xe(t,e,s)}static uboFrom(t,e){return new xe(t,e??!0,!0)}}class Ys{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof xe?this.uniformGroup=e:this.uniformGroup=new xe(e):this.uniformGroup=new xe({}),this.disposeRunner=new ye("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const s in e.uniforms){const r=e.uniforms[s];if(r.group&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,s){const r=Ue.from(t,e);return new Ys(r,s)}}class Id{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const s=new Int32Array(t);for(let n=0;n<t;n++)s[n]=n;this.defaultGroupCache[t]=xe.from({uSamplers:s},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${t}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Ue(this.vertexSrc,r)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Et,default:this.defaultGroupCache[t]};return new Ys(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let s=0;s<t;s++)s>0&&(e+=`
else `),s<t-1&&(e+=`if(vTextureId < ${s}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${s}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class go{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function Rd(){return!xi.apple.device}function Pd(i){let t=!0;const e=O.ADAPTER.getNavigator();if(xi.tablet||xi.phone){if(xi.apple.device){const s=e.userAgent.match(/OS (\d+)_(\d+)?/);s&&parseInt(s[1],10)<11&&(t=!1)}if(xi.android.device){const s=e.userAgent.match(/Android\s([0-9.]*)/);s&&parseInt(s[1],10)<7&&(t=!1)}}return t?i:4}class ol{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var Md=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,kd=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const ue=class extends ol{constructor(i){super(i),this.setShaderGenerator(),this.geometryClass=Qh,this.vertexSize=6,this.state=hs.for2d(),this.size=ue.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),i.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Pd(32),this._defaultMaxTextures}static set defaultMaxTextures(i){this._defaultMaxTextures=i}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Rd(),this._canUploadSameBuffer}static set canUploadSameBuffer(i){this._canUploadSameBuffer=i}get MAX_TEXTURES(){return $("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return kd}static get defaultFragmentTemplate(){return Md}setShaderGenerator({vertex:i=ue.defaultVertexSrc,fragment:t=ue.defaultFragmentTemplate}={}){this.shaderGenerator=new Id(i,t)}contextChange(){const i=this.renderer.gl;O.PREFER_ENV===Pi.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),ue.defaultMaxTextures),this.maxTextures=od(this.maxTextures,i)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:i,_textureArrayPool:t}=ue,e=this.size/4,s=Math.floor(e/this.maxTextures)+1;for(;i.length<e;)i.push(new fo);for(;t.length<s;)t.push(new go);for(let r=0;r<this.maxTextures;r++)this._tempBoundTextures[r]=null}onPrerender(){this._flushId=0}render(i){i._texture.valid&&(this._vertexCount+i.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=i.vertexData.length/2,this._indexCount+=i.indices.length,this._bufferedTextures[this._bufferSize]=i._texture.baseTexture,this._bufferedElements[this._bufferSize++]=i)}buildTexturesAndDrawCalls(){const{_bufferedTextures:i,maxTextures:t}=this,e=ue._textureArrayPool,s=this.renderer.batch,r=this._tempBoundTextures,n=this.renderer.textureGC.count;let o=++W._globalBatch,a=0,h=e[0],l=0;s.copyBoundTextures(r,t);for(let c=0;c<this._bufferSize;++c){const d=i[c];i[c]=null,d._batchEnabled!==o&&(h.count>=t&&(s.boundArray(h,r,o,t),this.buildDrawCalls(h,l,c),l=c,h=e[++a],++o),d._batchEnabled=o,d.touched=n,h.elements[h.count++]=d)}h.count>0&&(s.boundArray(h,r,o,t),this.buildDrawCalls(h,l,this._bufferSize),++a,++o);for(let c=0;c<r.length;c++)r[c]=null;W._globalBatch=o}buildDrawCalls(i,t,e){const{_bufferedElements:s,_attributeBuffer:r,_indexBuffer:n,vertexSize:o}=this,a=ue._drawCallPool;let h=this._dcIndex,l=this._aIndex,c=this._iIndex,d=a[h];d.start=this._iIndex,d.texArray=i;for(let u=t;u<e;++u){const p=s[u],f=p._texture.baseTexture,g=Ju[f.alphaMode?1:0][p.blendMode];s[u]=null,t<u&&d.blend!==g&&(d.size=c-d.start,t=u,d=a[++h],d.texArray=i,d.start=c),this.packInterleavedGeometry(p,r,n,l,c),l+=p.vertexData.length/2*o,c+=p.indices.length,d.blend=g}t<e&&(d.size=c-d.start,++h),this._dcIndex=h,this._aIndex=l,this._iIndex=c}bindAndClearTexArray(i){const t=this.renderer.texture;for(let e=0;e<i.count;e++)t.bind(i.elements[e],i.ids[e]),i.elements[e]=null;i.count=0}updateGeometry(){const{_packedGeometries:i,_attributeBuffer:t,_indexBuffer:e}=this;ue.canUploadSameBuffer?(i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,i[this._flushId]=new this.geometryClass),i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(i[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const i=this._dcIndex,{gl:t,state:e}=this.renderer,s=ue._drawCallPool;let r=null;for(let n=0;n<i;n++){const{texArray:o,type:a,size:h,start:l,blend:c}=s[n];r!==o&&(r=o,this.bindAndClearTexArray(o)),this.state.blendMode=c,e.set(this.state),t.drawElements(a,h,t.UNSIGNED_SHORT,l*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),ue.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]&&this._packedGeometries[i].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(i){const t=Cr(Math.ceil(i/8)),e=Ya(t),s=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._aBuffers[s];return r||(this._aBuffers[s]=r=new sd(s*this.vertexSize*4)),r}getIndexBuffer(i){const t=Cr(Math.ceil(i/12)),e=Ya(t),s=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._iBuffers[e];return r||(this._iBuffers[e]=r=new Uint16Array(s)),r}packInterleavedGeometry(i,t,e,s,r){const{uint32View:n,float32View:o}=t,a=s/this.vertexSize,h=i.uvs,l=i.indices,c=i.vertexData,d=i._texture.baseTexture._batchLocation,u=Math.min(i.worldAlpha,1),p=St.shared.setValue(i._tintRGB).toPremultiplied(u);for(let f=0;f<c.length;f+=2)o[s++]=c[f],o[s++]=c[f+1],o[s++]=h[f],o[s++]=h[f+1],n[s++]=p,o[s++]=d;for(let f=0;f<l.length;f++)e[r++]=a+l[f]}};let ge=ue;ge.defaultBatchSize=4096;ge.extension={name:"batch",type:k.RendererPlugin};ge._drawCallPool=[];ge._textureArrayPool=[];D.add(ge);var Bd=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Ld=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const xs=class extends Ys{constructor(i,t,e){const s=Ue.from(i||xs.defaultVertexSrc,t||xs.defaultFragmentSrc);super(s,e),this.padding=0,this.resolution=xs.defaultResolution,this.multisample=xs.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new hs}apply(i,t,e,s,r){i.applyFilter(this,t,e,s)}get blendMode(){return this.state.blendMode}set blendMode(i){this.state.blendMode=i}get resolution(){return this._resolution}set resolution(i){this._resolution=i}static get defaultVertexSrc(){return Ld}static get defaultFragmentSrc(){return Bd}};let qe=xs;qe.defaultResolution=1;qe.defaultMultisample=xt.NONE;class Yr{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new St(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:s,backgroundAlpha:r}=t,n=s??e;n!==void 0&&(this.color=n),this.alpha=r}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}Yr.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};Yr.extension={type:[k.RendererSystem,k.CanvasRendererSystem],name:"background"};D.add(Yr);class al{constructor(t){this.renderer=t,this.emptyRenderer=new ol(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:s}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=s[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,s,r){const{elements:n,ids:o,count:a}=t;let h=0;for(let l=0;l<a;l++){const c=n[l],d=c._batchLocation;if(d>=0&&d<r&&e[d]===c){o[l]=d;continue}for(;h<r;){const u=e[h];if(u&&u._batchEnabled===s&&u._batchLocation===h){h++;continue}o[l]=h,c._batchLocation=h,e[h]=c;break}}}destroy(){this.renderer=null}}al.extension={type:k.RendererSystem,name:"batch"};D.add(al);let rh=0;class qr{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=rh++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,s=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:s,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=rh++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let s;if(O.PREFER_ENV>=Pi.WEBGL2&&(s=t.getContext("webgl2",e)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),s="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;s&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=s||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}qr.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};qr.extension={type:k.RendererSystem,name:"context"};D.add(qr);class Od extends Xo{upload(t,e,s){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ni.UNPACK);const n=e.realWidth,o=e.realHeight;return s.width===n&&s.height===o?r.texSubImage2D(e.target,0,0,0,n,o,e.format,s.type,this.data):(s.width=n,s.height=o,r.texImage2D(e.target,0,s.internalFormat,n,o,0,e.format,s.type,this.data)),!0}}class mo{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ye("disposeFramebuffer"),this.multisample=xt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new W(null,{scaleMode:De.NEAREST,resolution:1,mipmap:Ei.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new W(new Od(null,{width:this.width,height:this.height}),{scaleMode:De.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Ei.OFF,format:P.DEPTH_COMPONENT,type:K.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let s=0;s<this.colorTextures.length;s++){const r=this.colorTextures[s],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){const s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class hl extends W{constructor(t={}){if(typeof t=="number"){const e=arguments[0],s=arguments[1],r=arguments[2],n=arguments[3];t={width:e,height:s,scaleMode:r,resolution:n}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=xt.NONE),super(null,t),this.mipmap=Ei.OFF,this.valid=!0,this._clear=new St([0,0,0,0]),this.framebuffer=new mo(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class ii extends Fs{constructor(t){const e=t,s=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;super(s,r),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,s){s===void 0&&!e.startsWith("data:")?t.crossOrigin=id(e):s!==!1&&(t.crossOrigin=typeof s=="string"?s:"anonymous")}upload(t,e,s,r){const n=t.gl,o=e.realWidth,a=e.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1&&r.buffered.length===0)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ni.UNPACK),!this.noSubImage&&e.target===n.TEXTURE_2D&&s.width===o&&s.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,s.type,r):(s.width=o,s.height=a,n.texImage2D(e.target,0,s.internalFormat,e.format,s.type,r)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,s=t.naturalHeight||t.videoHeight||t.height;this.resize(e,s),super.update()}dispose(){this.source=null}}class ll extends ii{constructor(t,e){if(e=e||{},typeof t=="string"){const s=new Image;ii.crossOrigin(s,t,e.crossorigin),s.src=t,t=s}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??O.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,s)=>{const r=this.source;this.url=r.src;const n=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.resize(r.width,r.height),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?n():(r.onload=n,r.onerror=o=>{s(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,s=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:s?"cors":"no-cors"}).then(r=>r.blob()).then(r=>e(r,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ni.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,s){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,s);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,s,this.bitmap),!this.preserveBitmap){let r=!0;const n=e._glTextures;for(const o in n){const a=n[o];if(a!==s&&a.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class cl{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,s){const r=e.width,n=e.height;if(s){const o=t.width/2/r,a=t.height/2/n,h=t.x/r+o,l=t.y/n+a;s=lt.add(s,lt.NW),this.x0=h+o*lt.uX(s),this.y0=l+a*lt.uY(s),s=lt.add(s,2),this.x1=h+o*lt.uX(s),this.y1=l+a*lt.uY(s),s=lt.add(s,2),this.x2=h+o*lt.uX(s),this.y2=l+a*lt.uY(s),s=lt.add(s,2),this.x3=h+o*lt.uX(s),this.y3=l+a*lt.uY(s)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const nh=new cl;function lr(i){i.destroy=function(){},i.on=function(){},i.once=function(){},i.emit=function(){}}class U extends Ai{constructor(t,e,s,r,n,o,a){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new j(0,0,1,1)),t instanceof U&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this._uvs=nh,this.uvMatrix=null,this.orig=s||e,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new tt(o.x,o.y):new tt(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&Ae[e.url]&&U.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,U.removeFromCache(this),this.textureCacheIds=null}clone(){var r;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),s=new U(this.baseTexture,!this.noFrame&&t,e,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(s._frame=t),s}updateUvs(){this._uvs===nh&&(this._uvs=new cl),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},s=O.STRICT_TEXTURE_CACHE){const r=typeof t=="string";let n=null;if(r)n=t;else if(t instanceof W){if(!t.cacheId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${Os()}`,W.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${Os()}`}n=t._pixiId}let o=Ae[n];if(r&&s&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(t instanceof W)?(e.resolution||(e.resolution=Ir(t)),o=new U(new W(t,e)),o.baseTexture.cacheId=n,W.addToCache(o.baseTexture,n),U.addToCache(o,n)):!o&&t instanceof W&&(o=new U(t),U.addToCache(o,n)),o}static fromURL(t,e){const s=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),r=U.from(t,Object.assign({resourceOptions:s},e),!1),n=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):n.load().then(()=>Promise.resolve(r))}static fromBuffer(t,e,s,r){return new U(W.fromBuffer(t,e,s,r))}static fromLoader(t,e,s,r){const n=new W(t,Object.assign({scaleMode:W.defaultOptions.scaleMode,resolution:Ir(e)},r)),{resource:o}=n;o instanceof ll&&(o.url=e);const a=new U(n);return s||(s=e),W.addToCache(a.baseTexture,s),U.addToCache(a,s),s!==e&&(W.addToCache(a.baseTexture,e),U.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise(h=>{a.baseTexture.once("loaded",()=>h(a))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Ae[e]&&Ae[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),Ae[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Ae[t];if(e){const s=e.textureCacheIds.indexOf(t);return s>-1&&e.textureCacheIds.splice(s,1),delete Ae[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)Ae[t.textureCacheIds[e]]===t&&delete Ae[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:s,width:r,height:n}=t,o=e+r>this.baseTexture.width,a=s+n>this.baseTexture.height;if(o||a){const h=o&&a?"and":"or",l=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,c=`Y: ${s} + ${n} = ${s+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${l} ${h} ${c}`)}this.valid=r&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return U._EMPTY||(U._EMPTY=new U(new W),lr(U._EMPTY),lr(U._EMPTY.baseTexture)),U._EMPTY}static get WHITE(){if(!U._WHITE){const t=O.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),U._WHITE=new U(W.from(t)),lr(U._WHITE),lr(U._WHITE.baseTexture)}return U._WHITE}}class Kr extends U{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,s=!0){const r=this.baseTexture.resolution,n=Math.round(t*r)/r,o=Math.round(e*r)/r;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,s&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new Kr(new hl(t))}}class ul{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,s=xt.NONE){const r=new hl(Object.assign({width:t,height:e,resolution:1,multisample:s},this.textureOptions));return new Kr(r)}getOptimalTexture(t,e,s=1,r=xt.NONE){let n;t=Math.ceil(t*s-1e-6),e=Math.ceil(e*s-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Cr(t),e=Cr(e),n=((t&65535)<<16|e&65535)>>>0,r>1&&(n+=r*4294967296)):n=r>1?-r:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,e,r)),o.filterPoolKey=n,o.setResolution(s),o}getFilterTexture(t,e,s){const r=this.getOptimalTexture(t.width,t.height,e||t.resolution,s||xt.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const s=this.texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const s=this.texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}ul.SCREEN_KEY=-1;class Fd extends Ji{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Nd extends Ji{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Dt(this.vertices),this.uvBuffer=new Dt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let s=0,r=0;return this.uvs[0]=s,this.uvs[1]=r,this.uvs[2]=s+e.width/t.width,this.uvs[3]=r,this.uvs[4]=s+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=s,this.uvs[7]=r+e.height/t.height,s=e.x,r=e.y,this.vertices[0]=s,this.vertices[1]=r,this.vertices[2]=s+e.width,this.vertices[3]=r,this.vertices[4]=s+e.width,this.vertices[5]=r+e.height,this.vertices[6]=s,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Dd{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=xt.NONE,this.sourceFrame=new j,this.destinationFrame=new j,this.bindingSourceFrame=new j,this.bindingDestinationFrame=new j,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const cr=[new tt,new tt,new tt,new tt],kn=new Et;class dl{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new ul,this.statePool=[],this.quad=new Fd,this.quadUv=new Nd,this.tempRect=new j,this.activeState={},this.globalUniforms=new xe({outputFrame:new j,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const s=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Dd,o=this.renderer.renderTexture;let a=e[0].resolution,h=e[0].multisample,l=e[0].padding,c=e[0].autoFit,d=e[0].legacy??!0;for(let f=1;f<e.length;f++){const g=e[f];a=Math.min(a,g.resolution),h=Math.min(h,g.multisample),l=this.useMaxPadding?Math.max(l,g.padding):l+g.padding,c=c&&g.autoFit,d=d||(g.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),r.push(n),n.resolution=a,n.multisample=h,n.legacy=d,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(l);const u=this.tempRect.copyFrom(o.sourceFrame);s.projection.transform&&this.transformAABB(kn.copyFrom(s.projection.transform).invert(),u),c?(n.sourceFrame.fit(u),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(u)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:s.resolution,o.sourceFrame,o.destinationFrame,s.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a,h),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=n.sourceFrame.width,p.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=s.projection.transform,s.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,p),s.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),s=e.filters;this.activeState=e;const r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;const n=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*e.resolution),o[1]=Math.round(n[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=e.sourceFrame.width*n[2]-.5*o[2],a[3]=e.sourceFrame.height*n[3]-.5*o[3],e.legacy){const l=r.filterArea;l[0]=e.destinationFrame.width,l[1]=e.destinationFrame.height,l[2]=e.sourceFrame.x,l[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const h=t[t.length-1];if(this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,e.renderTexture,h.renderTexture,di.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let l=e.renderTexture,c=this.getOptimalFilterTexture(l.width,l.height,e.resolution);c.filterFrame=l.filterFrame;let d=0;for(d=0;d<s.length-1;++d){d===1&&e.multisample>1&&(c=this.getOptimalFilterTexture(l.width,l.height,e.resolution),c.filterFrame=l.filterFrame),s[d].apply(this,l,c,di.CLEAR,e);const u=l;l=c,c=u}s[d].apply(this,l,h.renderTexture,di.BLEND,e),d>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=di.CLEAR){const{renderTexture:s,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,s.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?s.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=r.stateId&1||this.forceClear;(e===di.CLEAR||e===di.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,s,r){const n=this.renderer;n.state.set(t.state),this.bindAndClear(s,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(je.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(je.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:s,destinationFrame:r}=this.activeState,{orig:n}=e._texture,o=t.set(r.width,0,0,r.height,s.x,s.y),a=e.worldTransform.copyTo(Et.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(e.anchor.x,e.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,s=1,r=xt.NONE){return this.texturePool.getOptimalTexture(t,e,s,r)}getFilterTexture(t,e,s){if(typeof t=="number"){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,s||xt.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const s=cr[0],r=cr[1],n=cr[2],o=cr[3];s.set(e.left,e.top),r.set(e.left,e.bottom),n.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(s,s),t.apply(r,r),t.apply(n,n),t.apply(o,o);const a=Math.min(s.x,r.x,n.x,o.x),h=Math.min(s.y,r.y,n.y,o.y),l=Math.max(s.x,r.x,n.x,o.x),c=Math.max(s.y,r.y,n.y,o.y);e.x=a,e.y=h,e.width=l-a,e.height=c-h}roundFrame(t,e,s,r,n){if(!(t.width<=0||t.height<=0||s.width<=0||s.height<=0)){if(n){const{a:o,b:a,c:h,d:l}=n;if((Math.abs(a)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(l)>1e-4))return}n=n?kn.copyFrom(n):kn.identity(),n.translate(-s.x,-s.y).scale(r.width/s.width,r.height/s.height).translate(r.x,r.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}dl.extension={type:k.RendererSystem,name:"filter"};D.add(dl);class Ud{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=xt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Gd=new j;class fl{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new mo(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new j,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;O.PREFER_ENV===Pi.WEBGL_LEGACY&&(e=null,s=null),e?t.drawBuffers=r=>e.drawBuffersWEBGL(r):(this.hasMRT=!1,t.drawBuffers=()=>{}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,s=0){const{gl:r}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==s&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=s),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,s)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const o=e.width>>s,a=e.height>>s,h=o/e.width;this.setViewport(e.x*h,e.y*h,o,a)}else{const o=t.width>>s,a=t.height>>s;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,s,r){const n=this.viewport;t=Math.round(t),e=Math.round(e),s=Math.round(s),r=Math.round(r),(n.width!==s||n.height!==r||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=s,n.height=r,this.gl.viewport(t,e,s,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,s,r,n=Qn.COLOR|Qn.DEPTH){const{gl:o}=this;o.clearColor(t,e,s,r),o.clear(n)}initFramebuffer(t){const{gl:e}=this,s=new Ud(e.createFramebuffer());return s.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(t),t.disposeRunner.add(this),s}resizeFramebuffer(t){const{gl:e}=this,s=t.glFramebuffers[this.CONTEXT_UID];s.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,s.stencil),s.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const r=t.colorTextures;let n=r.length;e.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){const a=r[o],h=a.parentTextureArray||a;this.renderer.texture.bind(h,0),o===0&&s.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,s.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:s}=this,r=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let o=n.length;s.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||s.createRenderbuffer():r.msaaBuffer&&(s.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const a=[];for(let h=0;h<o;h++){const l=n[h],c=l.parentTextureArray||l;this.renderer.texture.bind(c,0),h===0&&r.msaaBuffer?(s.bindRenderbuffer(s.RENDERBUFFER,r.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,r.msaaBuffer)):(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+h,l.target,c._glTextures[this.CONTEXT_UID].texture,e),a.push(s.COLOR_ATTACHMENT0+h))}if(a.length>1&&s.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const l=t.depthTexture;this.renderer.texture.bind(l,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,r.stencil),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,s.DEPTH24_STENCIL8,t.width,t.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,r.stencil)):r.stencil&&(s.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let s=xt.NONE;if(t<=1||e===null)return s;for(let r=0;r<e.length;r++)if(e[r]<=t){s=e[r];break}return s===1&&(s=xt.NONE),s}blit(t,e,s){const{current:r,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!r)return;const h=r.glFramebuffers[a];if(!h)return;if(!t){if(!h.msaaBuffer)return;const c=r.colorTextures[0];if(!c)return;h.blitFramebuffer||(h.blitFramebuffer=new mo(r.width,r.height),h.blitFramebuffer.addColorTexture(0,c)),t=h.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||(e=Gd,e.width=r.width,e.height=r.height),s||(s=e);const l=e.width===s.width&&e.height===s.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,s.left,s.top,s.right,s.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR)}disposeFramebuffer(t,e){const s=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!s)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(s.framebuffer),s.msaaBuffer&&r.deleteRenderbuffer(s.msaaBuffer),s.stencil&&r.deleteRenderbuffer(s.stencil)),s.blitFramebuffer&&this.disposeFramebuffer(s.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let s=0;s<e.length;s++)this.disposeFramebuffer(e[s],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const s=t.width,r=t.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,n.DEPTH24_STENCIL8,s,r):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,s,r),e.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new j}destroy(){this.renderer=null}}fl.extension={type:k.RendererSystem,name:"framebuffer"};D.add(fl);const Bn={5126:4,5123:2,5121:1};class pl{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let s=this.renderer.context.extensions.vertexArrayObject;O.PREFER_ENV===Pi.WEBGL_LEGACY&&(s=null),s?(t.createVertexArray=()=>s.createVertexArrayOES(),t.bindVertexArray=r=>s.bindVertexArrayOES(r),t.deleteVertexArray=r=>s.deleteVertexArrayOES(r)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const s=t.getExtension("ANGLE_instanced_arrays");s?(t.vertexAttribDivisor=(r,n)=>s.vertexAttribDivisorANGLE(r,n),t.drawElementsInstanced=(r,n,o,a,h)=>s.drawElementsInstancedANGLE(r,n,o,a,h),t.drawArraysInstanced=(r,n,o,a)=>s.drawArraysInstancedANGLE(r,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:s}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},n=!0);const o=r[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?s.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let s=0;s<t.buffers.length;s++){const r=t.buffers[s];e.update(r)}}checkCompatibility(t,e){const s=t.attributes,r=e.attributeData;for(const n in r)if(!s[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,e){const s=t.attributes,r=e.attributeData,n=["g",t.id];for(const o in s)r[o]&&n.push(o,r[o].location);return n.join("-")}initGeometryVao(t,e,s=!0){const r=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=e.program;a.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);const h=this.getSignature(t,a),l=t.glVertexArrayObjects[this.CONTEXT_UID];let c=l[h];if(c)return l[a.id]=c,c;const d=t.buffers,u=t.attributes,p={},f={};for(const g in d)p[g]=0,f[g]=0;for(const g in u)!u[g].size&&a.attributeData[g]?u[g].size=a.attributeData[g].size:u[g].size||console.warn(`PIXI Geometry attribute '${g}' size cannot be determined (likely the bound shader does not have the attribute)`),p[u[g].buffer]+=u[g].size*Bn[u[g].type];for(const g in u){const m=u[g],x=m.size;m.stride===void 0&&(p[m.buffer]===x*Bn[m.type]?m.stride=0:m.stride=p[m.buffer]),m.start===void 0&&(m.start=f[m.buffer],f[m.buffer]+=x*Bn[m.type])}c=r.createVertexArray(),r.bindVertexArray(c);for(let g=0;g<d.length;g++){const m=d[g];o.bind(m),s&&m._glBuffers[n].refCount++}return this.activateVao(t,a),l[a.id]=c,l[h]=c,r.bindVertexArray(null),o.unbind(Me.ARRAY_BUFFER),c}disposeGeometry(t,e){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const s=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!s){if(o)for(let h=0;h<n.length;h++){const l=n[h]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!e&&o.dispose(n[h],e))}if(!e){for(const h in s)if(h[0]==="g"){const l=s[h];this._activeVao===l&&this.unbind(),r.deleteVertexArray(l)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let s=0;s<e.length;s++)this.disposeGeometry(this.managedGeometries[e[s]],t)}activateVao(t,e){const s=this.gl,r=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let h=null;for(const l in a){const c=a[l],d=o[c.buffer],u=d._glBuffers[r];if(e.attributeData[l]){h!==u&&(n.bind(d),h=u);const p=e.attributeData[l].location;if(s.enableVertexAttribArray(p),s.vertexAttribPointer(p,c.size,c.type||s.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)s.vertexAttribDivisor(p,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,s,r){const{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,h=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,e||o.indexBuffer.data.length,h,(s||0)*a,r||1):n.drawElements(t,e||o.indexBuffer.data.length,h,(s||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,s,e||o.getSize(),r||1):n.drawArrays(t,s,e||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}pl.extension={type:k.RendererSystem,name:"geometry"};D.add(pl);const oh=new Et;class Vd{constructor(t,e){this._texture=t,this.mapCoord=new Et,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const s=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];e[r]=n*s.a+o*s.c+s.tx,e[r+1]=n*s.b+o*s.d+s.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const s=e._uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);const r=e.orig,n=e.trim;n&&(oh.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(oh));const o=e.baseTexture,a=this.uClampFrame,h=this.clampMargin/o.resolution,l=this.clampOffset;return a[0]=(e._frame.x+h+l)/o.width,a[1]=(e._frame.y+h+l)/o.height,a[2]=(e._frame.x+e._frame.width-h+l)/o.width,a[3]=(e._frame.y+e._frame.height-h+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&e.rotate===0,!0}}var zd=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Hd=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Wd extends qe{constructor(t,e,s){let r=null;typeof t!="string"&&e===void 0&&s===void 0&&(r=t,t=void 0,e=void 0,s=void 0),super(t||Hd,e||zd,s),this.maskSprite=r,this.maskMatrix=new Et}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,s,r){const n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Vd(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,s,r))}}class Xd{constructor(t=null){this.type=wt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=qe.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=wt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class gl{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let s=e;if(!s.isMaskData){const n=this.maskDataPool.pop()||new Xd;n.pooled=!0,n.maskObject=e,s=n}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(s.copyCountersOrReset(r),s._colorMask=r?r._colorMask:15,s.autoDetect&&this.detect(s),s._target=t,s.type!==wt.SPRITE&&this.maskStack.push(s),s.enabled)switch(s.type){case wt.SCISSOR:this.renderer.scissor.push(s);break;case wt.STENCIL:this.renderer.stencil.push(s);break;case wt.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s);break;case wt.COLOR:this.pushColorMask(s);break}s.type===wt.SPRITE&&this.maskStack.push(s)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case wt.SCISSOR:this.renderer.scissor.pop(e);break;case wt.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case wt.SPRITE:this.popSpriteMask(e);break;case wt.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const s=this.maskStack[this.maskStack.length-1];s.type===wt.SPRITE&&s._filters&&(s._filters[0].maskSprite=s.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=wt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=wt.SCISSOR:t.type=wt.STENCIL:t.type=wt.COLOR}pushSpriteMask(t){const{maskObject:e}=t,s=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new Wd]));const n=this.renderer,o=n.renderTexture;let a,h;if(o.current){const c=o.current;a=t.resolution||c.resolution,h=t.multisample??c.multisample}else a=t.resolution||n.resolution,h=t.multisample??n.multisample;r[0].resolution=a,r[0].multisample=h,r[0].maskSprite=e;const l=s.filterArea;s.filterArea=e.getBounds(!0),n.filter.push(s,r),s.filterArea=l,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,s=t._colorMask=e&t.colorMask;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}popColorMask(t){const e=t._colorMask,s=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}destroy(){this.renderer=null}}gl.extension={type:k.RendererSystem,name:"mask"};D.add(gl);class ml{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,s=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==s&&(r===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const ah=new Et,hh=[],_r=class extends ml{constructor(i){super(i),this.glConst=O.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const i=this.maskStack[this.maskStack.length-1];return i?i._scissorCounter:0}calcScissorRect(i){if(i._scissorRectLocal)return;const t=i._scissorRect,{maskObject:e}=i,{renderer:s}=this,r=s.renderTexture,n=e.getBounds(!0,hh.pop()??new j);this.roundFrameToPixels(n,r.current?r.current.resolution:s.resolution,r.sourceFrame,r.destinationFrame,s.projection.transform),t&&n.fit(t),i._scissorRectLocal=n}static isMatrixRotated(i){if(!i)return!1;const{a:t,b:e,c:s,d:r}=i;return(Math.abs(e)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(r)>1e-4)}testScissor(i){const{maskObject:t}=i;if(!t.isFastRect||!t.isFastRect()||_r.isMatrixRotated(t.worldTransform)||_r.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(i);const e=i._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(i,t,e,s,r){_r.isMatrixRotated(r)||(r=r?ah.copyFrom(r):ah.identity(),r.translate(-e.x,-e.y).scale(s.width/e.width,s.height/e.height).translate(s.x,s.y),this.renderer.filter.transformAABB(r,i),i.fit(s),i.x=Math.round(i.x*t),i.y=Math.round(i.y*t),i.width=Math.round(i.width*t),i.height=Math.round(i.height*t))}push(i){i._scissorRectLocal||this.calcScissorRect(i);const{gl:t}=this.renderer;i._scissorRect||t.enable(t.SCISSOR_TEST),i._scissorCounter++,i._scissorRect=i._scissorRectLocal,this._useCurrent()}pop(i){const{gl:t}=this.renderer;i&&hh.push(i._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const i=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=i.y:t=this.renderer.height-i.height-i.y,this.renderer.gl.scissor(i.x,t,i.width,i.height)}};let _l=_r;_l.extension={type:k.RendererSystem,name:"scissor"};D.add(_l);class yl extends ml{constructor(t){super(t),this.glConst=O.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:s}=this.renderer,r=t._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),s.clearStencil(0),s.clear(s.STENCIL_BUFFER_BIT),s.enable(s.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilFunc(s.EQUAL,r,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(t._colorMask=n,s.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=s?s._colorMask:15;r!==0&&(s._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,r!==0&&(s._colorMask=r,e.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}yl.extension={type:k.RendererSystem,name:"stencil"};D.add(yl);class xl{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return $("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return $("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return $("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}xl.extension={type:[k.RendererSystem,k.CanvasRendererSystem],name:"_plugin"};D.add(xl);class vl{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Et,this.transform=null}update(t,e,s,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,r),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,s,r){const n=this.projectionMatrix,o=r?-1:1;n.identity(),n.a=1/e.width*2,n.d=o*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-o-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}vl.extension={type:k.RendererSystem,name:"projection"};D.add(vl);const $d=new qo;class bl{constructor(t){this.renderer=t,this._tempMatrix=new Et}generateTexture(t,e){const{region:s,...r}=e||{},n=s||t.getLocalBounds(null,!0);n.width===0&&(n.width=1),n.height===0&&(n.height=1);const o=Kr.create({width:n.width,height:n.height,...r});this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const a=t.transform;return t.transform=$d,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,o}destroy(){}}bl.extension={type:[k.RendererSystem,k.CanvasRendererSystem],name:"textureGenerator"};D.add(bl);const hi=new j,gs=new j;class wl{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new j,this.destinationFrame=new j,this.viewportFrame=new j}bind(t=null,e,s){const r=this.renderer;this.current=t;let n,o,a;t?(n=t.baseTexture,a=n.resolution,e||(hi.width=t.frame.width,hi.height=t.frame.height,e=hi),s||(gs.x=t.frame.x,gs.y=t.frame.y,gs.width=e.width,gs.height=e.height,s=gs),o=n.framebuffer):(a=r.resolution,e||(hi.width=r._view.screen.width,hi.height=r._view.screen.height,e=hi),s||(s=hi,s.width=e.width,s.height=e.height));const h=this.viewportFrame;h.x=s.x*a,h.y=s.y*a,h.width=s.width*a,h.height=s.height*a,t||(h.y=r.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(s,e,a,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(s)}clear(t,e){const s=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=t?St.shared.setValue(t):s,n=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==o.width||n.height!==o.height;if(a){let{x:h,y:l,width:c,height:d}=this.viewportFrame;h=Math.round(h),l=Math.round(l),c=Math.round(c),d=Math.round(d),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,l,c,d)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}wl.extension={type:k.RendererSystem,name:"renderTexture"};D.add(wl);class jd{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function Yd(i,t){const e={},s=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES);for(let r=0;r<s;r++){const n=t.getActiveAttrib(i,r);if(n.name.startsWith("gl_"))continue;const o=nl(t,n.type),a={type:o,name:n.name,size:rl(o),location:t.getAttribLocation(i,n.name)};e[n.name]=a}return e}function qd(i,t){const e={},s=t.getProgramParameter(i,t.ACTIVE_UNIFORMS);for(let r=0;r<s;r++){const n=t.getActiveUniform(i,r),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),h=nl(t,n.type);e[o]={name:o,index:r,type:h,size:n.size,isArray:a,value:il(h,n.size)}}return e}function Kd(i,t){var h;const e=th(i,i.VERTEX_SHADER,t.vertexSrc),s=th(i,i.FRAGMENT_SHADER,t.fragmentSrc),r=i.createProgram();i.attachShader(r,e),i.attachShader(r,s);const n=(h=t.extra)==null?void 0:h.transformFeedbackVaryings;if(n&&(typeof i.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):i.transformFeedbackVaryings(r,n.names,n.bufferMode==="separate"?i.SEPARATE_ATTRIBS:i.INTERLEAVED_ATTRIBS)),i.linkProgram(r),i.getProgramParameter(r,i.LINK_STATUS)||Td(i,r,e,s),t.attributeData=Yd(r,i),t.uniformData=qd(r,i),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const l=Object.keys(t.attributeData);l.sort((c,d)=>c>d?1:-1);for(let c=0;c<l.length;c++)t.attributeData[l[c]].location=c,i.bindAttribLocation(r,c,l[c]);i.linkProgram(r)}i.deleteShader(e),i.deleteShader(s);const o={};for(const l in t.uniformData){const c=t.uniformData[l];o[l]={location:i.getUniformLocation(r,l),value:il(c.type,c.size)}}return new jd(r,o)}function Zd(i,t,e,s,r){e.buffer.update(r)}const Jd={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Tl={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Qd(i){const t=i.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let e=0,s=0,r=0;for(let n=0;n<t.length;n++){const o=t[n];if(e=Tl[o.data.type],o.data.size>1&&(e=Math.max(e,16)*o.data.size),o.dataLen=e,s%e!==0&&s<16){const a=s%e%16;s+=a,r+=a}s+e>16?(r=Math.ceil(r/16)*16,o.offset=r,r+=e,s=e):(o.offset=r,s+=e,r+=e)}return r=Math.ceil(r/16)*16,{uboElements:t,size:r}}function tf(i,t){const e=[];for(const s in i)t[s]&&e.push(t[s]);return e.sort((s,r)=>s.index-r.index),e}function ef(i,t){if(!i.autoManage)return{size:0,syncFunc:Zd};const e=tf(i.uniforms,t),{uboElements:s,size:r}=Qd(e),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<s.length;o++){const a=s[o],h=i.uniforms[a.data.name],l=a.data.name;let c=!1;for(let d=0;d<Yi.length;d++){const u=Yi[d];if(u.codeUbo&&u.test(a.data,h)){n.push(`offset = ${a.offset/4};`,Yi[d].codeUbo(a.data.name,h)),c=!0;break}}if(!c)if(a.data.size>1){const d=rl(a.data.type),u=Math.max(Tl[a.data.type]/16,1),p=d/u,f=(4-p%4)%4;n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*u}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${f};
                }

                `)}else{const d=Jd[a.data.type];n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};
                ${d};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let sf=0;const ur={textureCount:0,uboCount:0};class Sl{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=sf++}systemCheck(){if(!Ed())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const s=t.program,r=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==s&&(this.program=s,this.gl.useProgram(r.program)),e||(ur.textureCount=0,ur.uboCount=0,this.syncUniformGroup(t.uniformGroup,ur)),r}setUniforms(t){const e=this.shader.program,s=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(s.uniformData,t,this.renderer)}syncUniformGroup(t,e){const s=this.getGlProgram();(!t.static||t.dirtyId!==s.uniformDirtyGroups[t.id])&&(s.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,s,e))}syncUniforms(t,e,s){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,s)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=vd(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const s=this.getGlProgram();if(!t.static||t.dirtyId!==0||!s.uniformGroups[t.id]){t.dirtyId=0;const r=s.uniformGroups[t.id]||this.createSyncBufferGroup(t,s,e);t.buffer.update(),r(s.uniformData,t.uniforms,this.renderer,ur,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,s.uniformBufferBindings[e])}createSyncBufferGroup(t,e,s){const{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(e.program,s);e.uniformBufferBindings[s]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=ef(t,this.shader.program.uniformData)),t.autoManage){const h=new Float32Array(a.size/4);t.buffer.update(h)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,s){const r=t.uniforms,n=[`${s}-`];for(const o in r)n.push(o),e[o]&&n.push(e[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,s=t.program,r=Kd(e,s);return s.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Sl.extension={type:k.RendererSystem,name:"shader"};D.add(Sl);class Zr{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.2.2 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}Zr.defaultOptions={hello:!1};Zr.extension={type:[k.RendererSystem,k.CanvasRendererSystem],name:"startup"};D.add(Zr);function rf(i,t=[]){return t[N.NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.ADD]=[i.ONE,i.ONE],t[N.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.SCREEN]=[i.ONE,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.NONE]=[0,0],t[N.NORMAL_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.ADD_NPM]=[i.SRC_ALPHA,i.ONE,i.ONE,i.ONE],t[N.SCREEN_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.SRC_IN]=[i.DST_ALPHA,i.ZERO],t[N.SRC_OUT]=[i.ONE_MINUS_DST_ALPHA,i.ZERO],t[N.SRC_ATOP]=[i.DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[N.DST_OVER]=[i.ONE_MINUS_DST_ALPHA,i.ONE],t[N.DST_IN]=[i.ZERO,i.SRC_ALPHA],t[N.DST_OUT]=[i.ZERO,i.ONE_MINUS_SRC_ALPHA],t[N.DST_ATOP]=[i.ONE_MINUS_DST_ALPHA,i.SRC_ALPHA],t[N.XOR]=[i.ONE_MINUS_DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[N.SUBTRACT]=[i.ONE,i.ONE,i.ONE,i.ONE,i.FUNC_REVERSE_SUBTRACT,i.FUNC_ADD],t}const nf=0,of=1,af=2,hf=3,lf=4,cf=5,_o=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=N.NONE,this._blendEq=!1,this.map=[],this.map[nf]=this.setBlend,this.map[of]=this.setOffset,this.map[af]=this.setCullFace,this.map[hf]=this.setDepthTest,this.map[lf]=this.setFrontFace,this.map[cf]=this.setDepthMask,this.checks=[],this.defaultState=new hs,this.defaultState.blend=!0}contextChange(i){this.gl=i,this.blendModes=rf(i),this.set(this.defaultState),this.reset()}set(i){if(i=i||this.defaultState,this.stateId!==i.data){let t=this.stateId^i.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(i.data&1<<e)),t=t>>1,e++;this.stateId=i.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,i)}forceState(i){i=i||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(i.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,i);this.stateId=i.data}setBlend(i){this.updateCheck(_o.checkBlendMode,i),this.gl[i?"enable":"disable"](this.gl.BLEND)}setOffset(i){this.updateCheck(_o.checkPolygonOffset,i),this.gl[i?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(i){this.gl[i?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(i){this.gl.depthMask(i)}setCullFace(i){this.gl[i?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(i){this.gl.frontFace(this.gl[i?"CW":"CCW"])}setBlendMode(i){if(i===this.blendMode)return;this.blendMode=i;const t=this.blendModes[i],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(i,t){this.gl.polygonOffset(i,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(i,t){const e=this.checks.indexOf(i);t&&e===-1?this.checks.push(i):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(i,t){i.setBlendMode(t.blendMode)}static checkPolygonOffset(i,t){i.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let El=_o;El.extension={type:k.RendererSystem,name:"state"};D.add(El);class uf extends Ai{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(r=>t.systems[r]),s=[...e,...Object.keys(t.systems).filter(r=>!e.includes(r))];for(const r of s)this.addSystem(t.systems[r],r)}addRunners(...t){t.forEach(e=>{this.runners[e]=new ye(e)})}addSystem(t,e){const s=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=s,this._systemsHash[e]=s;for(const r in this.runners)this.runners[r].add(s);return this}emitWithCustomOptions(t,e){const s=Object.keys(this._systemsHash);t.items.forEach(r=>{const n=s.find(o=>this._systemsHash[o]===r);r[t.name](e[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const yr=class{constructor(i){this.renderer=i,this.count=0,this.checkCount=0,this.maxIdle=yr.defaultMaxIdle,this.checkCountMax=yr.defaultCheckCountMax,this.mode=yr.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Wo.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const i=this.renderer.texture,t=i.managedTextures;let e=!1;for(let s=0;s<t.length;s++){const r=t[s];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(i.destroyTexture(r,!0),t[s]=null,e=!0)}if(e){let s=0;for(let r=0;r<t.length;r++)t[r]!==null&&(t[s++]=t[r]);t.length=s}}unload(i){const t=this.renderer.texture,e=i._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let s=i.children.length-1;s>=0;s--)this.unload(i.children[s])}destroy(){this.renderer=null}};let me=yr;me.defaultMode=Wo.AUTO;me.defaultMaxIdle=60*60;me.defaultCheckCountMax=60*10;me.extension={type:k.RendererSystem,name:"textureGC"};D.add(me);class Ln{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=K.UNSIGNED_BYTE,this.internalFormat=P.RGBA,this.samplerType=0}}function df(i){let t;return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?t={[K.UNSIGNED_BYTE]:{[P.RGBA]:i.RGBA8,[P.RGB]:i.RGB8,[P.RG]:i.RG8,[P.RED]:i.R8,[P.RGBA_INTEGER]:i.RGBA8UI,[P.RGB_INTEGER]:i.RGB8UI,[P.RG_INTEGER]:i.RG8UI,[P.RED_INTEGER]:i.R8UI,[P.ALPHA]:i.ALPHA,[P.LUMINANCE]:i.LUMINANCE,[P.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[K.BYTE]:{[P.RGBA]:i.RGBA8_SNORM,[P.RGB]:i.RGB8_SNORM,[P.RG]:i.RG8_SNORM,[P.RED]:i.R8_SNORM,[P.RGBA_INTEGER]:i.RGBA8I,[P.RGB_INTEGER]:i.RGB8I,[P.RG_INTEGER]:i.RG8I,[P.RED_INTEGER]:i.R8I},[K.UNSIGNED_SHORT]:{[P.RGBA_INTEGER]:i.RGBA16UI,[P.RGB_INTEGER]:i.RGB16UI,[P.RG_INTEGER]:i.RG16UI,[P.RED_INTEGER]:i.R16UI,[P.DEPTH_COMPONENT]:i.DEPTH_COMPONENT16},[K.SHORT]:{[P.RGBA_INTEGER]:i.RGBA16I,[P.RGB_INTEGER]:i.RGB16I,[P.RG_INTEGER]:i.RG16I,[P.RED_INTEGER]:i.R16I},[K.UNSIGNED_INT]:{[P.RGBA_INTEGER]:i.RGBA32UI,[P.RGB_INTEGER]:i.RGB32UI,[P.RG_INTEGER]:i.RG32UI,[P.RED_INTEGER]:i.R32UI,[P.DEPTH_COMPONENT]:i.DEPTH_COMPONENT24},[K.INT]:{[P.RGBA_INTEGER]:i.RGBA32I,[P.RGB_INTEGER]:i.RGB32I,[P.RG_INTEGER]:i.RG32I,[P.RED_INTEGER]:i.R32I},[K.FLOAT]:{[P.RGBA]:i.RGBA32F,[P.RGB]:i.RGB32F,[P.RG]:i.RG32F,[P.RED]:i.R32F,[P.DEPTH_COMPONENT]:i.DEPTH_COMPONENT32F},[K.HALF_FLOAT]:{[P.RGBA]:i.RGBA16F,[P.RGB]:i.RGB16F,[P.RG]:i.RG16F,[P.RED]:i.R16F},[K.UNSIGNED_SHORT_5_6_5]:{[P.RGB]:i.RGB565},[K.UNSIGNED_SHORT_4_4_4_4]:{[P.RGBA]:i.RGBA4},[K.UNSIGNED_SHORT_5_5_5_1]:{[P.RGBA]:i.RGB5_A1},[K.UNSIGNED_INT_2_10_10_10_REV]:{[P.RGBA]:i.RGB10_A2,[P.RGBA_INTEGER]:i.RGB10_A2UI},[K.UNSIGNED_INT_10F_11F_11F_REV]:{[P.RGB]:i.R11F_G11F_B10F},[K.UNSIGNED_INT_5_9_9_9_REV]:{[P.RGB]:i.RGB9_E5},[K.UNSIGNED_INT_24_8]:{[P.DEPTH_STENCIL]:i.DEPTH24_STENCIL8},[K.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[P.DEPTH_STENCIL]:i.DEPTH32F_STENCIL8}}:t={[K.UNSIGNED_BYTE]:{[P.RGBA]:i.RGBA,[P.RGB]:i.RGB,[P.ALPHA]:i.ALPHA,[P.LUMINANCE]:i.LUMINANCE,[P.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[K.UNSIGNED_SHORT_5_6_5]:{[P.RGB]:i.RGB},[K.UNSIGNED_SHORT_4_4_4_4]:{[P.RGBA]:i.RGBA},[K.UNSIGNED_SHORT_5_5_5_1]:{[P.RGBA]:i.RGBA}},t}class Al{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new W,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=df(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};const s=new Ln(t.createTexture());t.bindTexture(t.TEXTURE_2D,s.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=s,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Ln(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(t,e=0){const{gl:s}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:s}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<s.length;r++)s[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<s.length;r++)s[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),s[r]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:s,CONTEXT_UID:r}=this;if(s)for(let n=t-1;n>=0;--n){const o=e[n];o&&o._glTextures[r].samplerType!==to.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const e=new Ln(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var s;e.internalFormat=((s=this.internalFormats[t.type])==null?void 0:s[t.format])??t.format,this.webGLVersion===2&&t.type===K.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var r;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const s=this.renderer;if(this.initTextureType(t,e),(r=t.resource)!=null&&r.upload(s,t,e))e.samplerType!==to.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,o=t.realHeight,a=s.gl;(e.width!==n||e.height!==o||e.dirtyId<0)&&(e.width=n,e.height=o,a.texImage2D(t.target,0,e.internalFormat,n,o,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:s}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),s.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const r=this.managedTextures.indexOf(t);r!==-1&&mr(this.managedTextures,r,1)}}updateTextureStyle(t){var s;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===Ei.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=Ps.CLAMP:e.wrapMode=t.wrapMode,(s=t.resource)!=null&&s.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const s=this.gl;if(e.mipmap&&t.mipmap!==Ei.ON_MANUAL&&s.generateMipmap(t.target),s.texParameteri(t.target,s.TEXTURE_WRAP_S,e.wrapMode),s.texParameteri(t.target,s.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===De.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===De.LINEAR){const n=Math.min(t.anisotropicLevel,s.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===De.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(t.target,s.TEXTURE_MAG_FILTER,t.scaleMode===De.LINEAR?s.LINEAR:s.NEAREST)}destroy(){this.renderer=null}}Al.extension={type:k.RendererSystem,name:"texture"};D.add(Al);class Cl{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glTransformFeedbacks[s]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:s,renderer:r}=this;e&&r.shader.bind(e),s.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:s,CONTEXT_UID:r}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[r]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(s.buffer.update(a),a._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const s=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const h=a._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&n.dispose(a,e))}s&&(e||r.deleteTransformFeedback(s),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Cl.extension={type:k.RendererSystem,name:"transformFeedback"};D.add(Cl);class Jr{constructor(t){this.renderer=t}init(t){this.screen=new j(0,0,t.width,t.height),this.element=t.view||O.ADAPTER.createCanvas(),this.resolution=t.resolution||O.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const s=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=s,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${s}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",s,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Jr.defaultOptions={width:800,height:600,resolution:O.RESOLUTION,autoDensity:!1};Jr.extension={type:[k.RendererSystem,k.CanvasRendererSystem],name:"_view"};D.add(Jr);O.PREFER_ENV=Pi.WEBGL2;O.STRICT_TEXTURE_CACHE=!1;O.RENDER_OPTIONS={...qr.defaultOptions,...Yr.defaultOptions,...Jr.defaultOptions,...Zr.defaultOptions};Object.defineProperties(O,{WRAP_MODE:{get(){return W.defaultOptions.wrapMode},set(i){$("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),W.defaultOptions.wrapMode=i}},SCALE_MODE:{get(){return W.defaultOptions.scaleMode},set(i){$("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),W.defaultOptions.scaleMode=i}},MIPMAP_TEXTURES:{get(){return W.defaultOptions.mipmap},set(i){$("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),W.defaultOptions.mipmap=i}},ANISOTROPIC_LEVEL:{get(){return W.defaultOptions.anisotropicLevel},set(i){$("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),W.defaultOptions.anisotropicLevel=i}},FILTER_RESOLUTION:{get(){return $("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),qe.defaultResolution},set(i){qe.defaultResolution=i}},FILTER_MULTISAMPLE:{get(){return $("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),qe.defaultMultisample},set(i){qe.defaultMultisample=i}},SPRITE_MAX_TEXTURES:{get(){return ge.defaultMaxTextures},set(i){$("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),ge.defaultMaxTextures=i}},SPRITE_BATCH_SIZE:{get(){return ge.defaultBatchSize},set(i){$("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),ge.defaultBatchSize=i}},CAN_UPLOAD_SAME_BUFFER:{get(){return ge.canUploadSameBuffer},set(i){$("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),ge.canUploadSameBuffer=i}},GC_MODE:{get(){return me.defaultMode},set(i){$("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),me.defaultMode=i}},GC_MAX_IDLE:{get(){return me.defaultMaxIdle},set(i){$("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),me.defaultMaxIdle=i}},GC_MAX_CHECK_COUNT:{get(){return me.defaultCheckCountMax},set(i){$("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),me.defaultCheckCountMax=i}},PRECISION_VERTEX:{get(){return Ue.defaultVertexPrecision},set(i){$("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Ue.defaultVertexPrecision=i}},PRECISION_FRAGMENT:{get(){return Ue.defaultFragmentPrecision},set(i){$("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Ue.defaultFragmentPrecision=i}}});var Ns=(i=>(i[i.INTERACTION=50]="INTERACTION",i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(Ns||{});class On{constructor(t,e=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=s,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const qt=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new On(null,null,1/0),this.deltaMS=1/qt.targetFPMS,this.elapsedMS=1/qt.targetFPMS,this._tick=i=>{this._requestId=null,this.started&&(this.update(i),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(i,t,e=Ns.NORMAL){return this._addListener(new On(i,t,e))}addOnce(i,t,e=Ns.NORMAL){return this._addListener(new On(i,t,e,!0))}_addListener(i){let t=this._head.next,e=this._head;if(!t)i.connect(e);else{for(;t;){if(i.priority>t.priority){i.connect(e);break}e=t,t=t.next}i.previous||i.connect(e)}return this._startIfPossible(),this}remove(i,t){let e=this._head.next;for(;e;)e.match(i,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let i=0,t=this._head;for(;t=t.next;)i++;return i}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let i=this._head.next;for(;i;)i=i.destroy(!0);this._head.destroy(),this._head=null}}update(i=performance.now()){let t;if(i>this.lastTime){if(t=this.elapsedMS=i-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const r=i-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=i-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*qt.targetFPMS;const e=this._head;let s=e.next;for(;s;)s=s.emit(this.deltaTime);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=i}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(i){const t=Math.min(this.maxFPS,i),e=Math.min(Math.max(0,t)/1e3,qt.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(i){if(i===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,i);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!qt._shared){const i=qt._shared=new qt;i.autoStart=!0,i._protected=!0}return qt._shared}static get system(){if(!qt._system){const i=qt._system=new qt;i.autoStart=!0,i._protected=!0}return qt._system}};let Ut=qt;Ut.targetFPMS=.06;Object.defineProperties(O,{TARGET_FPMS:{get(){return Ut.targetFPMS},set(i){$("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ut.targetFPMS=i}}});class Il{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Ns.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Ut.shared:new Ut,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Il.extension=k.Application;D.add(Il);const Rl=[];D.handleByList(k.Renderer,Rl);function ff(i){for(const t of Rl)if(t.test(i))return new t(i);throw new Error("Unable to auto-detect a suitable renderer.")}class Pl{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const s=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,s)}else{const s=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,s)}e>=xt.HIGH?this.multisample=xt.HIGH:e>=xt.MEDIUM?this.multisample=xt.MEDIUM:e>=xt.LOW?this.multisample=xt.LOW:this.multisample=xt.NONE}destroy(){}}Pl.extension={type:k.RendererSystem,name:"_multisample"};D.add(Pl);class pf{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Ml{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glBuffers[s]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:s,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,s.bindBufferBase(s.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,s){const{gl:r,CONTEXT_UID:n}=this;s=s||0;const o=t._glBuffers[n]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,o.buffer,s*256,256)}update(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glBuffers[s]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const s=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),s&&(e||r.deleteBuffer(s.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let s=0;s<e.length;s++)this.dispose(this.managedBuffers[e[s]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:s}=this;return t._glBuffers[e]=new pf(s.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}Ml.extension={type:k.RendererSystem,name:"buffer"};D.add(Ml);class kl{constructor(t){this.renderer=t}render(t,e){const s=this.renderer;let r,n,o,a;if(e&&(r=e.renderTexture,n=e.clear,o=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!r,s.runners.prerender.emit(),s.emit("prerender"),s.projection.transform=o,!s.context.isLost){if(r||(this.lastObjectRendered=t),!a){const h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}s.renderTexture.bind(r),s.batch.currentRenderer.start(),(n??s.background.clearBeforeRender)&&s.renderTexture.clear(),t.render(s),s.batch.currentRenderer.flush(),r&&(e.blit&&s.framebuffer.blit(),r.baseTexture.update()),s.runners.postrender.emit(),s.projection.transform=null,s.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}kl.extension={type:k.RendererSystem,name:"objectRenderer"};D.add(kl);const yo=class extends uf{constructor(i){super(),this.type=zh.WEBGL,i=Object.assign({},O.RENDER_OPTIONS,i),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new xe({projectionMatrix:new Et},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:yo.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in i&&($("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),i.premultipliedAlpha=i.useContextAlpha&&i.useContextAlpha!=="notMultiplied",i.backgroundAlpha=i.useContextAlpha===!1?1:i.backgroundAlpha),this._plugin.rendererPlugins=yo.__plugins,this.options=i,this.startup.run(this.options)}static test(i){return i!=null&&i.forceCanvas?!1:Gu()}render(i,t){this.objectRenderer.render(i,t)}resize(i,t){this._view.resizeView(i,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(i=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:i}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(i){this._view.resolution=i,this.runners.resolutionChange.emit(i)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return $("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return $("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return $("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return $("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(i){$("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=i}get backgroundAlpha(){return $("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(i){$("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=i}get powerPreference(){return $("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(i,t){return this.textureGenerator.generateTexture(i,t)}};let ls=yo;ls.extension={type:k.Renderer,priority:1};ls.__plugins={};ls.__systems={};D.handleByMap(k.RendererPlugin,ls.__plugins);D.handleByMap(k.RendererSystem,ls.__systems);D.add(ls);class Bl extends Fs{constructor(t,e){const{width:s,height:r}=e||{};super(s,r),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const o=new W;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let s=0;s<this.length;s++)t[s]&&(t[s].castToBaseTexture?this.addBaseTextureAt(t[s].castToBaseTexture(),s):t[s]instanceof Fs?this.addResourceAt(t[s],s):this.addResourceAt(Jh(t[s],e),s))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const e=this.items.map(s=>s.resource).filter(s=>s).map(s=>s.load());return this._load=Promise.all(e).then(()=>{const{realWidth:s,realHeight:r}=this.items[0];return this.resize(s,r),Promise.resolve(this)}),this._load}}class gf extends Bl{constructor(t,e){const{width:s,height:r}=e||{};let n,o;Array.isArray(t)?(n=t,o=t.length):o=t,super(o,{width:s,height:r}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Xi.TEXTURE_2D_ARRAY}upload(t,e,s){const{length:r,itemDirtyIds:n,items:o}=this,{gl:a}=t;s.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,s.internalFormat,this._width,this._height,r,0,e.format,s.type,null);for(let h=0;h<r;h++){const l=o[h];n[h]<l.dirtyId&&(n[h]=l.dirtyId,l.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,l.resource.width,l.resource.height,1,e.format,s.type,l.resource.source))}return!0}}class mf extends ii{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const vs=class extends Bl{constructor(i,t){const{width:e,height:s,autoLoad:r,linkBaseTexture:n}=t||{};if(i&&i.length!==vs.SIDES)throw new Error(`Invalid length. Got ${i.length}, expected 6`);super(6,{width:e,height:s});for(let o=0;o<vs.SIDES;o++)this.items[o].target=Xi.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=n!==!1,i&&this.initFromArray(i,t),r!==!1&&this.load()}bind(i){super.bind(i),i.target=Xi.TEXTURE_CUBE_MAP}addBaseTextureAt(i,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||i.parentTextureArray||Object.keys(i._glTextures).length>0)if(i.resource)this.addResourceAt(i.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else i.target=Xi.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.parentTextureArray=this.baseTexture,this.items[t]=i;return i.valid&&!this.valid&&this.resize(i.realWidth,i.realHeight),this.items[t]=i,this}upload(i,t,e){const s=this.itemDirtyIds;for(let r=0;r<vs.SIDES;r++){const n=this.items[r];(s[r]<n.dirtyId||e.dirtyId<t.dirtyId)&&(n.valid&&n.resource?(n.resource.upload(i,n,e),s[r]=n.dirtyId):s[r]<-1&&(i.gl.texImage2D(n.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),s[r]=-1))}return!0}static test(i){return Array.isArray(i)&&i.length===vs.SIDES}};let Ll=vs;Ll.SIDES=6;class Gi extends ii{constructor(t,e){e=e||{};let s,r;typeof t=="string"?(s=Gi.EMPTY,r=t):(s=t,r=null),super(s),this.url=r,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const s=await O.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await s.blob();if(this.destroyed)return;const n=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ni.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=n,this.update(),t(this)}catch(s){if(this.destroyed)return;e(s),this.onError.emit(s)}}),this._load)}upload(t,e,s){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,s)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Gi._EMPTY=Gi._EMPTY??O.ADAPTER.createCanvas(0,0),Gi._EMPTY}}const xr=class extends ii{constructor(i,t){t=t||{},super(O.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=i,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(i=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),i(this)},xr.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const i=new Image;ii.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=t=>{this._resolve&&(i.onerror=null,this.onError.emit(t))},i.onload=()=>{if(!this._resolve)return;const t=i.width,e=i.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=t*this.scale,r=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/e*t,r=this._overrideHeight||this._overrideWidth/t*e),s=Math.round(s),r=Math.round(r);const n=this.source;n.width=s,n.height=r,n._pixiId=`canvas_${Os()}`,n.getContext("2d").drawImage(i,0,0,t,e,0,0,s,r),this._resolve(),this._resolve=null}}static getSize(i){const t=xr.SVG_SIZE.exec(i),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(i,t){return t==="svg"||typeof i=="string"&&i.startsWith("data:image/svg+xml")||typeof i=="string"&&xr.SVG_XML.test(i)}};let Ds=xr;Ds.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;Ds.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const xo=class extends ii{constructor(i,t){if(t=t||{},!(i instanceof HTMLVideoElement)){const e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof i=="string"&&(i=[i]);const s=i[0].src||i[0];ii.crossOrigin(e,s,t.crossorigin);for(let r=0;r<i.length;++r){const n=document.createElement("source");let{src:o,mime:a}=i[r];o=o||i[r];const h=o.split("?").shift().toLowerCase(),l=h.slice(h.lastIndexOf(".")+1);a=a||xo.MIME_TYPES[l]||`video/${l}`,n.src=o,n.type=a,e.appendChild(n)}i=e}super(i),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(i=0){if(!this.destroyed){const t=Ut.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,i.load())}),this._load}_onError(i){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(i)}_isSourcePlaying(){const i=this.source;return!i.paused&&!i.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ut.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const i=this.source;i.removeEventListener("canplay",this._onCanPlay),i.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(i.videoWidth,i.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&i.play()}dispose(){this._isConnectedToTicker&&(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1);const i=this.source;i&&(i.removeEventListener("error",this._onError,!0),i.pause(),i.src="",i.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(i){i!==this._autoUpdate&&(this._autoUpdate=i,!this._autoUpdate&&this._isConnectedToTicker?(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ut.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(i){i!==this._updateFPS&&(this._updateFPS=i)}static test(i,t){return globalThis.HTMLVideoElement&&i instanceof HTMLVideoElement||xo.TYPES.includes(t)}};let Ko=xo;Ko.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];Ko.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};uo.push(Gi,ll,mf,Ko,Ds,Xo,Ll,gf);class _f{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(Ut.system.add(this.tickerUpdate,this,Ns.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Ut.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const yi=new _f;class Qr{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Qr.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new tt,this.page=new tt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,s){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,s,r,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Mr extends Qr{constructor(){super(...arguments),this.client=new tt,this.movement=new tt,this.offset=new tt,this.global=new tt,this.screen=new tt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,s){return t.worldTransform.applyInverse(s||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,s,r,n,o,a,h,l,c,d,u,p,f,g){throw new Error("Method not implemented.")}}class de extends Mr{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Qi extends Mr{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Qi.DOM_DELTA_PIXEL=0;Qi.DOM_DELTA_LINE=1;Qi.DOM_DELTA_PAGE=2;const yf=2048,xf=new tt,Fn=new tt;class vf{constructor(t){this.dispatch=new Ai,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._collectInteractiveElements=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((s,r)=>s.priority-r.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let s=0,r=e.length;s<r;s++)e[s].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){yi.pauseUpdate=!0;const s=this.hitTestRecursive(this.rootTarget,this.rootTarget.eventMode,xf.set(t,e),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(t,e){if(!t.target)return;const s=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,n=s.length-1;r<n;r++)if(t.currentTarget=s[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let r=s.length-2;r>=0;r--)if(t.currentTarget=s[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,s=this._allInteractiveElements){if(s.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const r=Array.isArray(e)?e:[e];for(let n=s.length-1;n>=0;n--)r.forEach(o=>{t.currentTarget=s[n],this.notifyTarget(t,o)})}propagationPath(t){const e=[t];for(let s=0;s<yf&&t!==this.rootTarget;s++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestRecursive(t,e,s,r,n){if(n(t,s))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(yi.pauseUpdate=!1),t.interactiveChildren&&t.children){const h=t.children;for(let l=h.length-1;l>=0;l--){const c=h[l],d=this.hitTestRecursive(c,this._isInteractive(e)?e:c.eventMode,s,r,n);if(d){if(d.length>0&&!d[d.length-1].parent)continue;const u=t.isInteractive();if((d.length>0||u)&&(this._collectInteractiveElements&&u&&this._allInteractiveElements.push(t),d.push(t)),this._collectInteractiveElements&&this._hitElements.length===0&&(this._hitElements=d),!this._collectInteractiveElements)return d}}}const o=this._isInteractive(e),a=t.isInteractive();return this._collectInteractiveElements&&(o&&a&&this._allInteractiveElements.push(t),this._hitElements.length>0)?null:o&&r(t,s)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}hitPruneFn(t,e){var s;if(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)return!0;if(this._collectInteractiveElements)return!1;if(t.hitArea&&(t.worldTransform.applyInverse(e,Fn),!t.hitArea.contains(Fn.x,Fn.y)))return!0;if(t._mask){const r=t._mask.isMaskData?t._mask.maskObject:t._mask;if(r&&!((s=r.containsPoint)!=null&&s.call(r,e)))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var n,o;e=e??t.type;const s=`on${e}`;(o=(n=t.currentTarget)[s])==null||o.call(n,t);const r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof de)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const r=e.button===2;this.dispatchEvent(e,r?"rightdown":"mousedown")}const s=this.trackingData(t.pointerId);s.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var h,l;if(!(t instanceof de)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._collectInteractiveElements=!0;const e=this.createPointerEvent(t);this._collectInteractiveElements=!1;const s=e.pointerType==="mouse"||e.pointerType==="pen",r=this.trackingData(t.pointerId),n=this.findMountedTarget(r.overTargets);if(((h=r.overTargets)==null?void 0:h.length)>0&&n!==e.target){const c=t.type==="mousemove"?"mouseout":"pointerout",d=this.createPointerEvent(t,c,n);if(this.dispatchEvent(d,"pointerout"),s&&this.dispatchEvent(d,"mouseout"),!e.composedPath().includes(n)){const u=this.createPointerEvent(t,"pointerleave",n);for(u.eventPhase=u.AT_TARGET;u.target&&!e.composedPath().includes(u.target);)u.currentTarget=u.target,this.notifyTarget(u),s&&this.notifyTarget(u,"mouseleave"),u.target=u.target.parent;this.freeEvent(u)}this.freeEvent(d)}if(n!==e.target){const c=t.type==="mousemove"?"mouseover":"pointerover",d=this.clonePointerEvent(e,c);this.dispatchEvent(d,"pointerover"),s&&this.dispatchEvent(d,"mouseover");let u=n==null?void 0:n.parent;for(;u&&u!==this.rootTarget.parent&&u!==e.target;)u=u.parent;if(!u||u===this.rootTarget.parent){const f=this.clonePointerEvent(e,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==n&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),s&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(d)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(e,"pointermove"),a&&o.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),a&&o.push("globaltouchmove")),s&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(l=e.target)==null?void 0:l.cursor),o.length>0&&this.all(e,o),this._allInteractiveElements.length=0,this._hitElements.length=0,r.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var o;if(!(t instanceof de)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),s=this.createPointerEvent(t),r=s.pointerType==="mouse"||s.pointerType==="pen";this.dispatchEvent(s,"pointerover"),r&&this.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(this.cursor=(o=s.target)==null?void 0:o.cursor);const n=this.clonePointerEvent(s,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),r&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;e.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof de)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const s=t.pointerType==="mouse"||t.pointerType==="pen",r=this.findMountedTarget(e.overTargets),n=this.createPointerEvent(t,"pointerout",r);this.dispatchEvent(n),s&&this.dispatchEvent(n,"mouseout");const o=this.createPointerEvent(t,"pointerleave",r);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),s&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;e.overTargets=null,this.freeEvent(n),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof de)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),s=this.createPointerEvent(t);if(this.dispatchEvent(s,"pointerup"),s.pointerType==="touch")this.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const a=s.button===2;this.dispatchEvent(s,a?"rightup":"mouseup")}const r=this.trackingData(t.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[t.button]);let o=n;if(n&&!s.composedPath().includes(n)){let a=n;for(;a&&!s.composedPath().includes(a);){if(s.currentTarget=a,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")this.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const h=s.button===2;this.notifyTarget(s,h?"rightupoutside":"mouseupoutside")}a=a.parent}delete r.pressTargetsByButton[t.button],o=a}if(o){const a=this.clonePointerEvent(s,"click");a.target=o,a.path=null,r.clicksByButton[t.button]||(r.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:e});const h=r.clicksByButton[t.button];if(h.target===a.target&&e-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=a.target,h.timeStamp=e,a.detail=h.clickCount,a.pointerType==="mouse"){const l=a.button===2;this.dispatchEvent(a,l?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(s)}mapPointerUpOutside(t){if(!(t instanceof de)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),s=this.findMountedTarget(e.pressTargetsByButton[t.button]),r=this.createPointerEvent(t);if(s){let n=s;for(;n;)r.currentTarget=n,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(r)}mapWheel(t){if(!(t instanceof Qi)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let s=1;s<t.length&&t[s].parent===e;s++)e=t[s];return e}createPointerEvent(t,e,s){const r=this.allocateEvent(de);return this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=s??this.hitTest(r.global.x,r.global.y)??this._hitElements[0],typeof e=="string"&&(r.type=e),r}createWheelEvent(t){const e=this.allocateEvent(Qi);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const s=this.allocateEvent(de);return s.nativeEvent=t.nativeEvent,s.originalEvent=t.originalEvent,this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.target=t.target,s.path=t.composedPath().slice(),s.type=e??s.type,s}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof de&&e instanceof de&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Mr&&e instanceof Mr&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const s=t.currentTarget._events[e];if(s&&t.currentTarget.isInteractive())if("fn"in s)s.once&&t.currentTarget.removeListener(e,s.fn,void 0,!0),s.fn.call(s.context,t);else for(let r=0,n=s.length;r<n&&!t.propagationImmediatelyStopped;r++)s[r].once&&t.currentTarget.removeListener(e,s[r].fn,void 0,!0),s[r].fn.call(s[r].context,t)}}const bf=1,wf={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},vo=class{constructor(i){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=i,this.rootBoundary=new vf(null),yi.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new de(null),this.rootWheelEvent=new Qi(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...vo.defaultEventFeatures},{set:(t,e,s)=>(e==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=s),t[e]=s,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(i){const{view:t,resolution:e}=this.renderer;this.setTargetElement(t),this.resolution=e,vo._defaultEventMode=i.eventMode??"auto",Object.assign(this.features,i.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(i){this.resolution=i}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(i){i=i||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===i)return;this.currentCursor=i;const e=this.cursorStyles[i];if(e)switch(typeof e){case"string":t&&(this.domElement.style.cursor=e);break;case"function":e(i);break;case"object":t&&Object.assign(this.domElement.style,e);break}else t&&typeof i=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,i)&&(this.domElement.style.cursor=i)}get pointer(){return this.rootPointerEvent}onPointerDown(i){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&i.pointerType==="touch"))return;const t=this.normalizeToPointerData(i);this.autoPreventDefault&&t[0].isNormalized&&(i.cancelable||!("cancelable"in i))&&i.preventDefault();for(let e=0,s=t.length;e<s;e++){const r=t[e],n=this.bootstrapEvent(this.rootPointerEvent,r);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(i){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&i.pointerType==="touch"))return;yi.pointerMoved();const t=this.normalizeToPointerData(i);for(let e=0,s=t.length;e<s;e++){const r=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(i){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&i.pointerType==="touch"))return;let t=i.target;i.composedPath&&i.composedPath().length>0&&(t=i.composedPath()[0]);const e=t!==this.domElement?"outside":"",s=this.normalizeToPointerData(i);for(let r=0,n=s.length;r<n;r++){const o=this.bootstrapEvent(this.rootPointerEvent,s[r]);o.type+=e,this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(i){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&i.pointerType==="touch"))return;const t=this.normalizeToPointerData(i);for(let e=0,s=t.length;e<s;e++){const r=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onWheel(i){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(i);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(i){this.removeEvents(),this.domElement=i,yi.domElement=i,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;yi.addTickerListener();const i=this.domElement.style;i&&(globalThis.navigator.msPointerEnabled?(i.msContentZooming="none",i.msTouchAction="none"):this.supportsPointerEvents&&(i.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;yi.removeTickerListener();const i=this.domElement.style;globalThis.navigator.msPointerEnabled?(i.msContentZooming="",i.msTouchAction=""):this.supportsPointerEvents&&(i.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(i,t,e){let s;this.domElement.parentElement?s=this.domElement.getBoundingClientRect():s={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const r=1/this.resolution;i.x=(t-s.left)*(this.domElement.width/s.width)*r,i.y=(e-s.top)*(this.domElement.height/s.height)*r}normalizeToPointerData(i){const t=[];if(this.supportsTouchEvents&&i instanceof TouchEvent)for(let e=0,s=i.changedTouches.length;e<s;e++){const r=i.changedTouches[e];typeof r.button>"u"&&(r.button=0),typeof r.buttons>"u"&&(r.buttons=1),typeof r.isPrimary>"u"&&(r.isPrimary=i.touches.length===1&&i.type==="touchstart"),typeof r.width>"u"&&(r.width=r.radiusX||1),typeof r.height>"u"&&(r.height=r.radiusY||1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="touch"),typeof r.pointerId>"u"&&(r.pointerId=r.identifier||0),typeof r.pressure>"u"&&(r.pressure=r.force||.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),typeof r.layerX>"u"&&(r.layerX=r.offsetX=r.clientX),typeof r.layerY>"u"&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=i.type,t.push(r)}else if(!globalThis.MouseEvent||i instanceof MouseEvent&&(!this.supportsPointerEvents||!(i instanceof globalThis.PointerEvent))){const e=i;typeof e.isPrimary>"u"&&(e.isPrimary=!0),typeof e.width>"u"&&(e.width=1),typeof e.height>"u"&&(e.height=1),typeof e.tiltX>"u"&&(e.tiltX=0),typeof e.tiltY>"u"&&(e.tiltY=0),typeof e.pointerType>"u"&&(e.pointerType="mouse"),typeof e.pointerId>"u"&&(e.pointerId=bf),typeof e.pressure>"u"&&(e.pressure=.5),typeof e.twist>"u"&&(e.twist=0),typeof e.tangentialPressure>"u"&&(e.tangentialPressure=0),e.isNormalized=!0,t.push(e)}else t.push(i);return t}normalizeWheelEvent(i){const t=this.rootWheelEvent;return this.transferMouseData(t,i),t.deltaX=i.deltaX,t.deltaY=i.deltaY,t.deltaZ=i.deltaZ,t.deltaMode=i.deltaMode,this.mapPositionToPoint(t.screen,i.clientX,i.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=i,t.type=i.type,t}bootstrapEvent(i,t){return i.originalEvent=null,i.nativeEvent=t,i.pointerId=t.pointerId,i.width=t.width,i.height=t.height,i.isPrimary=t.isPrimary,i.pointerType=t.pointerType,i.pressure=t.pressure,i.tangentialPressure=t.tangentialPressure,i.tiltX=t.tiltX,i.tiltY=t.tiltY,i.twist=t.twist,this.transferMouseData(i,t),this.mapPositionToPoint(i.screen,t.clientX,t.clientY),i.global.copyFrom(i.screen),i.offset.copyFrom(i.screen),i.isTrusted=t.isTrusted,i.type==="pointerleave"&&(i.type="pointerout"),i.type.startsWith("mouse")&&(i.type=i.type.replace("mouse","pointer")),i.type.startsWith("touch")&&(i.type=wf[i.type]||i.type),i}transferMouseData(i,t){i.isTrusted=t.isTrusted,i.srcElement=t.srcElement,i.timeStamp=performance.now(),i.type=t.type,i.altKey=t.altKey,i.button=t.button,i.buttons=t.buttons,i.client.x=t.clientX,i.client.y=t.clientY,i.ctrlKey=t.ctrlKey,i.metaKey=t.metaKey,i.movement.x=t.movementX,i.movement.y=t.movementY,i.page.x=t.pageX,i.page.y=t.pageY,i.relatedTarget=null,i.shiftKey=t.shiftKey}};let Us=vo;Us.extension={name:"events",type:[k.RendererSystem,k.CanvasRendererSystem]};Us.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};D.add(Us);class kr{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?j.EMPTY:(t=t||new j(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:s,b:r,c:n,d:o,tx:a,ty:h}=t,l=s*e.x+n*e.y+a,c=r*e.x+o*e.y+h;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let e=this.minX,s=this.minY,r=this.maxX,n=this.maxY,o=t[0],a=t[1];e=o<e?o:e,s=a<s?a:s,r=o>r?o:r,n=a>n?a:n,o=t[2],a=t[3],e=o<e?o:e,s=a<s?a:s,r=o>r?o:r,n=a>n?a:n,o=t[4],a=t[5],e=o<e?o:e,s=a<s?a:s,r=o>r?o:r,n=a>n?a:n,o=t[6],a=t[7],e=o<e?o:e,s=a<s?a:s,r=o>r?o:r,n=a>n?a:n,this.minX=e,this.minY=s,this.maxX=r,this.maxY=n}addFrame(t,e,s,r,n){this.addFrameMatrix(t.worldTransform,e,s,r,n)}addFrameMatrix(t,e,s,r,n){const o=t.a,a=t.b,h=t.c,l=t.d,c=t.tx,d=t.ty;let u=this.minX,p=this.minY,f=this.maxX,g=this.maxY,m=o*e+h*s+c,x=a*e+l*s+d;u=m<u?m:u,p=x<p?x:p,f=m>f?m:f,g=x>g?x:g,m=o*r+h*s+c,x=a*r+l*s+d,u=m<u?m:u,p=x<p?x:p,f=m>f?m:f,g=x>g?x:g,m=o*e+h*n+c,x=a*e+l*n+d,u=m<u?m:u,p=x<p?x:p,f=m>f?m:f,g=x>g?x:g,m=o*r+h*n+c,x=a*r+l*n+d,u=m<u?m:u,p=x<p?x:p,f=m>f?m:f,g=x>g?x:g,this.minX=u,this.minY=p,this.maxX=f,this.maxY=g}addVertexData(t,e,s){let r=this.minX,n=this.minY,o=this.maxX,a=this.maxY;for(let h=e;h<s;h+=2){const l=t[h],c=t[h+1];r=l<r?l:r,n=c<n?c:n,o=l>o?l:o,a=c>a?c:a}this.minX=r,this.minY=n,this.maxX=o,this.maxY=a}addVertices(t,e,s,r){this.addVerticesMatrix(t.worldTransform,e,s,r)}addVerticesMatrix(t,e,s,r,n=0,o=n){const a=t.a,h=t.b,l=t.c,c=t.d,d=t.tx,u=t.ty;let p=this.minX,f=this.minY,g=this.maxX,m=this.maxY;for(let x=s;x<r;x+=2){const y=e[x],_=e[x+1],v=a*y+l*_+d,w=c*_+h*y+u;p=Math.min(p,v-n),g=Math.max(g,v+n),f=Math.min(f,w-o),m=Math.max(m,w+o)}this.minX=p,this.minY=f,this.maxX=g,this.maxY=m}addBounds(t){const e=this.minX,s=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<s?t.minY:s,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,e){const s=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(s<=n&&r<=o){const a=this.minX,h=this.minY,l=this.maxX,c=this.maxY;this.minX=s<a?s:a,this.minY=r<h?r:h,this.maxX=n>l?n:l,this.maxY=o>c?o:c}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const s=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(s<=n&&r<=o){const a=this.minX,h=this.minY,l=this.maxX,c=this.maxY;this.minX=s<a?s:a,this.minY=r<h?r:h,this.maxX=n>l?n:l,this.maxY=o>c?o:c}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,s,r,n,o){t-=n,e-=o,s+=n,r+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>s?this.maxX:s,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r}}class Ii extends Ai{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new qo,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new kr,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let s=0;s<e.length;++s){const r=e[s];Object.defineProperty(Ii.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new j),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new j),t=this._localBoundsRect),this._localBounds||(this._localBounds=new kr);const e=this.transform,s=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=s,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-n,o}toGlobal(t,e,s=!1){return s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,s,r){return e&&(t=e.toGlobal(t,s,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,s)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,s=1,r=1,n=0,o=0,a=0,h=0,l=0){return this.position.x=t,this.position.y=e,this.scale.x=s||1,this.scale.y=r||1,this.rotation=n,this.skew.x=o,this.skew.y=a,this.pivot.x=h,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Tf),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*fd}set angle(t){this.transform.rotation=t*pd}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class Tf extends Ii{constructor(){super(...arguments),this.sortDirty=null}}Ii.prototype.displayObjectUpdateTransform=Ii.prototype.updateTransform;const Sf=new Et;function Ef(i,t){return i.zIndex===t.zIndex?i._lastSortedIndex-t._lastSortedIndex:i.zIndex-t.zIndex}const bo=class extends Ii{constructor(){super(),this.children=[],this.sortableChildren=bo.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(i){}addChild(...i){if(i.length>1)for(let t=0;t<i.length;t++)this.addChild(i[t]);else{const t=i[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return i[0]}addChildAt(i,t){if(t<0||t>this.children.length)throw new Error(`${i}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.splice(t,0,i),this._boundsID++,this.onChildrenChange(t),i.emit("added",this),this.emit("childAdded",i,this,t),i}swapChildren(i,t){if(i===t)return;const e=this.getChildIndex(i),s=this.getChildIndex(t);this.children[e]=t,this.children[s]=i,this.onChildrenChange(e<s?e:s)}getChildIndex(i){const t=this.children.indexOf(i);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(i,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const e=this.getChildIndex(i);mr(this.children,e,1),this.children.splice(t,0,i),this.onChildrenChange(t)}getChildAt(i){if(i<0||i>=this.children.length)throw new Error(`getChildAt: Index (${i}) does not exist.`);return this.children[i]}removeChild(...i){if(i.length>1)for(let t=0;t<i.length;t++)this.removeChild(i[t]);else{const t=i[0],e=this.children.indexOf(t);if(e===-1)return null;t.parent=null,t.transform._parentID=-1,mr(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e)}return i[0]}removeChildAt(i){const t=this.getChildAt(i);return t.parent=null,t.transform._parentID=-1,mr(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i),t}removeChildren(i=0,t=this.children.length){const e=i,s=t,r=s-e;let n;if(r>0&&r<=s){n=this.children.splice(e,r);for(let o=0;o<n.length;++o)n[o].parent=null,n[o].transform&&(n[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(i);for(let o=0;o<n.length;++o)n[o].emit("removed",this),this.emit("childRemoved",n[o],this,o);return n}else if(r===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let i=!1;for(let t=0,e=this.children.length;t<e;++t){const s=this.children[t];s._lastSortedIndex=t,!i&&s.zIndex!==0&&(i=!0)}i&&this.children.length>1&&this.children.sort(Ef),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let i=0,t=this.children.length;i<t;++i){const e=this.children[i];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let i=0;i<this.children.length;i++){const t=this.children[i];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(i,t=!1){const e=super.getLocalBounds(i);if(!t)for(let s=0,r=this.children.length;s<r;++s){const n=this.children[s];n.visible&&n.updateTransform()}return e}_calculateBounds(){}_renderWithCulling(i){const t=i.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let e,s;this.cullArea?(e=this.cullArea,s=this.worldTransform):this._render!==bo.prototype._render&&(e=this.getBounds(!0));const r=i.projection.transform;if(r&&(s?(s=Sf.copyFrom(s),s.prepend(r)):s=r),e&&t.intersects(e,s))this._render(i);else if(this.cullArea)return;for(let n=0,o=this.children.length;n<o;++n){const a=this.children[n],h=a.cullable;a.cullable=h||!this.cullArea,a.render(i),a.cullable=h}}render(i){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(i);else if(this.cullable)this._renderWithCulling(i);else{this._render(i);for(let e=0,s=this.children.length;e<s;++e)this.children[e].render(i)}}renderAdvanced(i){var r,n,o;const t=this.filters,e=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let a=0;a<t.length;a++)t[a].enabled&&this._enabledFilters.push(t[a])}const s=t&&((r=this._enabledFilters)==null?void 0:r.length)||e&&(!e.isMaskData||e.enabled&&(e.autoDetect||e.type!==wt.NONE));if(s&&i.batch.flush(),t&&((n=this._enabledFilters)!=null&&n.length)&&i.filter.push(this,this._enabledFilters),e&&i.mask.push(this,this._mask),this.cullable)this._renderWithCulling(i);else{this._render(i);for(let a=0,h=this.children.length;a<h;++a)this.children[a].render(i)}s&&i.batch.flush(),e&&i.mask.pop(this),t&&((o=this._enabledFilters)!=null&&o.length)&&i.filter.pop()}_render(i){}destroy(i){super.destroy(),this.sortDirty=!1;const t=typeof i=="boolean"?i:i==null?void 0:i.children,e=this.removeChildren(0,this.children.length);if(t)for(let s=0;s<e.length;++s)e[s].destroy(i)}get width(){return this.scale.x*this.getLocalBounds().width}set width(i){const t=this.getLocalBounds().width;t!==0?this.scale.x=i/t:this.scale.x=1,this._width=i}get height(){return this.scale.y*this.getLocalBounds().height}set height(i){const t=this.getLocalBounds().height;t!==0?this.scale.y=i/t:this.scale.y=1,this._height=i}};let et=bo;et.defaultSortableChildren=!1;et.prototype.containerUpdateTransform=et.prototype.updateTransform;Object.defineProperties(O,{SORTABLE_CHILDREN:{get(){return et.defaultSortableChildren},set(i){$("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),et.defaultSortableChildren=i}}});function lh(i){return i==="dynamic"||i==="static"}const Af={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??lh(Us.defaultEventMode)},set interactive(i){$("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=i,this.eventMode=i?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Us.defaultEventMode},set eventMode(i){this._internalInteractive=lh(i),this._internalEventMode=i},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(i,t,e){const s=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof t=="function"?void 0:t;i=s?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.on(i,t,r)},removeEventListener(i,t,e){const s=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof t=="function"?void 0:t;i=s?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.off(i,t,r)},dispatchEvent(i){if(!(i instanceof Qr))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return i.defaultPrevented=!1,i.path=null,i.target=this,i.manager.dispatchEvent(i),!i.defaultPrevented}};Ii.mixin(Af);const wo=class{constructor(i){this.stage=new et,i=Object.assign({forceCanvas:!1},i),this.renderer=ff(i),wo._plugins.forEach(t=>{t.init.call(this,i)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(i,t){const e=wo._plugins.slice(0);e.reverse(),e.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(i),this.renderer=null}};let Zo=wo;Zo._plugins=[];D.handleByList(k.Application,Zo._plugins);class Ol{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,s;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,s=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:n}=this._resizeTo;e=r,s=n}this.renderer.resize(e,s),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Ol.extension=k.Application;D.add(Ol);const ch={loader:k.LoadParser,resolver:k.ResolveParser,cache:k.CacheParser,detection:k.DetectionParser};D.handle(k.Asset,i=>{const t=i.ref;Object.entries(ch).filter(([e])=>!!t[e]).forEach(([e,s])=>D.add(Object.assign(t[e],{extension:t[e].extension??s})))},i=>{const t=i.ref;Object.keys(ch).filter(e=>!!t[e]).forEach(e=>D.remove(t[e]))});class Cf{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<e;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function qs(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function Ks(i,t){const e=i.split("?")[0],s=ei.extname(e).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const ze=(i,t)=>(Array.isArray(i)||(i=[i]),t?i.map(e=>typeof e=="string"?t(e):e):i);function Fl(i,t,e,s,r){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?Fl(i.replace(s[e],a),t,e+1,s,r):r.push(i.replace(s[e],a))}}function If(i){const t=/\{(.*?)\}/g,e=i.match(t),s=[];if(e){const r=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),Fl(i,r,0,e,s)}else s.push(i);return s}const Br=i=>!Array.isArray(i);class Rf{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const s=ze(t);let r;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(e)){r=h.getCacheableAssets(s,e);break}}r||(r={},s.forEach(a=>{r[a]=e}));const n=Object.keys(r),o={cacheKeys:n,keys:s};if(s.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])}),e instanceof U){const a=e;s.forEach(h=>{a.baseTexture!==U.EMPTY.baseTexture&&W.addToCache(a.baseTexture,h),U.addToCache(a,h)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const ms=new Rf;class Pf{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,s)=>(this._parsersValidated=!1,t[e]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const s={promise:null,parser:null};return s.promise=(async()=>{var o,a;let r=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.load&&((o=l.test)!=null&&o.call(l,t,e,this))){n=l;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await n.load(t,e,this),s.parser=n;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];l.parse&&l.parse&&await((a=l.testParse)==null?void 0:a.call(l,r,e,this))&&(r=await l.parse(r,e,this)||r,s.parser=l)}return r})(),s}async load(t,e){this._parsersValidated||this._validateParsers();let s=0;const r={},n=Br(t),o=ze(t,l=>({src:l})),a=o.length,h=o.map(async l=>{const c=ei.toAbsolute(l.src);if(!r[l.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,l)),r[l.src]=await this.promiseCache[c].promise,e&&e(++s/a)}catch(d){throw delete this.promiseCache[c],delete r[l.src],new Error(`[Loader.load] Failed to load ${c}.
${d}`)}});return await Promise.all(h),n?r[o[0].src]:r}async unload(t){const s=ze(t,r=>({src:r})).map(async r=>{var a,h;const n=ei.toAbsolute(r.src),o=this.promiseCache[n];if(o){const l=await o.promise;(h=(a=o.parser)==null?void 0:a.unload)==null||h.call(a,l,r,this),delete this.promiseCache[n]}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}}var cs=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(cs||{});const Mf=".json",kf="application/json",Bf={extension:{type:k.LoadParser,priority:cs.Low},name:"loadJson",test(i){return qs(i,kf)||Ks(i,Mf)},async load(i){return await(await O.ADAPTER.fetch(i)).json()}};D.add(Bf);const Lf=".txt",Of="text/plain",Ff={name:"loadTxt",extension:{type:k.LoadParser,priority:cs.Low},test(i){return qs(i,Of)||Ks(i,Lf)},async load(i){return await(await O.ADAPTER.fetch(i)).text()}};D.add(Ff);const Nf=["normal","bold","100","200","300","400","500","600","700","800","900"],Df=[".ttf",".otf",".woff",".woff2"],Uf=["font/ttf","font/otf","font/woff","font/woff2"];function Gf(i){const t=ei.extname(i);return ei.basename(i,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}const Vf={extension:{type:k.LoadParser,priority:cs.Low},name:"loadWebFont",test(i){return qs(i,Uf)||Ks(i,Df)},async load(i,t){var s,r,n;const e=O.ADAPTER.getFontFaceSet();if(e){const o=[],a=((s=t.data)==null?void 0:s.family)??Gf(i),h=((n=(r=t.data)==null?void 0:r.weights)==null?void 0:n.filter(c=>Nf.includes(c)))??["normal"],l=t.data??{};for(let c=0;c<h.length;c++){const d=h[c],u=new FontFace(a,`url(${encodeURI(i)})`,{...l,weight:d});await u.load(),e.add(u),o.push(u)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){(Array.isArray(i)?i:[i]).forEach(t=>O.ADAPTER.getFontFaceSet().delete(t))}};D.add(Vf);let uh=0,Nn;const zf="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",Hf={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${zf}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},Wf={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Dn;class Xf{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([Hf.code],{type:"application/javascript"})),s=new Worker(e);s.addEventListener("message",r=>{s.terminate(),URL.revokeObjectURL(e),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Nn===void 0&&(Nn=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Nn&&(Dn||(Dn=URL.createObjectURL(new Blob([Wf.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Dn),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const s=new Promise((r,n)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:n})});return this.next(),s}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),s=e.id;this.resolveHash[uh]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:uh++,id:s})}}const dh=new Xf;function Nl(i,t,e){const s=new U(i);return s.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),s}const $f=[".jpeg",".jpg",".png",".webp",".avif"],jf=["image/jpeg","image/png","image/webp","image/avif"];async function Yf(i){const t=await O.ADAPTER.fetch(i);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const tn={name:"loadTextures",extension:{type:k.LoadParser,priority:cs.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(i){return qs(i,jf)||Ks(i,$f)},async load(i,t,e){let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await dh.isImageBitmapSupported()?s=await dh.loadImageBitmap(i):s=await Yf(i):s=await new Promise(n=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=i,s.complete?n(s):s.onload=()=>{n(s)}});const r=new W(s,{resolution:Ir(i),...t.data});return r.resource.src=i,Nl(r,e,i)},unload(i){i.destroy(!0)}};D.add(tn);const qf=".svg",Kf="image/svg+xml",Zf={extension:{type:k.LoadParser,priority:cs.High},name:"loadSVG",test(i){return qs(i,Kf)||Ks(i,qf)},async testParse(i){return Ds.test(i)},async parse(i,t,e){var o,a,h;const s=new Ds(i,(o=t==null?void 0:t.data)==null?void 0:o.resourceOptions),r=new W(s,{resolution:Ir(i),...t==null?void 0:t.data});r.resource.src=i;const n=Nl(r,e,i);return(h=(a=t==null?void 0:t.data)==null?void 0:a.resourceOptions)!=null&&h.autoLoad||await s.load(),n},async load(i,t){return(await O.ADAPTER.fetch(i)).text()},unload:tn.unload};D.add(Zf);class Jf{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const s=[];Array.isArray(e)?e.forEach(r=>{if(typeof r.name=="string"){const n=this._createBundleAssetId(t,r.name);s.push(n),this.add([r.name,n],r.srcs,r.data)}else{const n=r.name.map(o=>this._createBundleAssetId(t,o));n.forEach(o=>{s.push(o)}),this.add([...r.name,...n],r.srcs)}}):Object.keys(e).forEach(r=>{s.push(this._createBundleAssetId(t,r)),this.add([r,this._createBundleAssetId(t,r)],e[r])}),this._bundles[t]=s}add(t,e,s){const r=ze(t);r.forEach(o=>{this.hasKey(o)&&console.warn(`[Resolver] already has key: ${o} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=If(e):e=[e]);const n=e.map(o=>{let a=o;if(typeof o=="string"){let h=!1;for(let l=0;l<this._parsers.length;l++){const c=this._parsers[l];if(c.test(o)){a=c.parse(o),h=!0;break}}h||(a={src:o})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=r),(this._basePath||this._rootPath)&&(a.src=ei.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=a.data??s,a});r.forEach(o=>{this._assetMap[o]=n})}resolveBundle(t){const e=Br(t);t=ze(t);const s={};return t.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const h in o){const l=o[h];a[this._extractAssetIdFromBundle(r,h)]=l}s[r]=a}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const s={};for(const r in e)s[r]=e[r].src;return s}return e.src}resolve(t){const e=Br(t);t=ze(t);const s={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=this._getPreferredOrder(n),a=n[0];o==null||o.priority.forEach(h=>{o.params[h].forEach(l=>{const c=n.filter(d=>d[h]?d[h]===l:!1);c.length&&(n=c)})}),this._resolverHash[r]=n[0]??a}else{let n=r;(this._basePath||this._rootPath)&&(n=ei.toAbsolute(n,this._basePath,this._rootPath)),n=this._appendDefaultSearchParams(n),this._resolverHash[r]={src:n}}s[r]=this._resolverHash[r]}),e?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[0],r=this._preferredOrder.find(n=>n.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}}class Qf{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Jf,this.loader=new Pf,this.cache=ms,this._backgroundLoader=new Cf(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let h=t.manifest;typeof h=="string"&&(h=await this.load(h)),this.resolver.addManifest(h)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,s=typeof e=="number"?[e]:e;let r=[];if((o=t.texturePreference)!=null&&o.format){const h=(a=t.texturePreference)==null?void 0:a.format;r=typeof h=="string"?[h]:h;for(const l of this._detections)await l.test()||(r=await l.remove(r))}else for(const h of this._detections)await h.test()&&(r=await h.add(r));this.resolver.prefer({params:{format:r,resolution:s}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,s){this.resolver.add(t,e,s)}async load(t,e){this._initialized||await this.init();const s=Br(t),r=ze(t).map(a=>typeof a!="string"?(this.resolver.add(a.src,a),a.src):(this.resolver.hasKey(a)||this.resolver.add(a,a),a)),n=this.resolver.resolve(r),o=await this._mapLoadToResolve(n,e);return s?o[r[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let s=!1;typeof t=="string"&&(s=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},o=Object.keys(r);let a=0,h=0;const l=()=>{e==null||e(++a/h)},c=o.map(d=>{const u=r[d];return h+=Object.keys(u).length,this._mapLoadToResolve(u,l).then(p=>{n[d]=p})});return await Promise.all(c),s?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return ms.get(t);const e={};for(let s=0;s<t.length;s++)e[s]=ms.get(t[s]);return e}async _mapLoadToResolve(t,e){const s=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(s,e);this._backgroundLoader.active=!0;const o={};return s.forEach((a,h)=>{const l=n[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[r[h]]=l,ms.set(c,l)}),o}async unload(t){this._initialized||await this.init();const e=ze(t).map(r=>typeof r!="string"?r.src:r),s=this.resolver.resolve(e);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=ze(t);const e=this.resolver.resolveBundle(t),s=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(s)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(s=>{ms.remove(s.src)}),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return tn.config.preferWorkers}set preferWorkers(t){$("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(s=>s in t).forEach(s=>{e.config[s]=t[s]})})}}const Ge=new Qf;D.handleByList(k.LoadParser,Ge.loader.parsers).handleByList(k.ResolveParser,Ge.resolver.parsers).handleByList(k.CacheParser,Ge.cache.parsers).handleByList(k.DetectionParser,Ge.detections);const tp={extension:k.CacheParser,test:i=>Array.isArray(i)&&i.every(t=>t instanceof U),getCacheableAssets:(i,t)=>{const e={};return i.forEach(s=>{t.forEach((r,n)=>{e[s+(n===0?"":n+1)]=r})}),e}};D.add(tp);const ep={extension:{type:k.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await O.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")};D.add(ep);const ip={extension:{type:k.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await O.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")};D.add(ip);const fh=["png","jpg","jpeg"],sp={extension:{type:k.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...fh],remove:async i=>i.filter(t=>!fh.includes(t))};D.add(sp);const rp={extension:k.ResolveParser,test:tn.test,parse:i=>{var t;return{resolution:parseFloat(((t=O.RETINA_PREFIX.exec(i))==null?void 0:t[1])??"1"),format:i.split(".").pop(),src:i}}};D.add(rp);const To={bundles:[{name:"preload",assets:[{name:"spinner",srcs:"images/spinner.png"},{name:"pixi-logo",srcs:"images/pixi-logo.png"}]},{name:"game",assets:[{name:"avatar-05",srcs:"images/avatar-05.png"},{name:"avatar_mask",srcs:"images/avatar_mask.png"},{name:"Levels",srcs:"images/Examples/Levels.png"},{name:"bg",srcs:"images/Examples/BG.png"},{name:"SmallButton-disabled",srcs:"images/Buttons/SmallButton-disabled.png"},{name:"SmallButton-hover",srcs:"images/Buttons/SmallButton-hover.png"},{name:"SmallButton",srcs:"images/Buttons/SmallButton.png"},{name:"Button-pressed",srcs:"images/Buttons/Button-pressed.png"},{name:"SmallButton-pressed",srcs:"images/Buttons/SmallButton-pressed.png"},{name:"SmallButton-substrate",srcs:"images/Window/SmallButton-substrate.png"},{name:"Button-hover",srcs:"images/Buttons/Button-hover.png"},{name:"Button-disabled",srcs:"images/Buttons/Button-disabled.png"},{name:"Button",srcs:"images/Buttons/Button.png"},{name:"SliderIcon",srcs:"images/Icons/SliderIcon.png"},{name:"VertSliderBG",srcs:"images/Progress/VertSliderBG.png"},{name:"SliderBG",srcs:"images/Progress/SliderBG.png"},{name:"SmallProgress-silver",srcs:"images/Progress/SmallProgress-silver.png"},{name:"ValueBG",srcs:"images/Progress/ValueBG.png"},{name:"SmallProgress-blue",srcs:"images/Progress/SmallProgress-blue.png"},{name:"SmallProgress-pink",srcs:"images/Progress/SmallProgress-pink.png"},{name:"ProgressBlock",srcs:"images/Progress/ProgressBlock.png"},{name:"ValueBGIcon",srcs:"images/Progress/ValueBGIcon.png"},{name:"SmallProgressBarBG",srcs:"images/Progress/SmallProgressBarBG.png"},{name:"ProgressBlock-fill",srcs:"images/Progress/ProgressBlock-fill.png"},{name:"SwitchBG",srcs:"images/Window/SwitchBG.png"},{name:"SmallSubstrate",srcs:"images/Window/SmallSubstrate.png"},{name:"Radio",srcs:"images/Window/Radio.png"},{name:"Radio-hover",srcs:"images/Window/Radio-hover.png"},{name:"Radio-bg",srcs:"images/Window/Radio-bg.png"},{name:"RoundSubstrate",srcs:"images/Window/RoundSubstrate.png"},{name:"MediumSubstrate",srcs:"images/Window/MediumSubstrate.png"},{name:"Substrate",srcs:"images/Window/Substrate.png"},{name:"CheckBox-hover",srcs:"images/Window/CheckBox-hover.png"},{name:"MenuWindow",srcs:"images/Window/MenuWindow.png"},{name:"Ribbon",srcs:"images/Window/Ribbon.png"},{name:"Hint",srcs:"images/Window/Hint.png"},{name:"HintDown",srcs:"images/Window/Hint-down.png"},{name:"MediumWindow",srcs:"images/Window/MediumWindow.png"},{name:"Window",srcs:"images/Window/Window.png"},{name:"SmallWindow",srcs:"images/Window/SmallWindow.png"},{name:"ValueSubstrate",srcs:"images/Window/ValueSubstrate.png"},{name:"CheckBox",srcs:"images/Window/CheckBox.png"},{name:"ArrowIcon",srcs:"images/Icons/ArrowIcon.png"},{name:"ChestIcon",srcs:"images/Icons/ChestIcon.png"},{name:"HomeIcon",srcs:"images/Icons/HomeIcon.png"},{name:"MenuIcon",srcs:"images/Icons/MenuIcon.png"},{name:"PlusIcon",srcs:"images/Icons/PlusIcon.png"},{name:"CloseIcon",srcs:"images/Icons/CloseIcon.png"},{name:"HillIcon",srcs:"images/Icons/HillIcon.png"},{name:"DethIcon",srcs:"images/Icons/DethIcon.png"},{name:"TimeIcon",srcs:"images/Icons/TimeIcon.png"},{name:"DeleteIcon",srcs:"images/Icons/DeleteIcon.png"},{name:"PlayIcon",srcs:"images/Icons/PlayIcon.png"},{name:"MinusIcon",srcs:"images/Icons/MinusIcon.png"},{name:"PauseIcon",srcs:"images/Icons/PauseIcon.png"},{name:"GemIcon",srcs:"images/Icons/gemIcon.png"},{name:"LockIcon",srcs:"images/Icons/LockIcon.png"},{name:"InfoIcon",srcs:"images/Icons/InfoIcon.png"},{name:"EnergyIcon",srcs:"images/Icons/EnergyIcon.png"},{name:"SettingsIcon",srcs:"images/Icons/SettingsIcon.png"},{name:"Star",srcs:"images/Icons/Star.png"},{name:"HardIcon",srcs:"images/Icons/HardIcon.png"},{name:"StarIcon",srcs:"images/Icons/StarIcon.png"},{name:"MeatIcon",srcs:"images/Icons/MeatIcon.png"},{name:"DollarIcon",srcs:"images/Icons/DollarIcon.png"},{name:"clouds",srcs:"images/BG/clouds.png"},{name:"mountain2",srcs:"images/BG/mountain2.png"},{name:"mountain1",srcs:"images/BG/mountain1.png"},{name:"sky2",srcs:"images/BG/sky2.png"},{name:"sky1",srcs:"images/BG/sky1.png"},{name:"front",srcs:"images/BG/front.png"},{name:"input",srcs:"images/input.png"},{name:"spinner",srcs:"images/spinner.png"},{name:"arrow_down",srcs:"images/arrow_down.png"}]}]};async function np(){await Ge.init({manifest:To}),await Ge.loadBundle("preload");const i=To.bundles.map(t=>t.name);Ge.backgroundLoadBundle(i)}function op(i){const t=To.bundles.find(e=>e.name===i);if(!t)return!1;for(const e of t.assets)if(!Ge.cache.has(e.name))return!1;return!0}function ap(i){for(const t of i)if(!op(t))return!1;return!0}const _s=new tt,hp=new Uint16Array([0,1,2,0,2,3]);class H extends et{constructor(t){super(),this._anchor=new Ye(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new St(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=N.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||U.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=hp,this.pluginName="batch",this.isSprite=!0,this._roundPixels=O.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Ui(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Ui(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,s=e.a,r=e.b,n=e.c,o=e.d,a=e.tx,h=e.ty,l=this.vertexData,c=t.trim,d=t.orig,u=this._anchor;let p=0,f=0,g=0,m=0;if(c?(f=c.x-u._x*d.width,p=f+c.width,m=c.y-u._y*d.height,g=m+c.height):(f=-u._x*d.width,p=f+d.width,m=-u._y*d.height,g=m+d.height),l[0]=s*f+n*m+a,l[1]=o*m+r*f+h,l[2]=s*p+n*m+a,l[3]=o*m+r*p+h,l[4]=s*p+n*g+a,l[5]=o*g+r*p+h,l[6]=s*f+n*g+a,l[7]=o*g+r*f+h,this._roundPixels){const x=O.RESOLUTION;for(let y=0;y<l.length;++y)l[y]=Math.round(l[y]*x)/x}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,s=t.orig,r=this._anchor,n=this.transform.worldTransform,o=n.a,a=n.b,h=n.c,l=n.d,c=n.tx,d=n.ty,u=-r._x*s.width,p=u+s.width,f=-r._y*s.height,g=f+s.height;e[0]=o*u+h*f+c,e[1]=l*f+a*u+d,e[2]=o*p+h*f+c,e[3]=l*f+a*p+d,e[4]=o*p+h*g+c,e[5]=l*g+a*p+d,e[6]=o*u+h*g+c,e[7]=l*g+a*u+d}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new kr),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new j),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,_s);const e=this._texture.orig.width,s=this._texture.orig.height,r=-e*this.anchor.x;let n=0;return _s.x>=r&&_s.x<r+e&&(n=-s*this.anchor.y,_s.y>=n&&_s.y<n+s)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!s)}this._texture=null}static from(t,e){const s=t instanceof U?t:U.from(t,e);return new H(s)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=Ui(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=Ui(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||U.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const Lr={build(i){const t=i.points;let e,s,r,n,o,a;if(i.type===kt.CIRC){const f=i.shape;e=f.x,s=f.y,o=a=f.radius,r=n=0}else if(i.type===kt.ELIP){const f=i.shape;e=f.x,s=f.y,o=f.width,a=f.height,r=n=0}else{const f=i.shape,g=f.width/2,m=f.height/2;e=f.x+g,s=f.y+m,o=a=Math.max(0,Math.min(f.radius,Math.min(g,m))),r=g-o,n=m-a}if(!(o>=0&&a>=0&&r>=0&&n>=0)){t.length=0;return}const h=Math.ceil(2.3*Math.sqrt(o+a)),l=h*8+(r?4:0)+(n?4:0);if(t.length=l,l===0)return;if(h===0){t.length=8,t[0]=t[6]=e+r,t[1]=t[3]=s+n,t[2]=t[4]=e-r,t[5]=t[7]=s-n;return}let c=0,d=h*4+(r?2:0)+2,u=d,p=l;{const f=r+o,g=n,m=e+f,x=e-f,y=s+g;if(t[c++]=m,t[c++]=y,t[--d]=y,t[--d]=x,n){const _=s-g;t[u++]=x,t[u++]=_,t[--p]=_,t[--p]=m}}for(let f=1;f<h;f++){const g=Math.PI/2*(f/h),m=r+Math.cos(g)*o,x=n+Math.sin(g)*a,y=e+m,_=e-m,v=s+x,w=s-x;t[c++]=y,t[c++]=v,t[--d]=v,t[--d]=_,t[u++]=_,t[u++]=w,t[--p]=w,t[--p]=y}{const f=r,g=n+a,m=e+f,x=e-f,y=s+g,_=s-g;t[c++]=m,t[c++]=y,t[--p]=_,t[--p]=m,r&&(t[c++]=x,t[c++]=y,t[--p]=_,t[--p]=x)}},triangulate(i,t){const e=i.points,s=t.points,r=t.indices;if(e.length===0)return;let n=s.length/2;const o=n;let a,h;if(i.type!==kt.RREC){const c=i.shape;a=c.x,h=c.y}else{const c=i.shape;a=c.x+c.width/2,h=c.y+c.height/2}const l=i.matrix;s.push(i.matrix?l.a*a+l.c*h+l.tx:a,i.matrix?l.b*a+l.d*h+l.ty:h),n++,s.push(e[0],e[1]);for(let c=2;c<e.length;c+=2)s.push(e[c],e[c+1]),r.push(n++,o,n);r.push(o+1,o,n)}};function ph(i,t=!1){const e=i.length;if(e<6)return;let s=0;for(let r=0,n=i[e-2],o=i[e-1];r<e;r+=2){const a=i[r],h=i[r+1];s+=(a-n)*(h+o),n=a,o=h}if(!t&&s>0||t&&s<=0){const r=e/2;for(let n=r+r%2;n<e;n+=2){const o=e-n-2,a=e-n-1,h=n,l=n+1;[i[o],i[h]]=[i[h],i[o]],[i[a],i[l]]=[i[l],i[a]]}}}const Dl={build(i){i.points=i.shape.points.slice()},triangulate(i,t){let e=i.points;const s=i.holes,r=t.points,n=t.indices;if(e.length>=6){ph(e,!1);const o=[];for(let l=0;l<s.length;l++){const c=s[l];ph(c.points,!0),o.push(e.length/2),e=e.concat(c.points)}const a=Er(e,o,2);if(!a)return;const h=r.length/2;for(let l=0;l<a.length;l+=3)n.push(a[l]+h),n.push(a[l+1]+h),n.push(a[l+2]+h);for(let l=0;l<e.length;l++)r.push(e[l])}}},lp={build(i){const t=i.shape,e=t.x,s=t.y,r=t.width,n=t.height,o=i.points;o.length=0,r>=0&&n>=0&&o.push(e,s,e+r,s,e+r,s+n,e,s+n)},triangulate(i,t){const e=i.points,s=t.points;if(e.length===0)return;const r=s.length/2;s.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},cp={build(i){Lr.build(i)},triangulate(i,t){Lr.triangulate(i,t)}};var fe=(i=>(i.MITER="miter",i.BEVEL="bevel",i.ROUND="round",i))(fe||{}),vi=(i=>(i.BUTT="butt",i.ROUND="round",i.SQUARE="square",i))(vi||{});const ts={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(i,t=20){if(!this.adaptive||!i||isNaN(i))return t;let e=Math.ceil(i/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class gh{static curveTo(t,e,s,r,n,o){const a=o[o.length-2],l=o[o.length-1]-e,c=a-t,d=r-e,u=s-t,p=Math.abs(l*u-c*d);if(p<1e-8||n===0)return(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e),null;const f=l*l+c*c,g=d*d+u*u,m=l*d+c*u,x=n*Math.sqrt(f)/p,y=n*Math.sqrt(g)/p,_=x*m/f,v=y*m/g,w=x*u+y*c,E=x*d+y*l,T=c*(y+_),b=l*(y+_),S=u*(x+v),A=d*(x+v),L=Math.atan2(b-E,T-w),Y=Math.atan2(A-E,S-w);return{cx:w+t,cy:E+e,radius:n,startAngle:L,endAngle:Y,anticlockwise:c*d>u*l}}static arc(t,e,s,r,n,o,a,h,l){const c=a-o,d=ts._segmentsCount(Math.abs(c)*n,Math.ceil(Math.abs(c)/Pr)*40),u=c/(d*2),p=u*2,f=Math.cos(u),g=Math.sin(u),m=d-1,x=m%1/m;for(let y=0;y<=m;++y){const _=y+x*y,v=u+o+p*_,w=Math.cos(v),E=-Math.sin(v);l.push((f*w+g*E)*n+s,(f*-E+g*w)*n+r)}}}class up{constructor(){this.reset()}begin(t,e,s){this.reset(),this.style=t,this.start=e,this.attribStart=s}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Jo{static curveLength(t,e,s,r,n,o,a,h){let c=0,d=0,u=0,p=0,f=0,g=0,m=0,x=0,y=0,_=0,v=0,w=t,E=e;for(let T=1;T<=10;++T)d=T/10,u=d*d,p=u*d,f=1-d,g=f*f,m=g*f,x=m*t+3*g*d*s+3*f*u*n+p*a,y=m*e+3*g*d*r+3*f*u*o+p*h,_=w-x,v=E-y,w=x,E=y,c+=Math.sqrt(_*_+v*v);return c}static curveTo(t,e,s,r,n,o,a){const h=a[a.length-2],l=a[a.length-1];a.length-=2;const c=ts._segmentsCount(Jo.curveLength(h,l,t,e,s,r,n,o));let d=0,u=0,p=0,f=0,g=0;a.push(h,l);for(let m=1,x=0;m<=c;++m)x=m/c,d=1-x,u=d*d,p=u*d,f=x*x,g=f*x,a.push(p*h+3*u*x*t+3*d*f*s+g*n,p*l+3*u*x*e+3*d*f*r+g*o)}}function mh(i,t,e,s,r,n,o,a){const h=i-e*r,l=t-s*r,c=i+e*n,d=t+s*n;let u,p;o?(u=s,p=-e):(u=-s,p=e);const f=h+u,g=l+p,m=c+u,x=d+p;return a.push(f,g,m,x),2}function li(i,t,e,s,r,n,o,a){const h=e-i,l=s-t;let c=Math.atan2(h,l),d=Math.atan2(r-i,n-t);a&&c<d?c+=Math.PI*2:!a&&c>d&&(d+=Math.PI*2);let u=c;const p=d-c,f=Math.abs(p),g=Math.sqrt(h*h+l*l),m=(15*f*Math.sqrt(g)/Math.PI>>0)+1,x=p/m;if(u+=x,a){o.push(i,t,e,s);for(let y=1,_=u;y<m;y++,_+=x)o.push(i,t,i+Math.sin(_)*g,t+Math.cos(_)*g);o.push(i,t,r,n)}else{o.push(e,s,i,t);for(let y=1,_=u;y<m;y++,_+=x)o.push(i+Math.sin(_)*g,t+Math.cos(_)*g,i,t);o.push(r,n,i,t)}return m*2}function dp(i,t){const e=i.shape;let s=i.points||e.points.slice();const r=t.closePointEps;if(s.length===0)return;const n=i.lineStyle,o=new tt(s[0],s[1]),a=new tt(s[s.length-2],s[s.length-1]),h=e.type!==kt.POLY||e.closeStroke,l=Math.abs(o.x-a.x)<r&&Math.abs(o.y-a.y)<r;if(h){s=s.slice(),l&&(s.pop(),s.pop(),a.set(s[s.length-2],s[s.length-1]));const F=(o.x+a.x)*.5,rt=(a.y+o.y)*.5;s.unshift(F,rt),s.push(F,rt)}const c=t.points,d=s.length/2;let u=s.length;const p=c.length/2,f=n.width/2,g=f*f,m=n.miterLimit*n.miterLimit;let x=s[0],y=s[1],_=s[2],v=s[3],w=0,E=0,T=-(y-v),b=x-_,S=0,A=0,L=Math.sqrt(T*T+b*b);T/=L,b/=L,T*=f,b*=f;const Y=n.alignment,C=(1-Y)*2,I=Y*2;h||(n.cap===vi.ROUND?u+=li(x-T*(C-I)*.5,y-b*(C-I)*.5,x-T*C,y-b*C,x+T*I,y+b*I,c,!0)+2:n.cap===vi.SQUARE&&(u+=mh(x,y,T,b,C,I,!0,c))),c.push(x-T*C,y-b*C,x+T*I,y+b*I);for(let F=1;F<d-1;++F){x=s[(F-1)*2],y=s[(F-1)*2+1],_=s[F*2],v=s[F*2+1],w=s[(F+1)*2],E=s[(F+1)*2+1],T=-(y-v),b=x-_,L=Math.sqrt(T*T+b*b),T/=L,b/=L,T*=f,b*=f,S=-(v-E),A=_-w,L=Math.sqrt(S*S+A*A),S/=L,A/=L,S*=f,A*=f;const rt=_-x,Nt=y-v,R=_-w,B=E-v,G=rt*R+Nt*B,Z=Nt*R-B*rt,z=Z<0;if(Math.abs(Z)<.001*Math.abs(G)){c.push(_-T*C,v-b*C,_+T*I,v+b*I),G>=0&&(n.join===fe.ROUND?u+=li(_,v,_-T*C,v-b*C,_-S*C,v-A*C,c,!1)+4:u+=2,c.push(_-S*I,v-A*I,_+S*C,v+A*C));continue}const nt=(-T+x)*(-b+v)-(-T+_)*(-b+y),_t=(-S+w)*(-A+v)-(-S+_)*(-A+E),At=(rt*_t-R*nt)/Z,Bt=(B*nt-Nt*_t)/Z,Yt=(At-_)*(At-_)+(Bt-v)*(Bt-v),Pt=_+(At-_)*C,ht=v+(Bt-v)*C,yt=_-(At-_)*I,bt=v-(Bt-v)*I,we=Math.min(rt*rt+Nt*Nt,R*R+B*B),Te=z?C:I,us=we+Te*Te*g,Yc=Yt<=us;let Js=n.join;if(Js===fe.MITER&&Yt/g>m&&(Js=fe.BEVEL),Yc)switch(Js){case fe.MITER:{c.push(Pt,ht,yt,bt);break}case fe.BEVEL:{z?c.push(Pt,ht,_+T*I,v+b*I,Pt,ht,_+S*I,v+A*I):c.push(_-T*C,v-b*C,yt,bt,_-S*C,v-A*C,yt,bt),u+=2;break}case fe.ROUND:{z?(c.push(Pt,ht,_+T*I,v+b*I),u+=li(_,v,_+T*I,v+b*I,_+S*I,v+A*I,c,!0)+4,c.push(Pt,ht,_+S*I,v+A*I)):(c.push(_-T*C,v-b*C,yt,bt),u+=li(_,v,_-T*C,v-b*C,_-S*C,v-A*C,c,!1)+4,c.push(_-S*C,v-A*C,yt,bt));break}}else{switch(c.push(_-T*C,v-b*C,_+T*I,v+b*I),Js){case fe.MITER:{z?c.push(yt,bt,yt,bt):c.push(Pt,ht,Pt,ht),u+=2;break}case fe.ROUND:{z?u+=li(_,v,_+T*I,v+b*I,_+S*I,v+A*I,c,!0)+2:u+=li(_,v,_-T*C,v-b*C,_-S*C,v-A*C,c,!1)+2;break}}c.push(_-S*C,v-A*C,_+S*I,v+A*I),u+=2}}x=s[(d-2)*2],y=s[(d-2)*2+1],_=s[(d-1)*2],v=s[(d-1)*2+1],T=-(y-v),b=x-_,L=Math.sqrt(T*T+b*b),T/=L,b/=L,T*=f,b*=f,c.push(_-T*C,v-b*C,_+T*I,v+b*I),h||(n.cap===vi.ROUND?u+=li(_-T*(C-I)*.5,v-b*(C-I)*.5,_-T*C,v-b*C,_+T*I,v+b*I,c,!1)+2:n.cap===vi.SQUARE&&(u+=mh(_,v,T,b,C,I,!1,c)));const q=t.indices,Q=ts.epsilon*ts.epsilon;for(let F=p;F<u+p-2;++F)x=c[F*2],y=c[F*2+1],_=c[(F+1)*2],v=c[(F+1)*2+1],w=c[(F+2)*2],E=c[(F+2)*2+1],!(Math.abs(x*(v-E)+_*(E-y)+w*(y-v))<Q)&&q.push(F,F+1,F+2)}function fp(i,t){let e=0;const s=i.shape,r=i.points||s.points,n=s.type!==kt.POLY||s.closeStroke;if(r.length===0)return;const o=t.points,a=t.indices,h=r.length/2,l=o.length/2;let c=l;for(o.push(r[0],r[1]),e=1;e<h;e++)o.push(r[e*2],r[e*2+1]),a.push(c,c+1),c++;n&&a.push(c,l)}function _h(i,t){i.lineStyle.native?fp(i,t):dp(i,t)}class Qo{static curveLength(t,e,s,r,n,o){const a=t-2*s+n,h=e-2*r+o,l=2*s-2*t,c=2*r-2*e,d=4*(a*a+h*h),u=4*(a*l+h*c),p=l*l+c*c,f=2*Math.sqrt(d+u+p),g=Math.sqrt(d),m=2*d*g,x=2*Math.sqrt(p),y=u/g;return(m*f+g*u*(f-x)+(4*p*d-u*u)*Math.log((2*g+y+f)/(y+x)))/(4*m)}static curveTo(t,e,s,r,n){const o=n[n.length-2],a=n[n.length-1],h=ts._segmentsCount(Qo.curveLength(o,a,t,e,s,r));let l=0,c=0;for(let d=1;d<=h;++d){const u=d/h;l=o+(t-o)*u,c=a+(e-a)*u,n.push(l+(t+(s-t)*u-l)*u,c+(e+(r-e)*u-c)*u)}}}const Un={[kt.POLY]:Dl,[kt.CIRC]:Lr,[kt.ELIP]:Lr,[kt.RECT]:lp,[kt.RREC]:cp},yh=[],dr=[];class Or{constructor(t,e=null,s=null,r=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=s,this.fillStyle=e,this.matrix=r,this.type=t.type}clone(){return new Or(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Li=new tt,Ul=class extends Qh{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new kr,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),dr.push(this.drawCalls[i]);this.drawCalls.length=0;for(let i=0;i<this.batches.length;i++){const t=this.batches[i];t.reset(),yh.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(i,t=null,e=null,s=null){const r=new Or(i,t,e,s);return this.graphicsData.push(r),this.dirty++,this}drawHole(i,t=null){if(!this.graphicsData.length)return null;const e=new Or(i,null,null,t),s=this.graphicsData[this.graphicsData.length-1];return e.lineStyle=s.lineStyle,s.holes.push(e),this.dirty++,this}destroy(){super.destroy();for(let i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(i){const t=this.graphicsData;for(let e=0;e<t.length;++e){const s=t[e];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(i,Li):Li.copyFrom(i),s.shape.contains(Li.x,Li.y))){let r=!1;if(s.holes){for(let n=0;n<s.holes.length;n++)if(s.holes[n].shape.contains(Li.x,Li.y)){r=!0;break}}if(!r)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const i=this.uvs,t=this.graphicsData;let e=null,s=null;this.batches.length>0&&(e=this.batches[this.batches.length-1],s=e.style);for(let a=this.shapeIndex;a<t.length;a++){this.shapeIndex++;const h=t[a],l=h.fillStyle,c=h.lineStyle;Un[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix),(l.visible||c.visible)&&this.processHoles(h.holes);for(let u=0;u<2;u++){const p=u===0?l:c;if(!p.visible)continue;const f=p.texture.baseTexture,g=this.indices.length,m=this.points.length/2;f.wrapMode=Ps.REPEAT,u===0?this.processFill(h):this.processLine(h);const x=this.points.length/2-m;x!==0&&(e&&!this._compareStyles(s,p)&&(e.end(g,m),e=null),e||(e=yh.pop()||new up,e.begin(p,g,m),this.batches.push(e),s=p),this.addUvs(this.points,i,p.texture,m,x,p.matrix))}}const r=this.indices.length,n=this.points.length/2;if(e&&e.end(r,n),this.batches.length===0){this.batchable=!0;return}const o=n>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(i,t){return!(!i||!t||i.texture.baseTexture!==t.texture.baseTexture||i.color+i.alpha!==t.color+t.alpha||!!i.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let i=0,t=this.graphicsData.length;i<t;i++){const e=this.graphicsData[i],s=e.fillStyle,r=e.lineStyle;if(s&&!s.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const i=this.batches;for(let t=0,e=i.length;t<e;t++){const s=i[t];for(let r=0;r<s.size;r++){const n=s.start+r;this.indicesUint16[n]=this.indicesUint16[n]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const i=this.batches;for(let t=0;t<i.length;t++)if(i[t].style.native)return!1;return this.points.length<Ul.BATCHABLE_SIZE*2}buildDrawCalls(){let i=++W._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),dr.push(this.drawCalls[c]);this.drawCalls.length=0;const t=this.colors,e=this.textureIds;let s=dr.pop();s||(s=new fo,s.texArray=new go),s.texArray.count=0,s.start=0,s.size=0,s.type=je.TRIANGLES;let r=0,n=null,o=0,a=!1,h=je.TRIANGLES,l=0;this.drawCalls.push(s);for(let c=0;c<this.batches.length;c++){const d=this.batches[c],u=8,p=d.style,f=p.texture.baseTexture;a!==!!p.native&&(a=!!p.native,h=a?je.LINES:je.TRIANGLES,n=null,r=u,i++),n!==f&&(n=f,f._batchEnabled!==i&&(r===u&&(i++,r=0,s.size>0&&(s=dr.pop(),s||(s=new fo,s.texArray=new go),this.drawCalls.push(s)),s.start=l,s.size=0,s.texArray.count=0,s.type=h),f.touched=1,f._batchEnabled=i,f._batchLocation=r,f.wrapMode=Ps.REPEAT,s.texArray.elements[s.texArray.count++]=f,r++)),s.size+=d.size,l+=d.size,o=f._batchLocation,this.addColors(t,p.color,p.alpha,d.attribSize,d.attribStart),this.addTextureIds(e,o,d.attribSize,d.attribStart)}W._globalBatch=i,this.packAttributes()}packAttributes(){const i=this.points,t=this.uvs,e=this.colors,s=this.textureIds,r=new ArrayBuffer(i.length*3*4),n=new Float32Array(r),o=new Uint32Array(r);let a=0;for(let h=0;h<i.length/2;h++)n[a++]=i[h*2],n[a++]=i[h*2+1],n[a++]=t[h*2],n[a++]=t[h*2+1],o[a++]=e[h],n[a++]=s[h];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)}processFill(i){i.holes.length?Dl.triangulate(i,this):Un[i.type].triangulate(i,this)}processLine(i){_h(i,this);for(let t=0;t<i.holes.length;t++)_h(i.holes[t],this)}processHoles(i){for(let t=0;t<i.length;t++){const e=i[t];Un[e.type].build(e),e.matrix&&this.transformPoints(e.points,e.matrix)}}calculateBounds(){const i=this._bounds;i.clear(),i.addVertexData(this.points,0,this.points.length),i.pad(this.boundsPadding,this.boundsPadding)}transformPoints(i,t){for(let e=0;e<i.length/2;e++){const s=i[e*2],r=i[e*2+1];i[e*2]=t.a*s+t.c*r+t.tx,i[e*2+1]=t.b*s+t.d*r+t.ty}}addColors(i,t,e,s,r=0){const n=St.shared.setValue(t).toLittleEndianNumber(),o=St.shared.setValue(n).toPremultiplied(e);i.length=Math.max(i.length,r+s);for(let a=0;a<s;a++)i[r+a]=o}addTextureIds(i,t,e,s=0){i.length=Math.max(i.length,s+e);for(let r=0;r<e;r++)i[s+r]=t}addUvs(i,t,e,s,r,n=null){let o=0;const a=t.length,h=e.frame;for(;o<r;){let c=i[(s+o)*2],d=i[(s+o)*2+1];if(n){const u=n.a*c+n.c*d+n.tx;d=n.b*c+n.d*d+n.ty,c=u}o++,t.push(c/h.width,d/h.height)}const l=e.baseTexture;(h.width<l.width||h.height<l.height)&&this.adjustUvs(t,e,a,r)}adjustUvs(i,t,e,s){const r=t.baseTexture,n=1e-6,o=e+s*2,a=t.frame,h=a.width/r.width,l=a.height/r.height;let c=a.x/a.width,d=a.y/a.height,u=Math.floor(i[e]+n),p=Math.floor(i[e+1]+n);for(let f=e+2;f<o;f+=2)u=Math.min(u,Math.floor(i[f]+n)),p=Math.min(p,Math.floor(i[f+1]+n));c-=u,d-=p;for(let f=e;f<o;f+=2)i[f]=(i[f]+c)*h,i[f+1]=(i[f+1]+d)*l}};let Gl=Ul;Gl.BATCHABLE_SIZE=100;class en{constructor(){this.color=16777215,this.alpha=1,this.texture=U.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new en;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=U.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class ta extends en{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=vi.BUTT,this.join=fe.MITER,this.miterLimit=10}clone(){const t=new ta;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const Gn={},vr=class extends et{constructor(i=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new en,this._lineStyle=new ta,this._matrix=null,this._holeMode=!1,this.state=hs.for2d(),this._geometry=i||new Gl,this._geometry.refCount++,this._transformID=-1,this._tintColor=new St(16777215),this.blendMode=N.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new vr(this._geometry)}set blendMode(i){this.state.blendMode=i}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(i){this._tintColor.setValue(i)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(i=null,t=0,e,s=.5,r=!1){return typeof i=="number"&&(i={width:i,color:t,alpha:e,alignment:s,native:r}),this.lineTextureStyle(i)}lineTextureStyle(i){const t={width:0,texture:U.WHITE,color:i!=null&&i.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:vi.BUTT,join:fe.MITER,miterLimit:10};i=Object.assign(t,i),this.normalizeColor(i),this.currentPath&&this.startPoly();const e=i.width>0&&i.alpha>0;return e?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._lineStyle,{visible:e},i)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const i=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new As,this.currentPath.closeStroke=!1,this.currentPath.points.push(i[t-2],i[t-1]))}else this.currentPath=new As,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(i,t){return this.startPoly(),this.currentPath.points[0]=i,this.currentPath.points[1]=t,this}lineTo(i,t){this.currentPath||this.moveTo(0,0);const e=this.currentPath.points,s=e[e.length-2],r=e[e.length-1];return(s!==i||r!==t)&&e.push(i,t),this}_initCurve(i=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[i,t]):this.moveTo(i,t)}quadraticCurveTo(i,t,e,s){this._initCurve();const r=this.currentPath.points;return r.length===0&&this.moveTo(0,0),Qo.curveTo(i,t,e,s,r),this}bezierCurveTo(i,t,e,s,r,n){return this._initCurve(),Jo.curveTo(i,t,e,s,r,n,this.currentPath.points),this}arcTo(i,t,e,s,r){this._initCurve(i,t);const n=this.currentPath.points,o=gh.curveTo(i,t,e,s,r,n);if(o){const{cx:a,cy:h,radius:l,startAngle:c,endAngle:d,anticlockwise:u}=o;this.arc(a,h,l,c,d,u)}return this}arc(i,t,e,s,r,n=!1){if(s===r)return this;if(!n&&r<=s?r+=Pr:n&&s<=r&&(s+=Pr),r-s===0)return this;const a=i+Math.cos(s)*e,h=t+Math.sin(s)*e,l=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const d=Math.abs(c[c.length-2]-a),u=Math.abs(c[c.length-1]-h);d<l&&u<l||c.push(a,h)}else this.moveTo(a,h),c=this.currentPath.points;return gh.arc(a,h,i,t,e,s,r,n,c),this}beginFill(i=0,t){return this.beginTextureFill({texture:U.WHITE,color:i,alpha:t})}normalizeColor(i){const t=St.shared.setValue(i.color??0);i.color=t.toNumber(),i.alpha??(i.alpha=t.alpha)}beginTextureFill(i){const t={texture:U.WHITE,color:16777215,matrix:null};i=Object.assign(t,i),this.normalizeColor(i),this.currentPath&&this.startPoly();const e=i.alpha>0;return e?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._fillStyle,{visible:e},i)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(i,t,e,s){return this.drawShape(new j(i,t,e,s))}drawRoundedRect(i,t,e,s,r){return this.drawShape(new Yo(i,t,e,s,r))}drawCircle(i,t,e){return this.drawShape(new $o(i,t,e))}drawEllipse(i,t,e,s){return this.drawShape(new jo(i,t,e,s))}drawPolygon(...i){let t,e=!0;const s=i[0];s.points?(e=s.closeStroke,t=s.points):Array.isArray(i[0])?t=i[0]:t=i;const r=new As(t);return r.closeStroke=e,this.drawShape(r),this}drawShape(i){return this._holeMode?this._geometry.drawHole(i,this._matrix):this._geometry.drawShape(i,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const i=this._geometry.graphicsData;return i.length===1&&i[0].shape.type===kt.RECT&&!i[0].matrix&&!i[0].holes.length&&!(i[0].lineStyle.visible&&i[0].lineStyle.width)}_render(i){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(i)):(i.batch.flush(),this._renderDirect(i))}_populateBatches(){const i=this._geometry,t=this.blendMode,e=i.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=i.batchDirty,this.batches.length=e,this.vertexData=new Float32Array(i.points);for(let s=0;s<e;s++){const r=i.batches[s],n=r.style.color,o=new Float32Array(this.vertexData.buffer,r.attribStart*4*2,r.attribSize*2),a=new Float32Array(i.uvsFloat32.buffer,r.attribStart*4*2,r.attribSize*2),h=new Uint16Array(i.indicesUint16.buffer,r.start*2,r.size),l={vertexData:o,blendMode:t,indices:h,uvs:a,_batchRGB:St.shared.setValue(n).toRgbArray(),_tintRGB:n,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[s]=l}}_renderBatched(i){if(this.batches.length){i.batch.setObjectRenderer(i.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,e=this.batches.length;t<e;t++){const s=this.batches[t];s.worldAlpha=this.worldAlpha*s.alpha,i.plugins[this.pluginName].render(s)}}}_renderDirect(i){const t=this._resolveDirectShader(i),e=this._geometry,s=this.worldAlpha,r=t.uniforms,n=e.drawCalls;r.translationMatrix=this.transform.worldTransform,St.shared.setValue(this._tintColor).multiply([s,s,s]).setAlpha(s).toArray(r.tint),i.shader.bind(t),i.geometry.bind(e,t),i.state.set(this.state);for(let o=0,a=n.length;o<a;o++)this._renderDrawCallDirect(i,e.drawCalls[o])}_renderDrawCallDirect(i,t){const{texArray:e,type:s,size:r,start:n}=t,o=e.count;for(let a=0;a<o;a++)i.texture.bind(e.elements[a],a);i.geometry.draw(s,r,n)}_resolveDirectShader(i){let t=this.shader;const e=this.pluginName;if(!t){if(!Gn[e]){const{maxTextures:s}=i.plugins[e],r=new Int32Array(s);for(let a=0;a<s;a++)r[a]=a;const n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Et,default:xe.from({uSamplers:r},!0)},o=i.plugins[e]._shader.program;Gn[e]=new Ys(o,n)}t=Gn[e]}return t}_calculateBounds(){this.finishPoly();const i=this._geometry;if(!i.graphicsData.length)return;const{minX:t,minY:e,maxX:s,maxY:r}=i.bounds;this._bounds.addFrame(this.transform,t,e,s,r)}containsPoint(i){return this.worldTransform.applyInverse(i,vr._TEMP_POINT),this._geometry.containsPoint(vr._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let i=0;i<this.batches.length;i++){const t=this.batches[i];t._tintRGB=St.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const i=this.transform._worldID;if(this._transformID===i)return;this._transformID=i;const t=this.transform.worldTransform,e=t.a,s=t.b,r=t.c,n=t.d,o=t.tx,a=t.ty,h=this._geometry.points,l=this.vertexData;let c=0;for(let d=0;d<h.length;d+=2){const u=h[d],p=h[d+1];l[c++]=e*u+r*p+o,l[c++]=n*p+s*u+a}}closePath(){const i=this.currentPath;return i&&(i.closeStroke=!0,this.finishPoly()),this}setMatrix(i){return this._matrix=i,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(i){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(i)}};let ve=vr;ve.curves=ts;ve._TEMP_POINT=new tt;var sn=(i=>(i[i.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",i[i.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",i))(sn||{});const fr={willReadFrequently:!0},M=class{static get experimentalLetterSpacingSupported(){let i=M._experimentalLetterSpacingSupported;if(i!==void 0){const t=O.ADAPTER.getCanvasRenderingContext2D().prototype;i=M._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return i}constructor(i,t,e,s,r,n,o,a,h){this.text=i,this.style=t,this.width=e,this.height=s,this.lines=r,this.lineWidths=n,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h}static measureText(i,t,e,s=M._canvas){e=e??t.wordWrap;const r=t.toFontString(),n=M.measureFont(r);n.fontSize===0&&(n.fontSize=t.fontSize,n.ascent=t.fontSize);const o=s.getContext("2d",fr);o.font=r;const h=(e?M.wordWrap(i,t,s):i).split(/(?:\r\n|\r|\n)/),l=new Array(h.length);let c=0;for(let f=0;f<h.length;f++){const g=M._measureText(h[f],t.letterSpacing,o);l[f]=g,c=Math.max(c,g)}let d=c+t.strokeThickness;t.dropShadow&&(d+=t.dropShadowDistance);const u=t.lineHeight||n.fontSize+t.strokeThickness;let p=Math.max(u,n.fontSize+t.strokeThickness*2)+(h.length-1)*(u+t.leading);return t.dropShadow&&(p+=t.dropShadowDistance),new M(i,t,d,p,h,l,u+t.leading,c,n)}static _measureText(i,t,e){let s=!1;M.experimentalLetterSpacingSupported&&(M.experimentalLetterSpacing?(e.letterSpacing=`${t}px`,e.textLetterSpacing=`${t}px`,s=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));let r=e.measureText(i).width;return r>0&&(s?r-=t:r+=(M.graphemeSegmenter(i).length-1)*t),r}static wordWrap(i,t,e=M._canvas){const s=e.getContext("2d",fr);let r=0,n="",o="";const a=Object.create(null),{letterSpacing:h,whiteSpace:l}=t,c=M.collapseSpaces(l),d=M.collapseNewlines(l);let u=!c;const p=t.wordWrapWidth+h,f=M.tokenize(i);for(let g=0;g<f.length;g++){let m=f[g];if(M.isNewline(m)){if(!d){o+=M.addLine(n),u=!c,n="",r=0;continue}m=" "}if(c){const y=M.isBreakingSpace(m),_=M.isBreakingSpace(n[n.length-1]);if(y&&_)continue}const x=M.getFromCache(m,h,a,s);if(x>p)if(n!==""&&(o+=M.addLine(n),n="",r=0),M.canBreakWords(m,t.breakWords)){const y=M.wordWrapSplit(m);for(let _=0;_<y.length;_++){let v=y[_],w=v,E=1;for(;y[_+E];){const b=y[_+E];if(!M.canBreakChars(w,b,m,_,t.breakWords))v+=b;else break;w=b,E++}_+=E-1;const T=M.getFromCache(v,h,a,s);T+r>p&&(o+=M.addLine(n),u=!1,n="",r=0),n+=v,r+=T}}else{n.length>0&&(o+=M.addLine(n),n="",r=0);const y=g===f.length-1;o+=M.addLine(m,!y),u=!1,n="",r=0}else x+r>p&&(u=!1,o+=M.addLine(n),n="",r=0),(n.length>0||!M.isBreakingSpace(m)||u)&&(n+=m,r+=x)}return o+=M.addLine(n,!1),o}static addLine(i,t=!0){return i=M.trimRight(i),i=t?`${i}
`:i,i}static getFromCache(i,t,e,s){let r=e[i];return typeof r!="number"&&(r=M._measureText(i,t,s)+t,e[i]=r),r}static collapseSpaces(i){return i==="normal"||i==="pre-line"}static collapseNewlines(i){return i==="normal"}static trimRight(i){if(typeof i!="string")return"";for(let t=i.length-1;t>=0;t--){const e=i[t];if(!M.isBreakingSpace(e))break;i=i.slice(0,-1)}return i}static isNewline(i){return typeof i!="string"?!1:M._newlines.includes(i.charCodeAt(0))}static isBreakingSpace(i,t){return typeof i!="string"?!1:M._breakingSpaces.includes(i.charCodeAt(0))}static tokenize(i){const t=[];let e="";if(typeof i!="string")return t;for(let s=0;s<i.length;s++){const r=i[s],n=i[s+1];if(M.isBreakingSpace(r,n)||M.isNewline(r)){e!==""&&(t.push(e),e=""),t.push(r);continue}e+=r}return e!==""&&t.push(e),t}static canBreakWords(i,t){return t}static canBreakChars(i,t,e,s,r){return!0}static wordWrapSplit(i){return M.graphemeSegmenter(i)}static measureFont(i){if(M._fonts[i])return M._fonts[i];const t={ascent:0,descent:0,fontSize:0},e=M._canvas,s=M._context;s.font=i;const r=M.METRICS_STRING+M.BASELINE_SYMBOL,n=Math.ceil(s.measureText(r).width);let o=Math.ceil(s.measureText(M.BASELINE_SYMBOL).width);const a=Math.ceil(M.HEIGHT_MULTIPLIER*o);if(o=o*M.BASELINE_MULTIPLIER|0,n===0||a===0)return M._fonts[i]=t,t;e.width=n,e.height=a,s.fillStyle="#f00",s.fillRect(0,0,n,a),s.font=i,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(r,0,o);const h=s.getImageData(0,0,n,a).data,l=h.length,c=n*4;let d=0,u=0,p=!1;for(d=0;d<o;++d){for(let f=0;f<c;f+=4)if(h[u+f]!==255){p=!0;break}if(!p)u+=c;else break}for(t.ascent=o-d,u=l-c,p=!1,d=a;d>o;--d){for(let f=0;f<c;f+=4)if(h[u+f]!==255){p=!0;break}if(!p)u-=c;else break}return t.descent=d-o,t.fontSize=t.ascent+t.descent,M._fonts[i]=t,t}static clearMetrics(i=""){i?delete M._fonts[i]:M._fonts={}}static get _canvas(){if(!M.__canvas){let i;try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d",fr);if(e!=null&&e.measureText)return M.__canvas=t,t;i=O.ADAPTER.createCanvas()}catch{i=O.ADAPTER.createCanvas()}i.width=i.height=10,M.__canvas=i}return M.__canvas}static get _context(){return M.__context||(M.__context=M._canvas.getContext("2d",fr)),M.__context}};let Gt=M;Gt.METRICS_STRING="|q";Gt.BASELINE_SYMBOL="M";Gt.BASELINE_MULTIPLIER=1.4;Gt.HEIGHT_MULTIPLIER=2;Gt.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const i=new Intl.Segmenter;return t=>[...i.segment(t)].map(e=>e.segment)}return i=>[...i]})();Gt.experimentalLetterSpacing=!1;Gt._fonts={};Gt._newlines=[10,13];Gt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const pp=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],bs=class{constructor(i){this.styleID=0,this.reset(),zn(this,i,i)}clone(){const i={};return zn(i,this,bs.defaultStyle),new bs(i)}reset(){zn(this,bs.defaultStyle,bs.defaultStyle)}get align(){return this._align}set align(i){this._align!==i&&(this._align=i,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(i){this._breakWords!==i&&(this._breakWords=i,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(i){this._dropShadow!==i&&(this._dropShadow=i,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(i){this._dropShadowAlpha!==i&&(this._dropShadowAlpha=i,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(i){this._dropShadowAngle!==i&&(this._dropShadowAngle=i,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(i){this._dropShadowBlur!==i&&(this._dropShadowBlur=i,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(i){const t=Vn(i);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(i){this._dropShadowDistance!==i&&(this._dropShadowDistance=i,this.styleID++)}get fill(){return this._fill}set fill(i){const t=Vn(i);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(i){this._fillGradientType!==i&&(this._fillGradientType=i,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(i){gp(this._fillGradientStops,i)||(this._fillGradientStops=i,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(i){this.fontFamily!==i&&(this._fontFamily=i,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(i){this._fontSize!==i&&(this._fontSize=i,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(i){this._fontStyle!==i&&(this._fontStyle=i,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(i){this._fontVariant!==i&&(this._fontVariant=i,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(i){this._fontWeight!==i&&(this._fontWeight=i,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(i){this._lineHeight!==i&&(this._lineHeight=i,this.styleID++)}get leading(){return this._leading}set leading(i){this._leading!==i&&(this._leading=i,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(i){this._lineJoin!==i&&(this._lineJoin=i,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(i){this._miterLimit!==i&&(this._miterLimit=i,this.styleID++)}get padding(){return this._padding}set padding(i){this._padding!==i&&(this._padding=i,this.styleID++)}get stroke(){return this._stroke}set stroke(i){const t=Vn(i);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(i){this._strokeThickness!==i&&(this._strokeThickness=i,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(i){this._textBaseline!==i&&(this._textBaseline=i,this.styleID++)}get trim(){return this._trim}set trim(i){this._trim!==i&&(this._trim=i,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(i){this._whiteSpace!==i&&(this._whiteSpace=i,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(i){this._wordWrap!==i&&(this._wordWrap=i,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(i){this._wordWrapWidth!==i&&(this._wordWrapWidth=i,this.styleID++)}toFontString(){const i=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let s=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!pp.includes(s)&&(s=`"${s}"`),t[e]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${i} ${t.join(",")}`}};let So=bs;So.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:sn.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function Vn(i){const t=St.shared;return Array.isArray(i)?i.map(e=>t.setValue(e).toHex()):t.setValue(i).toHex()}function gp(i,t){if(!Array.isArray(i)||!Array.isArray(t)||i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(i[e]!==t[e])return!1;return!0}function zn(i,t,e){for(const s in e)Array.isArray(t[s])?i[s]=t[s].slice():i[s]=t[s]}const mp={texture:!0,children:!1,baseTexture:!0},Eo=class extends H{constructor(i,t,e){let s=!1;e||(e=O.ADAPTER.createCanvas(),s=!0),e.width=3,e.height=3;const r=U.from(e);r.orig=new j,r.trim=new j,super(r),this._ownCanvas=s,this.canvas=e,this.context=e.getContext("2d",{willReadFrequently:!0}),this._resolution=Eo.defaultResolution??O.RESOLUTION,this._autoResolution=Eo.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=i,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return Gt.experimentalLetterSpacing}static set experimentalLetterSpacing(i){$("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Gt.experimentalLetterSpacing=i}updateText(i){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&i)return;this._font=this._style.toFontString();const e=this.context,s=Gt.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),r=s.width,n=s.height,o=s.lines,a=s.lineHeight,h=s.lineWidths,l=s.maxLineWidth,c=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,r)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),e.scale(this._resolution,this._resolution),e.clearRect(0,0,this.canvas.width,this.canvas.height),e.font=this._font,e.lineWidth=t.strokeThickness,e.textBaseline=t.textBaseline,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit;let d,u;const p=t.dropShadow?2:1;for(let f=0;f<p;++f){const g=t.dropShadow&&f===0,m=g?Math.ceil(Math.max(1,n)+t.padding*2):0,x=m*this._resolution;if(g){e.fillStyle="black",e.strokeStyle="black";const _=t.dropShadowColor,v=t.dropShadowBlur*this._resolution,w=t.dropShadowDistance*this._resolution;e.shadowColor=St.shared.setValue(_).setAlpha(t.dropShadowAlpha).toRgbaString(),e.shadowBlur=v,e.shadowOffsetX=Math.cos(t.dropShadowAngle)*w,e.shadowOffsetY=Math.sin(t.dropShadowAngle)*w+x}else e.fillStyle=this._generateFillStyle(t,o,s),e.strokeStyle=t.stroke,e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;let y=(a-c.fontSize)/2;a-c.fontSize<0&&(y=0);for(let _=0;_<o.length;_++)d=t.strokeThickness/2,u=t.strokeThickness/2+_*a+c.ascent+y,t.align==="right"?d+=l-h[_]:t.align==="center"&&(d+=(l-h[_])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(o[_],d+t.padding,u+t.padding-m,!0),t.fill&&this.drawLetterSpacing(o[_],d+t.padding,u+t.padding-m)}this.updateTexture()}drawLetterSpacing(i,t,e,s=!1){const n=this._style.letterSpacing;let o=!1;if(Gt.experimentalLetterSpacingSupported&&(Gt.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),n===0||o){s?this.context.strokeText(i,t,e):this.context.fillText(i,t,e);return}let a=t;const h=Gt.graphemeSegmenter(i);let l=this.context.measureText(i).width,c=0;for(let d=0;d<h.length;++d){const u=h[d];s?this.context.strokeText(u,a,e):this.context.fillText(u,a,e);let p="";for(let f=d+1;f<h.length;++f)p+=h[f];c=this.context.measureText(p).width,a+=l-c+n,l=c}}updateTexture(){const i=this.canvas;if(this._style.trim){const n=ed(i);n.data&&(i.width=n.width,i.height=n.height,this.context.putImageData(n.data,0,0))}const t=this._texture,e=this._style,s=e.trim?0:e.padding,r=t.baseTexture;t.trim.width=t._frame.width=i.width/this._resolution,t.trim.height=t._frame.height=i.height/this._resolution,t.trim.x=-s,t.trim.y=-s,t.orig.width=t._frame.width-s*2,t.orig.height=t._frame.height-s*2,this._onTextureUpdate(),r.setRealSize(i.width,i.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),super._render(i)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(i,t){return this.updateText(!0),this._textureID===-1&&(i=!1),super.getBounds(i,t)}getLocalBounds(i){return this.updateText(!0),super.getLocalBounds.call(this,i)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(i,t,e){const s=i.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let r;const n=i.dropShadow?i.dropShadowDistance:0,o=i.padding||0,a=this.canvas.width/this._resolution-n-o*2,h=this.canvas.height/this._resolution-n-o*2,l=s.slice(),c=i.fillGradientStops.slice();if(!c.length){const d=l.length+1;for(let u=1;u<d;++u)c.push(u/d)}if(l.unshift(s[0]),c.unshift(0),l.push(s[s.length-1]),c.push(1),i.fillGradientType===sn.LINEAR_VERTICAL){r=this.context.createLinearGradient(a/2,o,a/2,h+o);const d=e.fontProperties.fontSize+i.strokeThickness;for(let u=0;u<t.length;u++){const p=e.lineHeight*(u-1)+d,f=e.lineHeight*u;let g=f;u>0&&p>f&&(g=(f+p)/2);const m=f+d,x=e.lineHeight*(u+1);let y=m;u+1<t.length&&x<m&&(y=(m+x)/2);const _=(y-g)/h;for(let v=0;v<l.length;v++){let w=0;typeof c[v]=="number"?w=c[v]:w=v/l.length;let E=Math.min(1,Math.max(0,g/h+w*_));E=Number(E.toFixed(5)),r.addColorStop(E,l[v])}}}else{r=this.context.createLinearGradient(o,h/2,a+o,h/2);const d=l.length+1;let u=1;for(let p=0;p<l.length;p++){let f;typeof c[p]=="number"?f=c[p]:f=u/d,r.addColorStop(f,l[p]),u++}}return r}destroy(i){typeof i=="boolean"&&(i={children:i}),i=Object.assign({},mp,i),super.destroy(i),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(i){this.updateText(!0);const t=Ui(this.scale.x)||1;this.scale.x=t*i/this._texture.orig.width,this._width=i}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(i){this.updateText(!0);const t=Ui(this.scale.y)||1;this.scale.y=t*i/this._texture.orig.height,this._height=i}get style(){return this._style}set style(i){i=i||{},i instanceof So?this._style=i:this._style=new So(i),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(i){i=String(i??""),this._text!==i&&(this._text=i,this.dirty=!0)}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}};let Vt=Eo;Vt.defaultAutoResolution=!0;const xh={white:16777215,red:16711680,green:32768,blue:255,gray:8421504,yellow:16776960,gold:16766720,aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,blanchedalmond:16772045,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,goldenrod:14329120,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,whitesmoke:16119285,yellowgreen:10145074,black:0},_p=["visible","hidden"],yp=["center","left","right","justify"],xp=["middle","top","bottom"];function vp([i,t,e]){return parseInt(`0x${Hn(i)}${Hn(t)}${Hn(e)}`,16)}function Hn(i){const t=i.toString(16);return t.length===1?`0${t}`:t}function bp(i,t,e){e/=100;const s=t*Math.min(e,1-e)/100,r=n=>{const o=(n+i/30)%12,a=e-s*Math.max(Math.min(o-3,9-o,1),-1);return Math.round(255*a).toString(16).padStart(2,"0")};return qh(`#${r(0)}${r(8)}${r(4)}`)}function Vl(i){if(i!=="transparent"&&i!==void 0)switch(typeof i){case"string":if(i.startsWith("#")||i.startsWith("0x"))return{hex:qh(i),opacity:1};if(i.startsWith("rgba(")){const t=i.slice(5,-1).split(","),e=t.map(s=>parseInt(s,10));return{hex:vp(e),opacity:parseFloat(t[3])}}else if(i.startsWith("rgb(")){const e=i.slice(5,-1).split(",").map(s=>parseInt(s,10));return{hex:Ku(e),opacity:1}}else if(i.startsWith("hsla(")){const t=i.slice(5,-1).split(","),[e,s,r]=t.map(n=>parseInt(n,10));return{hex:bp(e,s,r),opacity:parseFloat(t[3])}}else if(Object.keys(xh).includes(i))return{hex:xh[i],opacity:1};throw new Error(`Unknown color format: ${i}`);case"number":return{hex:i,opacity:1};default:return{hex:parseInt(i,16),opacity:1}}}function Se(i,t){if(i!==void 0){if(typeof i=="number")return i;if(typeof i=="string"){if(i.endsWith("px"))return Math.floor(parseInt(i.slice(0,-2),10));if(i.endsWith("%")){const e=parseInt(i.slice(0,-1),10);return Math.floor(t?t/100*e:e)}return Math.floor(parseInt(i,10))}return 0}}function Ao(i){var t;return{align:(i==null?void 0:i.textAlign)??yp[1],breakWords:(i==null?void 0:i.breakWords)??!0,dropShadow:(i==null?void 0:i.dropShadow)??!1,dropShadowAlpha:(i==null?void 0:i.dropShadowAlpha)??1,dropShadowAngle:(i==null?void 0:i.dropShadowAngle)??Math.PI/6,dropShadowBlur:(i==null?void 0:i.dropShadowBlur)??0,dropShadowColor:(i==null?void 0:i.dropShadowColor)??"black",dropShadowDistance:(i==null?void 0:i.dropShadowDistance)??5,fill:(i==null?void 0:i.fill)??((t=Vl(i==null?void 0:i.color))==null?void 0:t.hex)??"black",fillGradientType:(i==null?void 0:i.fillGradientType)??sn.LINEAR_VERTICAL,fillGradientStops:(i==null?void 0:i.fillGradientStops)??[],fontFamily:(i==null?void 0:i.fontFamily)??"Arial",fontSize:(i==null?void 0:i.fontSize)??26,fontStyle:(i==null?void 0:i.fontStyle)??"normal",fontVariant:(i==null?void 0:i.fontVariant)??"normal",fontWeight:(i==null?void 0:i.fontWeight)??"normal",letterSpacing:(i==null?void 0:i.letterSpacing)??0,lineHeight:(i==null?void 0:i.lineHeight)??0,lineJoin:(i==null?void 0:i.lineJoin)??"miter",miterLimit:(i==null?void 0:i.miterLimit)??10,stroke:(i==null?void 0:i.stroke)??"black",strokeThickness:(i==null?void 0:i.strokeThickness)??0,textBaseline:(i==null?void 0:i.textBaseline)??"alphabetic",trim:(i==null?void 0:i.trim)??!1,whiteSpace:(i==null?void 0:i.whiteSpace)??"pre",wordWrap:(i==null?void 0:i.wordWrap)??!0,wordWrapWidth:(i==null?void 0:i.wordWrapWidth)??100,leading:(i==null?void 0:i.leading)??0}}function $e(i){return i.content.children.size===1?i.content.children.entries().next().value[1]instanceof Vt:!1}class wp{constructor(t){this.layout=t}update(t,e){this.setSelfPosition(t,e),this.layout.content.resize(this.layout.width,this.layout.height),this.alignChildren(this.layout.width,this.layout.height)}alignChildren(t,e){let s=0;const{style:r}=this.layout,n=r.paddingTop??0,o=r.paddingRight??0,a=r.paddingBottom??0,h=r.paddingLeft??0;let l=h,c=n;this.layout.content.children.forEach(u=>{if(!u.height&&!u.width)return;if(u instanceof Vt&&$e(this.layout)){const T=t-h-o,b=r.textAlign;u.width<T?b==="center"?(u.anchor.x=.5,u.x=t/2):b==="right"?(u.anchor.x=1,u.x=t-o):(u.anchor.x=0,u.x=h):(u.anchor.x=0,u.x=h);const S=r.verticalAlign,A=e-n-a;u.height<A?S==="middle"?(u.anchor.y=.5,u.y=e/2):S==="bottom"?(u.anchor.y=1,u.y=e-a):(u.anchor.y=0,u.y=n):(u.anchor.y=0,u.y=n);return}let p="inline-block",f=0,g=0,m=0,x=0;if(u instanceof pt){p=u.style.display;const T=u.style.position;if(f=u.style.marginLeft,g=u.style.marginRight,m=u.style.marginTop,x=u.style.marginBottom,T!==void 0)return}let y=0,_=0;r.position===void 0&&(y=r.anchorX!==void 0?r.anchorX*this.layout.width:0,_=r.anchorY!==void 0?r.anchorY*this.layout.height:0),u.x=l+f-y,u.y=c+m-_,u.height+m+x>s&&(s=u.height+m+x);const v=t-o;p==="block"&&u.width<v&&(p="inline-block");const w=l+u.width+g<=v,E=u===this.layout.content.firstChild;switch(p){case"inline":case"inline-block":!w&&!E?(l=h+u.width+g,c+=s,u.x=h+f,u.y=c+m):l+=u.width+g;break;default:c+=u.height+x;break}})}setSelfPosition(t,e){const{position:s,marginRight:r,marginBottom:n,marginTop:o,marginLeft:a}=this.layout.style||{},{style:h}=this.layout;if(!s)return;const l=this.layout.scale.x,c=this.layout.scale.y,d=this.layout.width*l,u=this.layout.height*c,p=h.anchorX,f=h.anchorY;switch(s){case"rightTop":case"topRight":case"right":this.layout.x=t-r-d*(p??1),this.layout.y=o-u*(f??0);break;case"leftBottom":case"bottomLeft":case"bottom":this.layout.x=a-d*(p??0),this.layout.y=e-n-u*(f??1);break;case"rightBottom":case"bottomRight":this.layout.x=t-r-d*(p??1),this.layout.y=e-n-u*(f??1);break;case"center":this.layout.x=t/2-d*(p??.5)+a,this.layout.y=e/2-u*(f??.5)+o;break;case"centerTop":case"topCenter":this.layout.x=t/2-d*(p??.5)+a,this.layout.y=o-u*(f??0);break;case"centerBottom":case"bottomCenter":this.layout.x=t/2-d*(p??.5)+a,this.layout.y=e-n-u*(f??1);break;case"centerLeft":case"leftCenter":this.layout.x=a-d*(p??0),this.layout.y=e/2-u*(f??.5)+o;break;case"centerRight":case"rightCenter":this.layout.x=t-r-d*(p??1),this.layout.y=e/2-u*(f??.5)+o;break;case"leftTop":case"topLeft":case"left":case"top":default:this.layout.x=a-d*(p??0),this.layout.y=o-u*(f??0)}}}class Tp{constructor(t,e){this.styles={},this._textStyle={},this.layout=t,this.set(e)}set(t){this.styles.overflow=(t==null?void 0:t.overflow)??this.styles.overflow??_p[0],this.styles.display=(t==null?void 0:t.display)??this.styles.display??"inline-block",this.styles.borderRadius=(t==null?void 0:t.borderRadius)??this.styles.borderRadius??0,this.styles.zIndex=(t==null?void 0:t.zIndex)??this.styles.zIndex??1,this.opacity=(t==null?void 0:t.opacity)??this.styles.opacity??1,this.styles.maxWidth=(t==null?void 0:t.maxWidth)??this.styles.maxWidth,this.styles.maxHeight=(t==null?void 0:t.maxHeight)??this.styles.maxHeight,this.styles.minWidth=(t==null?void 0:t.minWidth)??this.styles.minWidth,this.styles.minHeight=(t==null?void 0:t.minHeight)??this.styles.minHeight,this.styles.padding=(t==null?void 0:t.padding)??this.styles.padding??0,this.styles.paddingTop=(t==null?void 0:t.paddingTop)??(t==null?void 0:t.padding)??this.styles.paddingTop??0,this.styles.paddingRight=(t==null?void 0:t.paddingRight)??(t==null?void 0:t.padding)??this.styles.paddingRight??0,this.styles.paddingBottom=(t==null?void 0:t.paddingBottom)??(t==null?void 0:t.padding)??this.styles.paddingBottom??0,this.styles.paddingLeft=(t==null?void 0:t.paddingLeft)??(t==null?void 0:t.padding)??this.styles.paddingLeft??0,this.styles.margin=(t==null?void 0:t.margin)??this.styles.margin??0,this.styles.marginTop=(t==null?void 0:t.marginTop)??(t==null?void 0:t.margin)??this.styles.marginTop??0,this.styles.marginRight=(t==null?void 0:t.marginRight)??(t==null?void 0:t.margin)??this.styles.marginRight??0,this.styles.marginBottom=(t==null?void 0:t.marginBottom)??(t==null?void 0:t.margin)??this.styles.marginBottom??0,this.styles.marginLeft=(t==null?void 0:t.marginLeft)??(t==null?void 0:t.margin)??this.styles.marginLeft??0,this.styles.scale=(t==null?void 0:t.scale)??this.styles.scale??1,this.styles.scaleX=(t==null?void 0:t.scaleX)??(t==null?void 0:t.scale)??this.styles.scaleX??1,this.styles.scaleY=(t==null?void 0:t.scaleY)??(t==null?void 0:t.scale)??this.styles.scaleY??1,this.styles.width=(t==null?void 0:t.width)??this.styles.width??"auto",this.styles.height=(t==null?void 0:t.height)??this.styles.height??"auto",(t==null?void 0:t.anchorX)!==void 0?this.styles.anchorX=t.anchorX:(t==null?void 0:t.anchor)!==void 0&&(typeof t.anchor=="number"?this.styles.anchorX=t.anchor:Array.isArray(t.anchor)&&(this.styles.anchorX=t.anchor[0])),(t==null?void 0:t.anchorY)!==void 0?this.styles.anchorY=t.anchorY:(t==null?void 0:t.anchor)!==void 0&&(typeof t.anchor=="number"?this.styles.anchorY=t.anchor:Array.isArray(t.anchor)&&t.anchor[1]!==void 0&&(this.styles.anchorY=t.anchor[1])),this.styles.background=(t==null?void 0:t.background)??(t==null?void 0:t.backgroundColor)??this.styles.background,this.styles.textAlign=(t==null?void 0:t.textAlign)??this.styles.textAlign,this.styles.position=(t==null?void 0:t.position)??this.styles.position,this.styles.verticalAlign=(t==null?void 0:t.verticalAlign)??this.styles.verticalAlign??xp[0],this._textStyle=Ao(t)}get(t){return this.styles[t]}getAll(){return this.styles}get textStyle(){return this._textStyle}set opacity(t){this.styles.opacity=t,this.layout.alpha=t}get opacity(){return this.styles.opacity}}class Sp{constructor(t){this.parentWidth=0,this.parentHeight=0,this.layout=t}update(t,e){var y,_,v,w,E;let s=0,r=0;t!==void 0&&(this.parentWidth=t),e!==void 0&&(this.parentHeight=e);const{width:n,height:o,maxWidth:a,maxHeight:h,minWidth:l,minHeight:c,scaleX:d,scaleY:u,background:p,paddingLeft:f,paddingRight:g,paddingTop:m,paddingBottom:x}=this.layout.style;if(n===0||o===0){this.layout.visible=!1;return}if(n==="auto")switch(this.autoSizeModificator){case"innerText":const T=this.innerText.width+f+g>this.parentWidth;!this.innerText.style.wordWrap&&T&&(this.innerText.style.wordWrap=!0),this.innerText.style.wordWrap&&(this.innerText.style.wordWrapWidth=this.parentWidth-f-g),s=this.innerText.width;break;case"background":s=p.width;break;case"contentSize":let b=0;this.layout.content.resize(this.parentWidth,this.parentHeight);const{firstChild:S}=this.layout.content;S instanceof pt?b+=S.width+S.style.marginLeft+S.style.marginRight:S instanceof et&&S.width&&(b+=S.width),this.layout.content.children.forEach(A=>{if(A!==S)if(A instanceof pt&&A.style.display!=="block"){if(A.style.position)return;b+=A.width+A.style.marginLeft}else A instanceof et&&A.width&&(b+=A.width)}),s=b+f+g,$e(this.layout)&&(s=((y=this.innerText)==null?void 0:y.width)+f+g);break;case"parentSize":default:s=this.parentWidth,$e(this.layout)&&(this.innerText.style.wordWrap=!0,this.innerText.style.wordWrapWidth=t-f-g);break}else s=Se(n,this.parentWidth);if(this.fitInnerText(s),o==="auto")switch(this.autoSizeModificator){case"innerText":r=((_=this.innerText)==null?void 0:_.height)+x+m;break;case"background":r=p.height;break;case"parentSize":case"contentSize":default:let T=0;this.layout.content.resize(this.parentWidth,this.parentHeight);const{firstChild:b}=this.layout.content;b instanceof pt?b.style.position||(T+=b.height):b instanceof et&&b.height&&(T+=b.height),this.layout.content.children.forEach(S=>{S!==b&&(S instanceof pt&&S.style.position||(S instanceof pt&&S.style.display==="block"?T+=S.height:S.height>T&&(T=S.height)))}),$e(this.layout)&&(r=(v=this.innerText)==null?void 0:v.height),r=T+m+x;break}else r=Se(o,this.parentHeight);if(this.layout.parent instanceof pt){const{paddingLeft:T,paddingRight:b}=(w=this.layout.parent)==null?void 0:w.style,S=T??0,A=b??0;this.autoSizeModificator!=="innerText"&&(s-=S),s-=A,this.fitInnerText(s),$e(this.layout)&&o==="auto"&&(r=((E=this.innerText)==null?void 0:E.height)+x+m)}if(s<0&&(s=0),r<0&&(r=0),s===0||r===0){this.layout.visible=!1;return}this._width=Se(s,this.parentWidth),this._height=Se(r,this.parentHeight),this.layout.scale.set(d,u),(a||h||l||c)&&this.fitToSize(this.parentWidth,this.parentHeight),this.layout.updateBG(),this.layout.updateMask(),this.layout.align.update(this.parentWidth,this.parentHeight)}fitInnerText(t){if(!$e(this.layout))return;const{paddingLeft:e,paddingRight:s}=this.layout.style;this.innerText.style.wordWrap=!0,this.innerText.style.wordWrapWidth=t-s-e}get autoSizeModificator(){const{background:t,display:e}=this.layout.style;return e==="block"?"parentSize":$e(this.layout)?"innerText":t instanceof et?"background":"contentSize"}get innerText(){if(!$e(this.layout))return null;const{firstChild:t}=this.layout.content;return t}get width(){return this._width}set width(t){this._width=Se(t,this.parentWidth),this.layout.align.update(this.parentWidth,this.parentHeight)}get height(){return this._height}set height(t){this._height=Se(t,this.parentHeight),this.layout.align.update(this.parentWidth,this.parentHeight)}fitToSize(t,e){const{maxWidth:s,maxHeight:r,minWidth:n,minHeight:o}=this.layout.style,{marginLeft:a,marginRight:h,marginBottom:l,marginTop:c}=this.layout.style,d=this.layout.scale.x,u=this.layout.scale.y,p=this.layout.width+a+h,f=this.layout.height+c+l,g=Se(s,t),m=Se(r,e),x=Se(n,t),y=Se(o,e),_=x/p,v=y/f,w=g/p,E=m/f;let T=d,b=u;p*d>g&&(T=w),f*u>m&&(b=E);let S=Math.min(T,b);if(n||o){let A=S;p*S<x&&(A=_),f*S<y&&(A=v),S=Math.max(A,A)}this.layout.scale.set(S)}}class pt extends et{constructor(t){if(super(),this.id=t.id,t.globalStyles){const e=t.globalStyles[this.id];e&&t.styles?t.styles={...e,...t.styles}:e&&(t.styles=e)}this._style=new Tp(this,t.styles),this.size=new Sp(this),this.align=new wp(this),this.content=new Ep(this,t.content,t.globalStyles)}resize(t,e){this.size.update(t,e)}updateBG(){const{background:t}=this.style;if(t instanceof et)t instanceof H&&t.anchor.set(0),this.bg=t,this.addChildAt(this.bg,0);else{const e=t!=="transparent"&&Vl(t),{borderRadius:s}=this.style,{width:r,height:n}=this;if(e&&r&&n){this.bg||(this.bg=new ve,this.addChildAt(this.bg,0));let o=0,a=0;const{anchorX:h,anchorY:l}=this.style;h!==void 0&&(o-=r*h),l!==void 0&&(a-=n*l),this.bg instanceof ve&&this.bg.clear().beginFill(e.hex,e.opacity).drawRoundedRect(o,a,r,n,s)}else this.bg&&(this.removeChild(this.bg),delete this.bg)}}updateMask(){const{overflow:t,borderRadius:e}=this.style,{width:s,height:r}=this;if(t==="hidden"&&s&&r){this.overflowMask||(this.overflowMask=new ve,this.addChild(this.overflowMask));let n=0,o=0;const{anchorX:a,anchorY:h}=this.style;a!==void 0&&(n-=s*a),h!==void 0&&(o-=r*h),this.overflowMask.clear().beginFill(16777215).drawRoundedRect(n,o,s,r,e).endFill(),this.mask=this.overflowMask}else this.mask=null,delete this.overflowMask}get contentWidth(){return super.width}get contentHeight(){return super.height}set width(t){this.size.width=t}get width(){return this.size.width}set height(t){this.size.height=t}get height(){return this.size.height}addContent(t){this.content.createContent(t),this.update()}removeChildByID(t){this.content.removeContent(t),this.update()}getChildByID(t){return this.content.getByID(t)}update(){this.getRootLayout().size.update()}getRootLayout(){return this.parent&&this.parent instanceof pt?this.parent.getRootLayout():this}setStyles(t){this._style.set(t),this.update()}get textStyle(){return this._style.textStyle}get style(){return this._style.getAll()}}class Ep{constructor(t,e,s){this.children=new Map,this.layout=t,this.children=new Map,this.createContent(e,s)}createContent(t,e){if(!t)return;const s=this.getContentType(t),r=this.newID;switch(s){case"layout":const n=t;this.addContentElement(n.id,n);break;case"container":this.addContentElement(`container-${r}`,t);break;case"string":const o=new Vt(t,this.layout.textStyle);this.addContentElement(`text-${r}`,o);break;case"text":const a=t;a.style=this.layout.textStyle,this.addContentElement(`text-${r}`,a);break;case"layoutConfig":const h=t;e&&(h.globalStyles?h.globalStyles={...e,...h.globalStyles}:h.globalStyles={...e}),h.id||(h.id=`layout-${r}`),this.addContentElement(h.id,new pt(h));break;case"object":const l=t;for(const d in l){const u=d,p=t[u],f=this.getContentType(p);let g=this.layout.textStyle;switch(f){case"string":e&&e[u]&&(g={...g,...Ao(e[u])});const m=new Vt(p,g);this.addContentElement(u,m);break;case"text":const x=p;e&&e[u]&&(g={...g,...Ao(e[u])}),x.style=g,this.addContentElement(u,x);break;case"layout":const y=p;e&&e[u]&&(y.setStyles(e[u]),y.update()),this.createContent(y);break;case"container":this.addContentElement(u,p);break;case"layoutConfig":this.createContent({...p,globalStyles:e,id:u});break;case"object":this.createContent(p,e);break;case"array":this.createContent(p,e);break}}break;case"array":t.forEach(d=>this.createContent(d,e));break;default:throw new Error("Unknown content type of the layout.")}}addContentElement(t,e){t&&this.children.has(t)&&console.error(`Element with '${t}' duplicates, be careful using id selectors with it.`),this.children.set(t,e),this.layout.addChild(e)}get firstChild(){return this.children.get(this.children.keys().next().value)}resize(t,e){this.children.forEach(s=>{s instanceof pt&&s.resize(t,e)})}get newID(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}getByID(t){let e=this.children.get(t);return e||this.children.forEach(s=>{if(s instanceof pt){const r=s.content.getByID(t);r&&(e=r)}}),e}getContentType(t){return typeof t=="string"?"string":t instanceof pt?"layout":t instanceof Vt?"text":t instanceof H||t instanceof ve||t instanceof et?"container":Array.isArray(t)?"array":typeof t=="object"?t!=null&&t.content?"layoutConfig":"object":"unknown"}removeContent(t){const e=this.getByID(t);e&&(this.layout.removeChild(e),this.children.delete(t))}}const J={loadingScreen:{loading:"LOADING",poweredBy:"POWERED BY"},titleScreen:{levels:"LEVELS",settings:{title:"SETTINGS",save:"SAVE",GFX:"GFX",low:"LOW",medium:"MEDIUM",high:"HIGH",BGM:"BGM",SFX:"SFX",GPU:"GPU",antiAliasing:"ANTI-ALIASING",subtitles:"SUBTITLES",cutScenes:"CUT SCENES"},info:{title:"INFO",accept:"ACCEPT",decline:"DECLINE"},menu:{title:"MENU",items:{levels:"LEVELS",replay:"REPLAY",settings:"SETTINGS",exit:"EXIT"}},iconsMenu:{home:"HOME",info:"INFO",settings:"SETTINGS",play:"PLAY"}},gameScreen:{level:"LEVEL",tutorial:{hello:"Hello"}}},zl=()=>({content:{poweredText:{content:J.loadingScreen.poweredBy,styles:{position:"leftTop",color:"white",fontSize:22}},pixiLogo:{content:H.from("pixi-logo"),styles:{position:"leftBottom",scale:.9}}},styles:{position:"leftBottom",margin:10,maxWidth:"25%",maxHeight:"5%",height:84}});class Ap extends pt{constructor(){super({id:"gameBackground",content:{bg:{content:H.from("bg"),styles:{position:"center",maxHeight:"100%",minWidth:"100%"}},pixiLogo:zl()},styles:{width:"100%",height:"100%"}})}}class Cp{constructor(){ot(this,"currentScreen");ot(this,"currentScreenResize");ot(this,"loadScreen");ot(this,"_w");ot(this,"_h");ot(this,"bg")}setLoadScreen(t){this.loadScreen=new t}addBG(){this.bg=new Ap,this.bg.resize(this._w,this._h),Ve.stage.addChild(this.bg)}async addScreen(t){Ve.stage.addChild(t),t.resize&&(this.currentScreenResize=()=>t.resize,t.resize(this._w,this._h)),t.onUpdate&&Ve.ticker.add(t.onUpdate,t),t.show&&await t.show()}async removeScreen(t){t.hide&&await t.hide(),this.currentScreenResize&&window.removeEventListener("resize",this.currentScreenResize),t.onUpdate&&Ve.ticker.remove(t.onUpdate,t),t.parent&&t.parent.removeChild(t)}async showScreen(t,e){this.currentScreen&&(await this.removeScreen(this.currentScreen),this.currentScreen.destroy()),t.assetBundles&&!ap(t.assetBundles)&&(this.loadScreen&&this.addScreen(this.loadScreen),await Ge.loadBundle(t.assetBundles),this.loadScreen&&this.removeScreen(this.loadScreen)),this.currentScreen=new t(e),await this.addScreen(this.currentScreen)}resize(t,e){var s,r,n;this._w=t,this._h=e,(r=(s=this.currentScreen)==null?void 0:s.resize)==null||r.call(s,t,e),(n=this.bg)==null||n.resize(t,e)}}const Re=new Cp;function Fe(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Hl(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.__proto__=t}/*!
 * GSAP 3.11.5
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var te={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},es={duration:.5,overwrite:!1,delay:0},ea,Ot,vt,oe=1e8,st=1/oe,Co=Math.PI*2,Ip=Co/4,Rp=0,Wl=Math.sqrt,Pp=Math.cos,Mp=Math.sin,Rt=function(t){return typeof t=="string"},gt=function(t){return typeof t=="function"},He=function(t){return typeof t=="number"},ia=function(t){return typeof t>"u"},Be=function(t){return typeof t=="object"},Wt=function(t){return t!==!1},sa=function(){return typeof window<"u"},pr=function(t){return gt(t)||Rt(t)},Xl=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Ft=Array.isArray,Io=/(?:-?\.?\d|\.)+/gi,$l=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Vi=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Wn=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,jl=/[+-]=-?[.\d]+/,Yl=/[^,'"\[\]\s]+/gi,kp=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ct,se,Ro,ra,ee={},Fr={},ql,Kl=function(t){return(Fr=Ri(t,ee))&&jt},na=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Nr=function(t,e){return!e&&console.warn(t)},Zl=function(t,e){return t&&(ee[t]=e)&&Fr&&(Fr[t]=e)||ee},Gs=function(){return 0},Bp={suppressEvents:!0,isStart:!0,kill:!1},br={suppressEvents:!0,kill:!1},Lp={suppressEvents:!0},oa={},Qe=[],Po={},Jl,Kt={},Xn={},vh=30,wr=[],aa="",ha=function(t){var e=t[0],s,r;if(Be(e)||gt(e)||(t=[t]),!(s=(e._gsap||{}).harness)){for(r=wr.length;r--&&!wr[r].targetTest(e););s=wr[r]}for(r=t.length;r--;)t[r]&&(t[r]._gsap||(t[r]._gsap=new wc(t[r],s)))||t.splice(r,1);return t},wi=function(t){return t._gsap||ha(ae(t))[0]._gsap},Ql=function(t,e,s){return(s=t[e])&&gt(s)?t[e]():ia(s)&&t.getAttribute&&t.getAttribute(e)||s},Xt=function(t,e){return(t=t.split(",")).forEach(e)||t},mt=function(t){return Math.round(t*1e5)/1e5||0},Mt=function(t){return Math.round(t*1e7)/1e7||0},qi=function(t,e){var s=e.charAt(0),r=parseFloat(e.substr(2));return t=parseFloat(t),s==="+"?t+r:s==="-"?t-r:s==="*"?t*r:t/r},Op=function(t,e){for(var s=e.length,r=0;t.indexOf(e[r])<0&&++r<s;);return r<s},Dr=function(){var t=Qe.length,e=Qe.slice(0),s,r;for(Po={},Qe.length=0,s=0;s<t;s++)r=e[s],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},tc=function(t,e,s,r){Qe.length&&!Ot&&Dr(),t.render(e,s,r||Ot&&e<0&&(t._initted||t._startAt)),Qe.length&&!Ot&&Dr()},ec=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(Yl).length<2?e:Rt(t)?t.trim():t},ic=function(t){return t},le=function(t,e){for(var s in e)s in t||(t[s]=e[s]);return t},Fp=function(t){return function(e,s){for(var r in s)r in e||r==="duration"&&t||r==="ease"||(e[r]=s[r])}},Ri=function(t,e){for(var s in e)t[s]=e[s];return t},bh=function i(t,e){for(var s in e)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(t[s]=Be(e[s])?i(t[s]||(t[s]={}),e[s]):e[s]);return t},Ur=function(t,e){var s={},r;for(r in t)r in e||(s[r]=t[r]);return s},Cs=function(t){var e=t.parent||ct,s=t.keyframes?Fp(Ft(t.keyframes)):le;if(Wt(t.inherit))for(;e;)s(t,e.vars.defaults),e=e.parent||e._dp;return t},Np=function(t,e){for(var s=t.length,r=s===e.length;r&&s--&&t[s]===e[s];);return s<0},sc=function(t,e,s,r,n){s===void 0&&(s="_first"),r===void 0&&(r="_last");var o=t[r],a;if(n)for(a=e[n];o&&o[n]>a;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[s],t[s]=e),e._next?e._next._prev=e:t[r]=e,e._prev=o,e.parent=e._dp=t,e},rn=function(t,e,s,r){s===void 0&&(s="_first"),r===void 0&&(r="_last");var n=e._prev,o=e._next;n?n._next=o:t[s]===e&&(t[s]=o),o?o._prev=n:t[r]===e&&(t[r]=n),e._next=e._prev=e.parent=null},si=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},Ti=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var s=t;s;)s._dirty=1,s=s.parent;return t},Dp=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},Mo=function(t,e,s,r){return t._startAt&&(Ot?t._startAt.revert(br):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,r))},Up=function i(t){return!t||t._ts&&i(t.parent)},wh=function(t){return t._repeat?is(t._tTime,t=t.duration()+t._rDelay)*t:0},is=function(t,e){var s=Math.floor(t/=e);return t&&s===t?s-1:s},Gr=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},nn=function(t){return t._end=Mt(t._start+(t._tDur/Math.abs(t._ts||t._rts||st)||0))},on=function(t,e){var s=t._dp;return s&&s.smoothChildTiming&&t._ts&&(t._start=Mt(s._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),nn(t),s._dirty||Ti(s,t)),t},rc=function(t,e){var s;if((e._time||e._initted&&!e._dur)&&(s=Gr(t.rawTime(),e),(!e._dur||Zs(0,e.totalDuration(),s)-e._tTime>st)&&e.render(s,!0)),Ti(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(s=t;s._dp;)s.rawTime()>=0&&s.totalTime(s._tTime),s=s._dp;t._zTime=-st}},Ie=function(t,e,s,r){return e.parent&&si(e),e._start=Mt((He(s)?s:s||t!==ct?ie(t,s,e):t._time)+e._delay),e._end=Mt(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),sc(t,e,"_first","_last",t._sort?"_start":0),ko(e)||(t._recent=e),r||rc(t,e),t._ts<0&&on(t,t._tTime),t},nc=function(t,e){return(ee.ScrollTrigger||na("scrollTrigger",e))&&ee.ScrollTrigger.create(e,t)},oc=function(t,e,s,r,n){if(ca(t,e,n),!t._initted)return 1;if(!s&&t._pt&&!Ot&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&Jl!==Zt.frame)return Qe.push(t),t._lazy=[n,r],1},Gp=function i(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||i(e))},ko=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},Vp=function(t,e,s,r){var n=t.ratio,o=e<0||!e&&(!t._start&&Gp(t)&&!(!t._initted&&ko(t))||(t._ts<0||t._dp._ts<0)&&!ko(t))?0:1,a=t._rDelay,h=0,l,c,d;if(a&&t._repeat&&(h=Zs(0,t._tDur,e),c=is(h,a),t._yoyo&&c&1&&(o=1-o),c!==is(t._tTime,a)&&(n=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),o!==n||Ot||r||t._zTime===st||!e&&t._zTime){if(!t._initted&&oc(t,e,r,s,h))return;for(d=t._zTime,t._zTime=e||(s?st:0),s||(s=e&&!d),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=h,l=t._pt;l;)l.r(o,l.d),l=l._next;e<0&&Mo(t,e,s,!0),t._onUpdate&&!s&&he(t,"onUpdate"),h&&t._repeat&&!s&&t.parent&&he(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===o&&(o&&si(t,1),!s&&!Ot&&(he(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},zp=function(t,e,s){var r;if(s>e)for(r=t._first;r&&r._start<=s;){if(r.data==="isPause"&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=s;){if(r.data==="isPause"&&r._start<e)return r;r=r._prev}},ss=function(t,e,s,r){var n=t._repeat,o=Mt(e)||0,a=t._tTime/t._tDur;return a&&!r&&(t._time*=o/t._dur),t._dur=o,t._tDur=n?n<0?1e10:Mt(o*(n+1)+t._rDelay*n):o,a>0&&!r&&on(t,t._tTime=t._tDur*a),t.parent&&nn(t),s||Ti(t.parent,t),t},Th=function(t){return t instanceof Ht?Ti(t):ss(t,t._dur)},Hp={_start:0,endTime:Gs,totalDuration:Gs},ie=function i(t,e,s){var r=t.labels,n=t._recent||Hp,o=t.duration()>=oe?n.endTime(!1):t._dur,a,h,l;return Rt(e)&&(isNaN(e)||e in r)?(h=e.charAt(0),l=e.substr(-1)==="%",a=e.indexOf("="),h==="<"||h===">"?(a>=0&&(e=e.replace(/=/,"")),(h==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(e.substr(1))||0)*(l?(a<0?n:s).totalDuration()/100:1)):a<0?(e in r||(r[e]=o),r[e]):(h=parseFloat(e.charAt(a-1)+e.substr(a+1)),l&&s&&(h=h/100*(Ft(s)?s[0]:s).totalDuration()),a>1?i(t,e.substr(0,a-1),s)+h:o+h)):e==null?o:+e},Is=function(t,e,s){var r=He(e[1]),n=(r?2:1)+(t<2?0:1),o=e[n],a,h;if(r&&(o.duration=e[1]),o.parent=s,t){for(a=o,h=s;h&&!("immediateRender"in a);)a=h.vars.defaults||{},h=Wt(h.vars.inherit)&&h.parent;o.immediateRender=Wt(a.immediateRender),t<2?o.runBackwards=1:o.startAt=e[n-1]}return new Tt(e[0],o,e[n+1])},oi=function(t,e){return t||t===0?e(t):e},Zs=function(t,e,s){return s<t?t:s>e?e:s},Lt=function(t,e){return!Rt(t)||!(e=kp.exec(t))?"":e[1]},Wp=function(t,e,s){return oi(s,function(r){return Zs(t,e,r)})},Bo=[].slice,ac=function(t,e){return t&&Be(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&Be(t[0]))&&!t.nodeType&&t!==se},Xp=function(t,e,s){return s===void 0&&(s=[]),t.forEach(function(r){var n;return Rt(r)&&!e||ac(r,1)?(n=s).push.apply(n,ae(r)):s.push(r)})||s},ae=function(t,e,s){return vt&&!e&&vt.selector?vt.selector(t):Rt(t)&&!s&&(Ro||!rs())?Bo.call((e||ra).querySelectorAll(t),0):Ft(t)?Xp(t,s):ac(t)?Bo.call(t,0):t?[t]:[]},Lo=function(t){return t=ae(t)[0]||Nr("Invalid scope")||{},function(e){var s=t.current||t.nativeElement||t;return ae(e,s.querySelectorAll?s:s===t?Nr("Invalid scope")||ra.createElement("div"):t)}},hc=function(t){return t.sort(function(){return .5-Math.random()})},lc=function(t){if(gt(t))return t;var e=Be(t)?t:{each:t},s=Si(e.ease),r=e.from||0,n=parseFloat(e.base)||0,o={},a=r>0&&r<1,h=isNaN(r)||a,l=e.axis,c=r,d=r;return Rt(r)?c=d={center:.5,edges:.5,end:1}[r]||0:!a&&h&&(c=r[0],d=r[1]),function(u,p,f){var g=(f||e).length,m=o[g],x,y,_,v,w,E,T,b,S;if(!m){if(S=e.grid==="auto"?0:(e.grid||[1,oe])[1],!S){for(T=-oe;T<(T=f[S++].getBoundingClientRect().left)&&S<g;);S--}for(m=o[g]=[],x=h?Math.min(S,g)*c-.5:r%S,y=S===oe?0:h?g*d/S-.5:r/S|0,T=0,b=oe,E=0;E<g;E++)_=E%S-x,v=y-(E/S|0),m[E]=w=l?Math.abs(l==="y"?v:_):Wl(_*_+v*v),w>T&&(T=w),w<b&&(b=w);r==="random"&&hc(m),m.max=T-b,m.min=b,m.v=g=(parseFloat(e.amount)||parseFloat(e.each)*(S>g?g-1:l?l==="y"?g/S:S:Math.max(S,g/S))||0)*(r==="edges"?-1:1),m.b=g<0?n-g:n,m.u=Lt(e.amount||e.each)||0,s=s&&g<0?xc(s):s}return g=(m[u]-m.min)/m.max||0,Mt(m.b+(s?s(g):g)*m.v)+m.u}},Oo=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(s){var r=Mt(Math.round(parseFloat(s)/t)*t*e);return(r-r%1)/e+(He(s)?0:Lt(s))}},cc=function(t,e){var s=Ft(t),r,n;return!s&&Be(t)&&(r=s=t.radius||oe,t.values?(t=ae(t.values),(n=!He(t[0]))&&(r*=r)):t=Oo(t.increment)),oi(e,s?gt(t)?function(o){return n=t(o),Math.abs(n-o)<=r?n:o}:function(o){for(var a=parseFloat(n?o.x:o),h=parseFloat(n?o.y:0),l=oe,c=0,d=t.length,u,p;d--;)n?(u=t[d].x-a,p=t[d].y-h,u=u*u+p*p):u=Math.abs(t[d]-a),u<l&&(l=u,c=d);return c=!r||l<=r?t[c]:o,n||c===o||He(o)?c:c+Lt(o)}:Oo(t))},uc=function(t,e,s,r){return oi(Ft(t)?!e:s===!0?!!(s=0):!r,function(){return Ft(t)?t[~~(Math.random()*t.length)]:(s=s||1e-5)&&(r=s<1?Math.pow(10,(s+"").length-2):1)&&Math.floor(Math.round((t-s/2+Math.random()*(e-t+s*.99))/s)*s*r)/r})},$p=function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return function(r){return e.reduce(function(n,o){return o(n)},r)}},jp=function(t,e){return function(s){return t(parseFloat(s))+(e||Lt(s))}},Yp=function(t,e,s){return fc(t,e,0,1,s)},dc=function(t,e,s){return oi(s,function(r){return t[~~e(r)]})},qp=function i(t,e,s){var r=e-t;return Ft(t)?dc(t,i(0,t.length),e):oi(s,function(n){return(r+(n-t)%r)%r+t})},Kp=function i(t,e,s){var r=e-t,n=r*2;return Ft(t)?dc(t,i(0,t.length-1),e):oi(s,function(o){return o=(n+(o-t)%n)%n||0,t+(o>r?n-o:o)})},Vs=function(t){for(var e=0,s="",r,n,o,a;~(r=t.indexOf("random(",e));)o=t.indexOf(")",r),a=t.charAt(r+7)==="[",n=t.substr(r+7,o-r-7).match(a?Yl:Io),s+=t.substr(e,r-e)+uc(a?n:+n[0],a?0:+n[1],+n[2]||1e-5),e=o+1;return s+t.substr(e,t.length-e)},fc=function(t,e,s,r,n){var o=e-t,a=r-s;return oi(n,function(h){return s+((h-t)/o*a||0)})},Zp=function i(t,e,s,r){var n=isNaN(t+e)?0:function(p){return(1-p)*t+p*e};if(!n){var o=Rt(t),a={},h,l,c,d,u;if(s===!0&&(r=1)&&(s=null),o)t={p:t},e={p:e};else if(Ft(t)&&!Ft(e)){for(c=[],d=t.length,u=d-2,l=1;l<d;l++)c.push(i(t[l-1],t[l]));d--,n=function(f){f*=d;var g=Math.min(u,~~f);return c[g](f-g)},s=e}else r||(t=Ri(Ft(t)?[]:{},t));if(!c){for(h in e)la.call(a,t,h,"get",e[h]);n=function(f){return fa(f,a)||(o?t.p:t)}}}return oi(s,n)},Sh=function(t,e,s){var r=t.labels,n=oe,o,a,h;for(o in r)a=r[o]-e,a<0==!!s&&a&&n>(a=Math.abs(a))&&(h=o,n=a);return h},he=function(t,e,s){var r=t.vars,n=r[e],o=vt,a=t._ctx,h,l,c;if(n)return h=r[e+"Params"],l=r.callbackScope||t,s&&Qe.length&&Dr(),a&&(vt=a),c=h?n.apply(l,h):n.call(l),vt=o,c},ws=function(t){return si(t),t.scrollTrigger&&t.scrollTrigger.kill(!!Ot),t.progress()<1&&he(t,"onInterrupt"),t},zi,pc=[],gc=function(t){if(!sa()){pc.push(t);return}t=!t.name&&t.default||t;var e=t.name,s=gt(t),r=e&&!s&&t.init?function(){this._props=[]}:t,n={init:Gs,render:fa,add:la,kill:fg,modifier:dg,rawVars:0},o={targetTest:0,get:0,getSetter:da,aliases:{},register:0};if(rs(),t!==r){if(Kt[e])return;le(r,le(Ur(t,n),o)),Ri(r.prototype,Ri(n,Ur(t,o))),Kt[r.prop=e]=r,t.targetTest&&(wr.push(r),oa[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Zl(e,r),t.register&&t.register(jt,r,$t)},it=255,Ts={aqua:[0,it,it],lime:[0,it,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,it],navy:[0,0,128],white:[it,it,it],olive:[128,128,0],yellow:[it,it,0],orange:[it,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[it,0,0],pink:[it,192,203],cyan:[0,it,it],transparent:[it,it,it,0]},$n=function(t,e,s){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(s-e)*t*6:t<.5?s:t*3<2?e+(s-e)*(2/3-t)*6:e)*it+.5|0},mc=function(t,e,s){var r=t?He(t)?[t>>16,t>>8&it,t&it]:0:Ts.black,n,o,a,h,l,c,d,u,p,f;if(!r){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),Ts[t])r=Ts[t];else if(t.charAt(0)==="#"){if(t.length<6&&(n=t.charAt(1),o=t.charAt(2),a=t.charAt(3),t="#"+n+n+o+o+a+a+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return r=parseInt(t.substr(1,6),16),[r>>16,r>>8&it,r&it,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),r=[t>>16,t>>8&it,t&it]}else if(t.substr(0,3)==="hsl"){if(r=f=t.match(Io),!e)h=+r[0]%360/360,l=+r[1]/100,c=+r[2]/100,o=c<=.5?c*(l+1):c+l-c*l,n=c*2-o,r.length>3&&(r[3]*=1),r[0]=$n(h+1/3,n,o),r[1]=$n(h,n,o),r[2]=$n(h-1/3,n,o);else if(~t.indexOf("="))return r=t.match($l),s&&r.length<4&&(r[3]=1),r}else r=t.match(Io)||Ts.transparent;r=r.map(Number)}return e&&!f&&(n=r[0]/it,o=r[1]/it,a=r[2]/it,d=Math.max(n,o,a),u=Math.min(n,o,a),c=(d+u)/2,d===u?h=l=0:(p=d-u,l=c>.5?p/(2-d-u):p/(d+u),h=d===n?(o-a)/p+(o<a?6:0):d===o?(a-n)/p+2:(n-o)/p+4,h*=60),r[0]=~~(h+.5),r[1]=~~(l*100+.5),r[2]=~~(c*100+.5)),s&&r.length<4&&(r[3]=1),r},_c=function(t){var e=[],s=[],r=-1;return t.split(ti).forEach(function(n){var o=n.match(Vi)||[];e.push.apply(e,o),s.push(r+=o.length+1)}),e.c=s,e},Eh=function(t,e,s){var r="",n=(t+r).match(ti),o=e?"hsla(":"rgba(",a=0,h,l,c,d;if(!n)return t;if(n=n.map(function(u){return(u=mc(u,e,1))&&o+(e?u[0]+","+u[1]+"%,"+u[2]+"%,"+u[3]:u.join(","))+")"}),s&&(c=_c(t),h=s.c,h.join(r)!==c.c.join(r)))for(l=t.replace(ti,"1").split(Vi),d=l.length-1;a<d;a++)r+=l[a]+(~h.indexOf(a)?n.shift()||o+"0,0,0,0)":(c.length?c:n.length?n:s).shift());if(!l)for(l=t.split(ti),d=l.length-1;a<d;a++)r+=l[a]+n[a];return r+l[d]},ti=function(){var i="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in Ts)i+="|"+t+"\\b";return new RegExp(i+")","gi")}(),Jp=/hsl[a]?\(/,yc=function(t){var e=t.join(" "),s;if(ti.lastIndex=0,ti.test(e))return s=Jp.test(e),t[1]=Eh(t[1],s),t[0]=Eh(t[0],s,_c(t[1])),!0},zs,Zt=function(){var i=Date.now,t=500,e=33,s=i(),r=s,n=1e3/240,o=n,a=[],h,l,c,d,u,p,f=function g(m){var x=i()-r,y=m===!0,_,v,w,E;if(x>t&&(s+=x-e),r+=x,w=r-s,_=w-o,(_>0||y)&&(E=++d.frame,u=w-d.time*1e3,d.time=w=w/1e3,o+=_+(_>=n?4:n-_),v=1),y||(h=l(g)),v)for(p=0;p<a.length;p++)a[p](w,u,E,m)};return d={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(m){return u/(1e3/(m||60))},wake:function(){ql&&(!Ro&&sa()&&(se=Ro=window,ra=se.document||{},ee.gsap=jt,(se.gsapVersions||(se.gsapVersions=[])).push(jt.version),Kl(Fr||se.GreenSockGlobals||!se.gsap&&se||{}),c=se.requestAnimationFrame,pc.forEach(gc)),h&&d.sleep(),l=c||function(m){return setTimeout(m,o-d.time*1e3+1|0)},zs=1,f(2))},sleep:function(){(c?se.cancelAnimationFrame:clearTimeout)(h),zs=0,l=Gs},lagSmoothing:function(m,x){t=m||1/0,e=Math.min(x||33,t)},fps:function(m){n=1e3/(m||240),o=d.time*1e3+n},add:function(m,x,y){var _=x?function(v,w,E,T){m(v,w,E,T),d.remove(_)}:m;return d.remove(m),a[y?"unshift":"push"](_),rs(),_},remove:function(m,x){~(x=a.indexOf(m))&&a.splice(x,1)&&p>=x&&p--},_listeners:a},d}(),rs=function(){return!zs&&Zt.wake()},X={},Qp=/^[\d.\-M][\d.\-,\s]/,tg=/["']/g,eg=function(t){for(var e={},s=t.substr(1,t.length-3).split(":"),r=s[0],n=1,o=s.length,a,h,l;n<o;n++)h=s[n],a=n!==o-1?h.lastIndexOf(","):h.length,l=h.substr(0,a),e[r]=isNaN(l)?l.replace(tg,"").trim():+l,r=h.substr(a+1).trim();return e},ig=function(t){var e=t.indexOf("(")+1,s=t.indexOf(")"),r=t.indexOf("(",e);return t.substring(e,~r&&r<s?t.indexOf(")",s+1):s)},sg=function(t){var e=(t+"").split("("),s=X[e[0]];return s&&e.length>1&&s.config?s.config.apply(null,~t.indexOf("{")?[eg(e[1])]:ig(t).split(",").map(ec)):X._CE&&Qp.test(t)?X._CE("",t):s},xc=function(t){return function(e){return 1-t(1-e)}},vc=function i(t,e){for(var s=t._first,r;s;)s instanceof Ht?i(s,e):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==e&&(s.timeline?i(s.timeline,e):(r=s._ease,s._ease=s._yEase,s._yEase=r,s._yoyo=e)),s=s._next},Si=function(t,e){return t&&(gt(t)?t:X[t]||sg(t))||e},Mi=function(t,e,s,r){s===void 0&&(s=function(h){return 1-e(1-h)}),r===void 0&&(r=function(h){return h<.5?e(h*2)/2:1-e((1-h)*2)/2});var n={easeIn:e,easeOut:s,easeInOut:r},o;return Xt(t,function(a){X[a]=ee[a]=n,X[o=a.toLowerCase()]=s;for(var h in n)X[o+(h==="easeIn"?".in":h==="easeOut"?".out":".inOut")]=X[a+"."+h]=n[h]}),n},bc=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},jn=function i(t,e,s){var r=e>=1?e:1,n=(s||(t?.3:.45))/(e<1?e:1),o=n/Co*(Math.asin(1/r)||0),a=function(c){return c===1?1:r*Math.pow(2,-10*c)*Mp((c-o)*n)+1},h=t==="out"?a:t==="in"?function(l){return 1-a(1-l)}:bc(a);return n=Co/n,h.config=function(l,c){return i(t,l,c)},h},Yn=function i(t,e){e===void 0&&(e=1.70158);var s=function(o){return o?--o*o*((e+1)*o+e)+1:0},r=t==="out"?s:t==="in"?function(n){return 1-s(1-n)}:bc(s);return r.config=function(n){return i(t,n)},r};Xt("Linear,Quad,Cubic,Quart,Quint,Strong",function(i,t){var e=t<5?t+1:t;Mi(i+",Power"+(e-1),t?function(s){return Math.pow(s,e)}:function(s){return s},function(s){return 1-Math.pow(1-s,e)},function(s){return s<.5?Math.pow(s*2,e)/2:1-Math.pow((1-s)*2,e)/2})});X.Linear.easeNone=X.none=X.Linear.easeIn;Mi("Elastic",jn("in"),jn("out"),jn());(function(i,t){var e=1/t,s=2*e,r=2.5*e,n=function(a){return a<e?i*a*a:a<s?i*Math.pow(a-1.5/t,2)+.75:a<r?i*(a-=2.25/t)*a+.9375:i*Math.pow(a-2.625/t,2)+.984375};Mi("Bounce",function(o){return 1-n(1-o)},n)})(7.5625,2.75);Mi("Expo",function(i){return i?Math.pow(2,10*(i-1)):0});Mi("Circ",function(i){return-(Wl(1-i*i)-1)});Mi("Sine",function(i){return i===1?1:-Pp(i*Ip)+1});Mi("Back",Yn("in"),Yn("out"),Yn());X.SteppedEase=X.steps=ee.SteppedEase={config:function(t,e){t===void 0&&(t=1);var s=1/t,r=t+(e?0:1),n=e?1:0,o=1-st;return function(a){return((r*Zs(0,o,a)|0)+n)*s}}};es.ease=X["quad.out"];Xt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(i){return aa+=i+","+i+"Params,"});var wc=function(t,e){this.id=Rp++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:Ql,this.set=e?e.getSetter:da},ns=function(){function i(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,ss(this,+e.duration,1,1),this.data=e.data,vt&&(this._ctx=vt,vt.data.push(this)),zs||Zt.wake()}var t=i.prototype;return t.delay=function(s){return s||s===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+s-this._delay),this._delay=s,this):this._delay},t.duration=function(s){return arguments.length?this.totalDuration(this._repeat>0?s+(s+this._rDelay)*this._repeat:s):this.totalDuration()&&this._dur},t.totalDuration=function(s){return arguments.length?(this._dirty=0,ss(this,this._repeat<0?s:(s-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(s,r){if(rs(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(on(this,s),!n._dp||n.parent||rc(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&s<this._tDur||this._ts<0&&s>0||!this._tDur&&!s)&&Ie(this._dp,this,this._start-this._delay)}return(this._tTime!==s||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===st||!s&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=s),tc(this,s,r)),this},t.time=function(s,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),s+wh(this))%(this._dur+this._rDelay)||(s?this._dur:0),r):this._time},t.totalProgress=function(s,r){return arguments.length?this.totalTime(this.totalDuration()*s,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(s,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-s:s)+wh(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(s,r){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(s-1)*n,r):this._repeat?is(this._tTime,n)+1:1},t.timeScale=function(s){if(!arguments.length)return this._rts===-st?0:this._rts;if(this._rts===s)return this;var r=this.parent&&this._ts?Gr(this.parent._time,this):this._tTime;return this._rts=+s||0,this._ts=this._ps||s===-st?0:this._rts,this.totalTime(Zs(-Math.abs(this._delay),this._tDur,r),!0),nn(this),Dp(this)},t.paused=function(s){return arguments.length?(this._ps!==s&&(this._ps=s,s?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(rs(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==st&&(this._tTime-=st)))),this):this._ps},t.startTime=function(s){if(arguments.length){this._start=s;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&Ie(r,this,s-this._delay),this}return this._start},t.endTime=function(s){return this._start+(Wt(s)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(s){var r=this.parent||this._dp;return r?s&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Gr(r.rawTime(s),this):this._tTime:this._tTime},t.revert=function(s){s===void 0&&(s=Lp);var r=Ot;return Ot=s,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(s),this.totalTime(-.01,s.suppressEvents)),this.data!=="nested"&&s.kill!==!1&&this.kill(),Ot=r,this},t.globalTime=function(s){for(var r=this,n=arguments.length?s:r.rawTime();r;)n=r._start+n/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(s):n},t.repeat=function(s){return arguments.length?(this._repeat=s===1/0?-2:s,Th(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(s){if(arguments.length){var r=this._time;return this._rDelay=s,Th(this),r?this.time(r):this}return this._rDelay},t.yoyo=function(s){return arguments.length?(this._yoyo=s,this):this._yoyo},t.seek=function(s,r){return this.totalTime(ie(this,s),Wt(r))},t.restart=function(s,r){return this.play().totalTime(s?-this._delay:0,Wt(r))},t.play=function(s,r){return s!=null&&this.seek(s,r),this.reversed(!1).paused(!1)},t.reverse=function(s,r){return s!=null&&this.seek(s||this.totalDuration(),r),this.reversed(!0).paused(!1)},t.pause=function(s,r){return s!=null&&this.seek(s,r),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(s){return arguments.length?(!!s!==this.reversed()&&this.timeScale(-this._rts||(s?-st:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-st,this},t.isActive=function(){var s=this.parent||this._dp,r=this._start,n;return!!(!s||this._ts&&this._initted&&s.isActive()&&(n=s.rawTime(!0))>=r&&n<this.endTime(!0)-st)},t.eventCallback=function(s,r,n){var o=this.vars;return arguments.length>1?(r?(o[s]=r,n&&(o[s+"Params"]=n),s==="onUpdate"&&(this._onUpdate=r)):delete o[s],this):o[s]},t.then=function(s){var r=this;return new Promise(function(n){var o=gt(s)?s:ic,a=function(){var l=r.then;r.then=null,gt(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=l),n(o),r.then=l};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},t.kill=function(){ws(this)},i}();le(ns.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-st,_prom:0,_ps:!1,_rts:1});var Ht=function(i){Hl(t,i);function t(s,r){var n;return s===void 0&&(s={}),n=i.call(this,s)||this,n.labels={},n.smoothChildTiming=!!s.smoothChildTiming,n.autoRemoveChildren=!!s.autoRemoveChildren,n._sort=Wt(s.sortChildren),ct&&Ie(s.parent||ct,Fe(n),r),s.reversed&&n.reverse(),s.paused&&n.paused(!0),s.scrollTrigger&&nc(Fe(n),s.scrollTrigger),n}var e=t.prototype;return e.to=function(r,n,o){return Is(0,arguments,this),this},e.from=function(r,n,o){return Is(1,arguments,this),this},e.fromTo=function(r,n,o,a){return Is(2,arguments,this),this},e.set=function(r,n,o){return n.duration=0,n.parent=this,Cs(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new Tt(r,n,ie(this,o),1),this},e.call=function(r,n,o){return Ie(this,Tt.delayedCall(0,r,n),o)},e.staggerTo=function(r,n,o,a,h,l,c){return o.duration=n,o.stagger=o.stagger||a,o.onComplete=l,o.onCompleteParams=c,o.parent=this,new Tt(r,o,ie(this,h)),this},e.staggerFrom=function(r,n,o,a,h,l,c){return o.runBackwards=1,Cs(o).immediateRender=Wt(o.immediateRender),this.staggerTo(r,n,o,a,h,l,c)},e.staggerFromTo=function(r,n,o,a,h,l,c,d){return a.startAt=o,Cs(a).immediateRender=Wt(a.immediateRender),this.staggerTo(r,n,a,h,l,c,d)},e.render=function(r,n,o){var a=this._time,h=this._dirty?this.totalDuration():this._tDur,l=this._dur,c=r<=0?0:Mt(r),d=this._zTime<0!=r<0&&(this._initted||!l),u,p,f,g,m,x,y,_,v,w,E,T;if(this!==ct&&c>h&&r>=0&&(c=h),c!==this._tTime||o||d){if(a!==this._time&&l&&(c+=this._time-a,r+=this._time-a),u=c,v=this._start,_=this._ts,x=!_,d&&(l||(a=this._zTime),(r||!n)&&(this._zTime=r)),this._repeat){if(E=this._yoyo,m=l+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(m*100+r,n,o);if(u=Mt(c%m),c===h?(g=this._repeat,u=l):(g=~~(c/m),g&&g===c/m&&(u=l,g--),u>l&&(u=l)),w=is(this._tTime,m),!a&&this._tTime&&w!==g&&this._tTime-w*m-this._dur<=0&&(w=g),E&&g&1&&(u=l-u,T=1),g!==w&&!this._lock){var b=E&&w&1,S=b===(E&&g&1);if(g<w&&(b=!b),a=b?0:l,this._lock=1,this.render(a||(T?0:Mt(g*m)),n,!l)._lock=0,this._tTime=c,!n&&this.parent&&he(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),a&&a!==this._time||x!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,h=this._tDur,S&&(this._lock=2,a=b?l:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!x)return this;vc(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(y=zp(this,Mt(a),Mt(u)),y&&(c-=u-(u=y._start))),this._tTime=c,this._time=u,this._act=!_,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&u&&!n&&!g&&(he(this,"onStart"),this._tTime!==c))return this;if(u>=a&&r>=0)for(p=this._first;p;){if(f=p._next,(p._act||u>=p._start)&&p._ts&&y!==p){if(p.parent!==this)return this.render(r,n,o);if(p.render(p._ts>0?(u-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(u-p._start)*p._ts,n,o),u!==this._time||!this._ts&&!x){y=0,f&&(c+=this._zTime=-st);break}}p=f}else{p=this._last;for(var A=r<0?r:u;p;){if(f=p._prev,(p._act||A<=p._end)&&p._ts&&y!==p){if(p.parent!==this)return this.render(r,n,o);if(p.render(p._ts>0?(A-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(A-p._start)*p._ts,n,o||Ot&&(p._initted||p._startAt)),u!==this._time||!this._ts&&!x){y=0,f&&(c+=this._zTime=A?-st:st);break}}p=f}}if(y&&!n&&(this.pause(),y.render(u>=a?0:-st)._zTime=u>=a?1:-1,this._ts))return this._start=v,nn(this),this.render(r,n,o);this._onUpdate&&!n&&he(this,"onUpdate",!0),(c===h&&this._tTime>=this.totalDuration()||!c&&a)&&(v===this._start||Math.abs(_)!==Math.abs(this._ts))&&(this._lock||((r||!l)&&(c===h&&this._ts>0||!c&&this._ts<0)&&si(this,1),!n&&!(r<0&&!a)&&(c||a||!h)&&(he(this,c===h&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(c<h&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(r,n){var o=this;if(He(n)||(n=ie(this,n,r)),!(r instanceof ns)){if(Ft(r))return r.forEach(function(a){return o.add(a,n)}),this;if(Rt(r))return this.addLabel(r,n);if(gt(r))r=Tt.delayedCall(0,r);else return this}return this!==r?Ie(this,r,n):this},e.getChildren=function(r,n,o,a){r===void 0&&(r=!0),n===void 0&&(n=!0),o===void 0&&(o=!0),a===void 0&&(a=-oe);for(var h=[],l=this._first;l;)l._start>=a&&(l instanceof Tt?n&&h.push(l):(o&&h.push(l),r&&h.push.apply(h,l.getChildren(!0,n,o)))),l=l._next;return h},e.getById=function(r){for(var n=this.getChildren(1,1,1),o=n.length;o--;)if(n[o].vars.id===r)return n[o]},e.remove=function(r){return Rt(r)?this.removeLabel(r):gt(r)?this.killTweensOf(r):(rn(this,r),r===this._recent&&(this._recent=this._last),Ti(this))},e.totalTime=function(r,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Mt(Zt.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),i.prototype.totalTime.call(this,r,n),this._forcing=0,this):this._tTime},e.addLabel=function(r,n){return this.labels[r]=ie(this,n),this},e.removeLabel=function(r){return delete this.labels[r],this},e.addPause=function(r,n,o){var a=Tt.delayedCall(0,n||Gs,o);return a.data="isPause",this._hasPause=1,Ie(this,a,ie(this,r))},e.removePause=function(r){var n=this._first;for(r=ie(this,r);n;)n._start===r&&n.data==="isPause"&&si(n),n=n._next},e.killTweensOf=function(r,n,o){for(var a=this.getTweensOf(r,o),h=a.length;h--;)Ke!==a[h]&&a[h].kill(r,n);return this},e.getTweensOf=function(r,n){for(var o=[],a=ae(r),h=this._first,l=He(n),c;h;)h instanceof Tt?Op(h._targets,a)&&(l?(!Ke||h._initted&&h._ts)&&h.globalTime(0)<=n&&h.globalTime(h.totalDuration())>n:!n||h.isActive())&&o.push(h):(c=h.getTweensOf(a,n)).length&&o.push.apply(o,c),h=h._next;return o},e.tweenTo=function(r,n){n=n||{};var o=this,a=ie(o,r),h=n,l=h.startAt,c=h.onStart,d=h.onStartParams,u=h.immediateRender,p,f=Tt.to(o,le({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale())||st,onStart:function(){if(o.pause(),!p){var m=n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale());f._dur!==m&&ss(f,m,0,1).render(f._time,!0,!0),p=1}c&&c.apply(f,d||[])}},n));return u?f.render(0):f},e.tweenFromTo=function(r,n,o){return this.tweenTo(n,le({startAt:{time:ie(this,r)}},o))},e.recent=function(){return this._recent},e.nextLabel=function(r){return r===void 0&&(r=this._time),Sh(this,ie(this,r))},e.previousLabel=function(r){return r===void 0&&(r=this._time),Sh(this,ie(this,r),1)},e.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+st)},e.shiftChildren=function(r,n,o){o===void 0&&(o=0);for(var a=this._first,h=this.labels,l;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(n)for(l in h)h[l]>=o&&(h[l]+=r);return Ti(this)},e.invalidate=function(r){var n=this._first;for(this._lock=0;n;)n.invalidate(r),n=n._next;return i.prototype.invalidate.call(this,r)},e.clear=function(r){r===void 0&&(r=!0);for(var n=this._first,o;n;)o=n._next,this.remove(n),n=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),Ti(this)},e.totalDuration=function(r){var n=0,o=this,a=o._last,h=oe,l,c,d;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(d=o.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),c=a._start,c>h&&o._sort&&a._ts&&!o._lock?(o._lock=1,Ie(o,a,c-a._delay,1)._lock=0):h=c,c<0&&a._ts&&(n-=c,(!d&&!o._dp||d&&d.smoothChildTiming)&&(o._start+=c/o._ts,o._time-=c,o._tTime-=c),o.shiftChildren(-c,!1,-1/0),h=0),a._end>n&&a._ts&&(n=a._end),a=l;ss(o,o===ct&&o._time>n?o._time:n,1,1),o._dirty=0}return o._tDur},t.updateRoot=function(r){if(ct._ts&&(tc(ct,Gr(r,ct)),Jl=Zt.frame),Zt.frame>=vh){vh+=te.autoSleep||120;var n=ct._first;if((!n||!n._ts)&&te.autoSleep&&Zt._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||Zt.sleep()}}},t}(ns);le(Ht.prototype,{_lock:0,_hasPause:0,_forcing:0});var rg=function(t,e,s,r,n,o,a){var h=new $t(this._pt,t,e,0,1,Ic,null,n),l=0,c=0,d,u,p,f,g,m,x,y;for(h.b=s,h.e=r,s+="",r+="",(x=~r.indexOf("random("))&&(r=Vs(r)),o&&(y=[s,r],o(y,t,e),s=y[0],r=y[1]),u=s.match(Wn)||[];d=Wn.exec(r);)f=d[0],g=r.substring(l,d.index),p?p=(p+1)%5:g.substr(-5)==="rgba("&&(p=1),f!==u[c++]&&(m=parseFloat(u[c-1])||0,h._pt={_next:h._pt,p:g||c===1?g:",",s:m,c:f.charAt(1)==="="?qi(m,f)-m:parseFloat(f)-m,m:p&&p<4?Math.round:0},l=Wn.lastIndex);return h.c=l<r.length?r.substring(l,r.length):"",h.fp=a,(jl.test(r)||x)&&(h.e=0),this._pt=h,h},la=function(t,e,s,r,n,o,a,h,l,c){gt(r)&&(r=r(n||0,t,o));var d=t[e],u=s!=="get"?s:gt(d)?l?t[e.indexOf("set")||!gt(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():d,p=gt(d)?l?lg:Ac:ua,f;if(Rt(r)&&(~r.indexOf("random(")&&(r=Vs(r)),r.charAt(1)==="="&&(f=qi(u,r)+(Lt(u)||0),(f||f===0)&&(r=f))),!c||u!==r||Fo)return!isNaN(u*r)&&r!==""?(f=new $t(this._pt,t,e,+u||0,r-(u||0),typeof d=="boolean"?ug:Cc,0,p),l&&(f.fp=l),a&&f.modifier(a,this,t),this._pt=f):(!d&&!(e in t)&&na(e,r),rg.call(this,t,e,u,r,p,h||te.stringFilter,l))},ng=function(t,e,s,r,n){if(gt(t)&&(t=Rs(t,n,e,s,r)),!Be(t)||t.style&&t.nodeType||Ft(t)||Xl(t))return Rt(t)?Rs(t,n,e,s,r):t;var o={},a;for(a in t)o[a]=Rs(t[a],n,e,s,r);return o},Tc=function(t,e,s,r,n,o){var a,h,l,c;if(Kt[t]&&(a=new Kt[t]).init(n,a.rawVars?e[t]:ng(e[t],r,n,o,s),s,r,o)!==!1&&(s._pt=h=new $t(s._pt,n,t,0,1,a.render,a,0,a.priority),s!==zi))for(l=s._ptLookup[s._targets.indexOf(n)],c=a._props.length;c--;)l[a._props[c]]=h;return a},Ke,Fo,ca=function i(t,e,s){var r=t.vars,n=r.ease,o=r.startAt,a=r.immediateRender,h=r.lazy,l=r.onUpdate,c=r.onUpdateParams,d=r.callbackScope,u=r.runBackwards,p=r.yoyoEase,f=r.keyframes,g=r.autoRevert,m=t._dur,x=t._startAt,y=t._targets,_=t.parent,v=_&&_.data==="nested"?_.vars.targets:y,w=t._overwrite==="auto"&&!ea,E=t.timeline,T,b,S,A,L,Y,C,I,q,Q,F,rt,Nt;if(E&&(!f||!n)&&(n="none"),t._ease=Si(n,es.ease),t._yEase=p?xc(Si(p===!0?n:p,es.ease)):0,p&&t._yoyo&&!t._repeat&&(p=t._yEase,t._yEase=t._ease,t._ease=p),t._from=!E&&!!r.runBackwards,!E||f&&!r.stagger){if(I=y[0]?wi(y[0]).harness:0,rt=I&&r[I.prop],T=Ur(r,oa),x&&(x._zTime<0&&x.progress(1),e<0&&u&&a&&!g?x.render(-1,!0):x.revert(u&&m?br:Bp),x._lazy=0),o){if(si(t._startAt=Tt.set(y,le({data:"isStart",overwrite:!1,parent:_,immediateRender:!0,lazy:!x&&Wt(h),startAt:null,delay:0,onUpdate:l,onUpdateParams:c,callbackScope:d,stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,e<0&&(Ot||!a&&!g)&&t._startAt.revert(br),a&&m&&e<=0&&s<=0){e&&(t._zTime=e);return}}else if(u&&m&&!x){if(e&&(a=!1),S=le({overwrite:!1,data:"isFromStart",lazy:a&&!x&&Wt(h),immediateRender:a,stagger:0,parent:_},T),rt&&(S[I.prop]=rt),si(t._startAt=Tt.set(y,S)),t._startAt._dp=0,t._startAt._sat=t,e<0&&(Ot?t._startAt.revert(br):t._startAt.render(-1,!0)),t._zTime=e,!a)i(t._startAt,st,st);else if(!e)return}for(t._pt=t._ptCache=0,h=m&&Wt(h)||h&&!m,b=0;b<y.length;b++){if(L=y[b],C=L._gsap||ha(y)[b]._gsap,t._ptLookup[b]=Q={},Po[C.id]&&Qe.length&&Dr(),F=v===y?b:v.indexOf(L),I&&(q=new I).init(L,rt||T,t,F,v)!==!1&&(t._pt=A=new $t(t._pt,L,q.name,0,1,q.render,q,0,q.priority),q._props.forEach(function(R){Q[R]=A}),q.priority&&(Y=1)),!I||rt)for(S in T)Kt[S]&&(q=Tc(S,T,t,F,L,v))?q.priority&&(Y=1):Q[S]=A=la.call(t,L,S,"get",T[S],F,v,0,r.stringFilter);t._op&&t._op[b]&&t.kill(L,t._op[b]),w&&t._pt&&(Ke=t,ct.killTweensOf(L,Q,t.globalTime(e)),Nt=!t.parent,Ke=0),t._pt&&h&&(Po[C.id]=1)}Y&&Rc(t),t._onInit&&t._onInit(t)}t._onUpdate=l,t._initted=(!t._op||t._pt)&&!Nt,f&&e<=0&&E.render(oe,!0,!0)},og=function(t,e,s,r,n,o,a){var h=(t._pt&&t._ptCache||(t._ptCache={}))[e],l,c,d,u;if(!h)for(h=t._ptCache[e]=[],d=t._ptLookup,u=t._targets.length;u--;){if(l=d[u][e],l&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==e&&l.fp!==e;)l=l._next;if(!l)return Fo=1,t.vars[e]="+=0",ca(t,a),Fo=0,1;h.push(l)}for(u=h.length;u--;)c=h[u],l=c._pt||c,l.s=(r||r===0)&&!n?r:l.s+(r||0)+o*l.c,l.c=s-l.s,c.e&&(c.e=mt(s)+Lt(c.e)),c.b&&(c.b=l.s+Lt(c.b))},ag=function(t,e){var s=t[0]?wi(t[0]).harness:0,r=s&&s.aliases,n,o,a,h;if(!r)return e;n=Ri({},e);for(o in r)if(o in n)for(h=r[o].split(","),a=h.length;a--;)n[h[a]]=n[o];return n},hg=function(t,e,s,r){var n=e.ease||r||"power1.inOut",o,a;if(Ft(e))a=s[t]||(s[t]=[]),e.forEach(function(h,l){return a.push({t:l/(e.length-1)*100,v:h,e:n})});else for(o in e)a=s[o]||(s[o]=[]),o==="ease"||a.push({t:parseFloat(t),v:e[o],e:n})},Rs=function(t,e,s,r,n){return gt(t)?t.call(e,s,r,n):Rt(t)&&~t.indexOf("random(")?Vs(t):t},Sc=aa+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Ec={};Xt(Sc+",id,stagger,delay,duration,paused,scrollTrigger",function(i){return Ec[i]=1});var Tt=function(i){Hl(t,i);function t(s,r,n,o){var a;typeof r=="number"&&(n.duration=r,r=n,n=null),a=i.call(this,o?r:Cs(r))||this;var h=a.vars,l=h.duration,c=h.delay,d=h.immediateRender,u=h.stagger,p=h.overwrite,f=h.keyframes,g=h.defaults,m=h.scrollTrigger,x=h.yoyoEase,y=r.parent||ct,_=(Ft(s)||Xl(s)?He(s[0]):"length"in r)?[s]:ae(s),v,w,E,T,b,S,A,L;if(a._targets=_.length?ha(_):Nr("GSAP target "+s+" not found. https://greensock.com",!te.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=p,f||u||pr(l)||pr(c)){if(r=a.vars,v=a.timeline=new Ht({data:"nested",defaults:g||{},targets:y&&y.data==="nested"?y.vars.targets:_}),v.kill(),v.parent=v._dp=Fe(a),v._start=0,u||pr(l)||pr(c)){if(T=_.length,A=u&&lc(u),Be(u))for(b in u)~Sc.indexOf(b)&&(L||(L={}),L[b]=u[b]);for(w=0;w<T;w++)E=Ur(r,Ec),E.stagger=0,x&&(E.yoyoEase=x),L&&Ri(E,L),S=_[w],E.duration=+Rs(l,Fe(a),w,S,_),E.delay=(+Rs(c,Fe(a),w,S,_)||0)-a._delay,!u&&T===1&&E.delay&&(a._delay=c=E.delay,a._start+=c,E.delay=0),v.to(S,E,A?A(w,S,_):0),v._ease=X.none;v.duration()?l=c=0:a.timeline=0}else if(f){Cs(le(v.vars.defaults,{ease:"none"})),v._ease=Si(f.ease||r.ease||"none");var Y=0,C,I,q;if(Ft(f))f.forEach(function(Q){return v.to(_,Q,">")}),v.duration();else{E={};for(b in f)b==="ease"||b==="easeEach"||hg(b,f[b],E,f.easeEach);for(b in E)for(C=E[b].sort(function(Q,F){return Q.t-F.t}),Y=0,w=0;w<C.length;w++)I=C[w],q={ease:I.e,duration:(I.t-(w?C[w-1].t:0))/100*l},q[b]=I.v,v.to(_,q,Y),Y+=q.duration;v.duration()<l&&v.to({},{duration:l-v.duration()})}}l||a.duration(l=v.duration())}else a.timeline=0;return p===!0&&!ea&&(Ke=Fe(a),ct.killTweensOf(_),Ke=0),Ie(y,Fe(a),n),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(d||!l&&!f&&a._start===Mt(y._time)&&Wt(d)&&Up(Fe(a))&&y.data!=="nested")&&(a._tTime=-st,a.render(Math.max(0,-c)||0)),m&&nc(Fe(a),m),a}var e=t.prototype;return e.render=function(r,n,o){var a=this._time,h=this._tDur,l=this._dur,c=r<0,d=r>h-st&&!c?h:r<st?0:r,u,p,f,g,m,x,y,_,v;if(!l)Vp(this,r,n,o);else if(d!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==c){if(u=d,_=this.timeline,this._repeat){if(g=l+this._rDelay,this._repeat<-1&&c)return this.totalTime(g*100+r,n,o);if(u=Mt(d%g),d===h?(f=this._repeat,u=l):(f=~~(d/g),f&&f===d/g&&(u=l,f--),u>l&&(u=l)),x=this._yoyo&&f&1,x&&(v=this._yEase,u=l-u),m=is(this._tTime,g),u===a&&!o&&this._initted)return this._tTime=d,this;f!==m&&(_&&this._yEase&&vc(_,x),this.vars.repeatRefresh&&!x&&!this._lock&&(this._lock=o=1,this.render(Mt(g*f),!0).invalidate()._lock=0))}if(!this._initted){if(oc(this,c?r:u,o,n,d))return this._tTime=0,this;if(a!==this._time)return this;if(l!==this._dur)return this.render(r,n,o)}if(this._tTime=d,this._time=u,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=y=(v||this._ease)(u/l),this._from&&(this.ratio=y=1-y),u&&!a&&!n&&!f&&(he(this,"onStart"),this._tTime!==d))return this;for(p=this._pt;p;)p.r(y,p.d),p=p._next;_&&_.render(r<0?r:!u&&x?-st:_._dur*_._ease(u/this._dur),n,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!n&&(c&&Mo(this,r,n,o),he(this,"onUpdate")),this._repeat&&f!==m&&this.vars.onRepeat&&!n&&this.parent&&he(this,"onRepeat"),(d===this._tDur||!d)&&this._tTime===d&&(c&&!this._onUpdate&&Mo(this,r,!0,!0),(r||!l)&&(d===this._tDur&&this._ts>0||!d&&this._ts<0)&&si(this,1),!n&&!(c&&!a)&&(d||a||x)&&(he(this,d===h?"onComplete":"onReverseComplete",!0),this._prom&&!(d<h&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),i.prototype.invalidate.call(this,r)},e.resetTo=function(r,n,o,a){zs||Zt.wake(),this._ts||this.play();var h=Math.min(this._dur,(this._dp._time-this._start)*this._ts),l;return this._initted||ca(this,h),l=this._ease(h/this._dur),og(this,r,n,o,a,l,h)?this.resetTo(r,n,o,a):(on(this,0),this.parent||sc(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(r,n){if(n===void 0&&(n="all"),!r&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?ws(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,n,Ke&&Ke.vars.overwrite!==!0)._first||ws(this),this.parent&&o!==this.timeline.totalDuration()&&ss(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,h=r?ae(r):a,l=this._ptLookup,c=this._pt,d,u,p,f,g,m,x;if((!n||n==="all")&&Np(a,h))return n==="all"&&(this._pt=0),ws(this);for(d=this._op=this._op||[],n!=="all"&&(Rt(n)&&(g={},Xt(n,function(y){return g[y]=1}),n=g),n=ag(a,n)),x=a.length;x--;)if(~h.indexOf(a[x])){u=l[x],n==="all"?(d[x]=n,f=u,p={}):(p=d[x]=d[x]||{},f=n);for(g in f)m=u&&u[g],m&&((!("kill"in m.d)||m.d.kill(g)===!0)&&rn(this,m,"_pt"),delete u[g]),p!=="all"&&(p[g]=1)}return this._initted&&!this._pt&&c&&ws(this),this},t.to=function(r,n){return new t(r,n,arguments[2])},t.from=function(r,n){return Is(1,arguments)},t.delayedCall=function(r,n,o,a){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:n,onReverseComplete:n,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},t.fromTo=function(r,n,o){return Is(2,arguments)},t.set=function(r,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(r,n)},t.killTweensOf=function(r,n,o){return ct.killTweensOf(r,n,o)},t}(ns);le(Tt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Xt("staggerTo,staggerFrom,staggerFromTo",function(i){Tt[i]=function(){var t=new Ht,e=Bo.call(arguments,0);return e.splice(i==="staggerFromTo"?5:4,0,0),t[i].apply(t,e)}});var ua=function(t,e,s){return t[e]=s},Ac=function(t,e,s){return t[e](s)},lg=function(t,e,s,r){return t[e](r.fp,s)},cg=function(t,e,s){return t.setAttribute(e,s)},da=function(t,e){return gt(t[e])?Ac:ia(t[e])&&t.setAttribute?cg:ua},Cc=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},ug=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Ic=function(t,e){var s=e._pt,r="";if(!t&&e.b)r=e.b;else if(t===1&&e.e)r=e.e;else{for(;s;)r=s.p+(s.m?s.m(s.s+s.c*t):Math.round((s.s+s.c*t)*1e4)/1e4)+r,s=s._next;r+=e.c}e.set(e.t,e.p,r,e)},fa=function(t,e){for(var s=e._pt;s;)s.r(t,s.d),s=s._next},dg=function(t,e,s,r){for(var n=this._pt,o;n;)o=n._next,n.p===r&&n.modifier(t,e,s),n=o},fg=function(t){for(var e=this._pt,s,r;e;)r=e._next,e.p===t&&!e.op||e.op===t?rn(this,e,"_pt"):e.dep||(s=1),e=r;return!s},pg=function(t,e,s,r){r.mSet(t,e,r.m.call(r.tween,s,r.mt),r)},Rc=function(t){for(var e=t._pt,s,r,n,o;e;){for(s=e._next,r=n;r&&r.pr>e.pr;)r=r._next;(e._prev=r?r._prev:o)?e._prev._next=e:n=e,(e._next=r)?r._prev=e:o=e,e=s}t._pt=n},$t=function(){function i(e,s,r,n,o,a,h,l,c){this.t=s,this.s=n,this.c=o,this.p=r,this.r=a||Cc,this.d=h||this,this.set=l||ua,this.pr=c||0,this._next=e,e&&(e._prev=this)}var t=i.prototype;return t.modifier=function(s,r,n){this.mSet=this.mSet||this.set,this.set=pg,this.m=s,this.mt=n,this.tween=r},i}();Xt(aa+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(i){return oa[i]=1});ee.TweenMax=ee.TweenLite=Tt;ee.TimelineLite=ee.TimelineMax=Ht;ct=new Ht({sortChildren:!1,defaults:es,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});te.stringFilter=yc;var os=[],Tr={},gg=[],Ah=0,qn=function(t){return(Tr[t]||gg).map(function(e){return e()})},No=function(){var t=Date.now(),e=[];t-Ah>2&&(qn("matchMediaInit"),os.forEach(function(s){var r=s.queries,n=s.conditions,o,a,h,l;for(a in r)o=se.matchMedia(r[a]).matches,o&&(h=1),o!==n[a]&&(n[a]=o,l=1);l&&(s.revert(),h&&e.push(s))}),qn("matchMediaRevert"),e.forEach(function(s){return s.onMatch(s)}),Ah=t,qn("matchMedia"))},Pc=function(){function i(e,s){this.selector=s&&Lo(s),this.data=[],this._r=[],this.isReverted=!1,e&&this.add(e)}var t=i.prototype;return t.add=function(s,r,n){gt(s)&&(n=r,r=s,s=gt);var o=this,a=function(){var l=vt,c=o.selector,d;return l&&l!==o&&l.data.push(o),n&&(o.selector=Lo(n)),vt=o,d=r.apply(o,arguments),gt(d)&&o._r.push(d),vt=l,o.selector=c,o.isReverted=!1,d};return o.last=a,s===gt?a(o):s?o[s]=a:a},t.ignore=function(s){var r=vt;vt=null,s(this),vt=r},t.getTweens=function(){var s=[];return this.data.forEach(function(r){return r instanceof i?s.push.apply(s,r.getTweens()):r instanceof Tt&&!(r.parent&&r.parent.data==="nested")&&s.push(r)}),s},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(s,r){var n=this;if(s){var o=this.getTweens();this.data.forEach(function(h){h.data==="isFlip"&&(h.revert(),h.getChildren(!0,!0,!1).forEach(function(l){return o.splice(o.indexOf(l),1)}))}),o.map(function(h){return{g:h.globalTime(0),t:h}}).sort(function(h,l){return l.g-h.g||-1}).forEach(function(h){return h.t.revert(s)}),this.data.forEach(function(h){return!(h instanceof ns)&&h.revert&&h.revert(s)}),this._r.forEach(function(h){return h(s,n)}),this.isReverted=!0}else this.data.forEach(function(h){return h.kill&&h.kill()});if(this.clear(),r){var a=os.indexOf(this);~a&&os.splice(a,1)}},t.revert=function(s){this.kill(s||{})},i}(),mg=function(){function i(e){this.contexts=[],this.scope=e}var t=i.prototype;return t.add=function(s,r,n){Be(s)||(s={matches:s});var o=new Pc(0,n||this.scope),a=o.conditions={},h,l,c;this.contexts.push(o),r=o.add("onMatch",r),o.queries=s;for(l in s)l==="all"?c=1:(h=se.matchMedia(s[l]),h&&(os.indexOf(o)<0&&os.push(o),(a[l]=h.matches)&&(c=1),h.addListener?h.addListener(No):h.addEventListener("change",No)));return c&&r(o),this},t.revert=function(s){this.kill(s||{})},t.kill=function(s){this.contexts.forEach(function(r){return r.kill(s,!0)})},i}(),Vr={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];e.forEach(function(r){return gc(r)})},timeline:function(t){return new Ht(t)},getTweensOf:function(t,e){return ct.getTweensOf(t,e)},getProperty:function(t,e,s,r){Rt(t)&&(t=ae(t)[0]);var n=wi(t||{}).get,o=s?ic:ec;return s==="native"&&(s=""),t&&(e?o((Kt[e]&&Kt[e].get||n)(t,e,s,r)):function(a,h,l){return o((Kt[a]&&Kt[a].get||n)(t,a,h,l))})},quickSetter:function(t,e,s){if(t=ae(t),t.length>1){var r=t.map(function(c){return jt.quickSetter(c,e,s)}),n=r.length;return function(c){for(var d=n;d--;)r[d](c)}}t=t[0]||{};var o=Kt[e],a=wi(t),h=a.harness&&(a.harness.aliases||{})[e]||e,l=o?function(c){var d=new o;zi._pt=0,d.init(t,s?c+s:c,zi,0,[t]),d.render(1,d),zi._pt&&fa(1,zi)}:a.set(t,h);return o?l:function(c){return l(t,h,s?c+s:c,a,1)}},quickTo:function(t,e,s){var r,n=jt.to(t,Ri((r={},r[e]="+=0.1",r.paused=!0,r),s||{})),o=function(h,l,c){return n.resetTo(e,h,l,c)};return o.tween=n,o},isTweening:function(t){return ct.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Si(t.ease,es.ease)),bh(es,t||{})},config:function(t){return bh(te,t||{})},registerEffect:function(t){var e=t.name,s=t.effect,r=t.plugins,n=t.defaults,o=t.extendTimeline;(r||"").split(",").forEach(function(a){return a&&!Kt[a]&&!ee[a]&&Nr(e+" effect requires "+a+" plugin.")}),Xn[e]=function(a,h,l){return s(ae(a),le(h||{},n),l)},o&&(Ht.prototype[e]=function(a,h,l){return this.add(Xn[e](a,Be(h)?h:(l=h)&&{},this),l)})},registerEase:function(t,e){X[t]=Si(e)},parseEase:function(t,e){return arguments.length?Si(t,e):X},getById:function(t){return ct.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var s=new Ht(t),r,n;for(s.smoothChildTiming=Wt(t.smoothChildTiming),ct.remove(s),s._dp=0,s._time=s._tTime=ct._time,r=ct._first;r;)n=r._next,(e||!(!r._dur&&r instanceof Tt&&r.vars.onComplete===r._targets[0]))&&Ie(s,r,r._start-r._delay),r=n;return Ie(ct,s,0),s},context:function(t,e){return t?new Pc(t,e):vt},matchMedia:function(t){return new mg(t)},matchMediaRefresh:function(){return os.forEach(function(t){var e=t.conditions,s,r;for(r in e)e[r]&&(e[r]=!1,s=1);s&&t.revert()})||No()},addEventListener:function(t,e){var s=Tr[t]||(Tr[t]=[]);~s.indexOf(e)||s.push(e)},removeEventListener:function(t,e){var s=Tr[t],r=s&&s.indexOf(e);r>=0&&s.splice(r,1)},utils:{wrap:qp,wrapYoyo:Kp,distribute:lc,random:uc,snap:cc,normalize:Yp,getUnit:Lt,clamp:Wp,splitColor:mc,toArray:ae,selector:Lo,mapRange:fc,pipe:$p,unitize:jp,interpolate:Zp,shuffle:hc},install:Kl,effects:Xn,ticker:Zt,updateRoot:Ht.updateRoot,plugins:Kt,globalTimeline:ct,core:{PropTween:$t,globals:Zl,Tween:Tt,Timeline:Ht,Animation:ns,getCache:wi,_removeLinkedListItem:rn,reverting:function(){return Ot},context:function(t){return t&&vt&&(vt.data.push(t),t._ctx=vt),vt},suppressOverwrites:function(t){return ea=t}}};Xt("to,from,fromTo,delayedCall,set,killTweensOf",function(i){return Vr[i]=Tt[i]});Zt.add(Ht.updateRoot);zi=Vr.to({},{duration:0});var _g=function(t,e){for(var s=t._pt;s&&s.p!==e&&s.op!==e&&s.fp!==e;)s=s._next;return s},yg=function(t,e){var s=t._targets,r,n,o;for(r in e)for(n=s.length;n--;)o=t._ptLookup[n][r],o&&(o=o.d)&&(o._pt&&(o=_g(o,r)),o&&o.modifier&&o.modifier(e[r],t,s[n],r))},Kn=function(t,e){return{name:t,rawVars:1,init:function(r,n,o){o._onInit=function(a){var h,l;if(Rt(n)&&(h={},Xt(n,function(c){return h[c]=1}),n=h),e){h={};for(l in n)h[l]=e(n[l]);n=h}yg(a,n)}}}},jt=Vr.registerPlugin({name:"attr",init:function(t,e,s,r,n){var o,a,h;this.tween=s;for(o in e)h=t.getAttribute(o)||"",a=this.add(t,"setAttribute",(h||0)+"",e[o],r,n,0,0,o),a.op=o,a.b=h,this._props.push(o)},render:function(t,e){for(var s=e._pt;s;)Ot?s.set(s.t,s.p,s.b,s):s.r(t,s.d),s=s._next}},{name:"endArray",init:function(t,e){for(var s=e.length;s--;)this.add(t,s,t[s]||0,e[s],0,0,0,0,0,1)}},Kn("roundProps",Oo),Kn("modifiers"),Kn("snap",cc))||Vr;Tt.version=Ht.version=jt.version="3.11.5";ql=1;sa()&&rs();X.Power0;X.Power1;X.Power2;X.Power3;X.Power4;X.Linear;X.Quad;X.Cubic;X.Quart;X.Quint;X.Strong;X.Elastic;var zr=X.Back;X.SteppedEase;X.Bounce;X.Sine;X.Expo;X.Circ;/*!
 * CSSPlugin 3.11.5
 * https://greensock.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Ch,Ze,Ki,pa,bi,Ih,ga,xg=function(){return typeof window<"u"},We={},_i=180/Math.PI,Zi=Math.PI/180,Oi=Math.atan2,Rh=1e8,ma=/([A-Z])/g,vg=/(left|right|width|margin|padding|x)/i,bg=/[\s,\(]\S/,Pe={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Do=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},wg=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},Tg=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},Sg=function(t,e){var s=e.s+e.c*t;e.set(e.t,e.p,~~(s+(s<0?-.5:.5))+e.u,e)},Mc=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},kc=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},Eg=function(t,e,s){return t.style[e]=s},Ag=function(t,e,s){return t.style.setProperty(e,s)},Cg=function(t,e,s){return t._gsap[e]=s},Ig=function(t,e,s){return t._gsap.scaleX=t._gsap.scaleY=s},Rg=function(t,e,s,r,n){var o=t._gsap;o.scaleX=o.scaleY=s,o.renderTransform(n,o)},Pg=function(t,e,s,r,n){var o=t._gsap;o[e]=s,o.renderTransform(n,o)},dt="transform",be=dt+"Origin",Mg=function i(t,e){var s=this,r=this.target,n=r.style;if(t in We){if(this.tfm=this.tfm||{},t!=="transform")t=Pe[t]||t,~t.indexOf(",")?t.split(",").forEach(function(o){return s.tfm[o]=Ne(r,o)}):this.tfm[t]=r._gsap.x?r._gsap[t]:Ne(r,t);else return Pe.transform.split(",").forEach(function(o){return i.call(s,o,e)});if(this.props.indexOf(dt)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(be,e,"")),t=dt}(n||e)&&this.props.push(t,e,n[t])},Bc=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},kg=function(){var t=this.props,e=this.target,s=e.style,r=e._gsap,n,o;for(n=0;n<t.length;n+=3)t[n+1]?e[t[n]]=t[n+2]:t[n+2]?s[t[n]]=t[n+2]:s.removeProperty(t[n].substr(0,2)==="--"?t[n]:t[n].replace(ma,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),n=ga(),(!n||!n.isStart)&&!s[dt]&&(Bc(s),r.uncache=1)}},Lc=function(t,e){var s={target:t,props:[],revert:kg,save:Mg};return t._gsap||jt.core.getCache(t),e&&e.split(",").forEach(function(r){return s.save(r)}),s},Oc,Uo=function(t,e){var s=Ze.createElementNS?Ze.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Ze.createElement(t);return s.style?s:Ze.createElement(t)},ke=function i(t,e,s){var r=getComputedStyle(t);return r[e]||r.getPropertyValue(e.replace(ma,"-$1").toLowerCase())||r.getPropertyValue(e)||!s&&i(t,as(e)||e,1)||""},Ph="O,Moz,ms,Ms,Webkit".split(","),as=function(t,e,s){var r=e||bi,n=r.style,o=5;if(t in n&&!s)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);o--&&!(Ph[o]+t in n););return o<0?null:(o===3?"ms":o>=0?Ph[o]:"")+t},Go=function(){xg()&&window.document&&(Ch=window,Ze=Ch.document,Ki=Ze.documentElement,bi=Uo("div")||{style:{}},Uo("div"),dt=as(dt),be=dt+"Origin",bi.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Oc=!!as("perspective"),ga=jt.core.reverting,pa=1)},Zn=function i(t){var e=Uo("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=this.parentNode,r=this.nextSibling,n=this.style.cssText,o;if(Ki.appendChild(e),e.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=i}catch{}else this._gsapBBox&&(o=this._gsapBBox());return s&&(r?s.insertBefore(this,r):s.appendChild(this)),Ki.removeChild(e),this.style.cssText=n,o},Mh=function(t,e){for(var s=e.length;s--;)if(t.hasAttribute(e[s]))return t.getAttribute(e[s])},Fc=function(t){var e;try{e=t.getBBox()}catch{e=Zn.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===Zn||(e=Zn.call(t,!0)),e&&!e.width&&!e.x&&!e.y?{x:+Mh(t,["x","cx","x1"])||0,y:+Mh(t,["y","cy","y1"])||0,width:0,height:0}:e},Nc=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&Fc(t))},Hs=function(t,e){if(e){var s=t.style;e in We&&e!==be&&(e=dt),s.removeProperty?((e.substr(0,2)==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),s.removeProperty(e.replace(ma,"-$1").toLowerCase())):s.removeAttribute(e)}},Je=function(t,e,s,r,n,o){var a=new $t(t._pt,e,s,0,1,o?kc:Mc);return t._pt=a,a.b=r,a.e=n,t._props.push(s),a},kh={deg:1,rad:1,turn:1},Bg={grid:1,flex:1},ri=function i(t,e,s,r){var n=parseFloat(s)||0,o=(s+"").trim().substr((n+"").length)||"px",a=bi.style,h=vg.test(e),l=t.tagName.toLowerCase()==="svg",c=(l?"client":"offset")+(h?"Width":"Height"),d=100,u=r==="px",p=r==="%",f,g,m,x;return r===o||!n||kh[r]||kh[o]?n:(o!=="px"&&!u&&(n=i(t,e,s,"px")),x=t.getCTM&&Nc(t),(p||o==="%")&&(We[e]||~e.indexOf("adius"))?(f=x?t.getBBox()[h?"width":"height"]:t[c],mt(p?n/f*d:n/100*f)):(a[h?"width":"height"]=d+(u?o:r),g=~e.indexOf("adius")||r==="em"&&t.appendChild&&!l?t:t.parentNode,x&&(g=(t.ownerSVGElement||{}).parentNode),(!g||g===Ze||!g.appendChild)&&(g=Ze.body),m=g._gsap,m&&p&&m.width&&h&&m.time===Zt.time&&!m.uncache?mt(n/m.width*d):((p||o==="%")&&!Bg[ke(g,"display")]&&(a.position=ke(t,"position")),g===t&&(a.position="static"),g.appendChild(bi),f=bi[c],g.removeChild(bi),a.position="absolute",h&&p&&(m=wi(g),m.time=Zt.time,m.width=g[c]),mt(u?f*n/d:f&&n?d/f*n:0))))},Ne=function(t,e,s,r){var n;return pa||Go(),e in Pe&&e!=="transform"&&(e=Pe[e],~e.indexOf(",")&&(e=e.split(",")[0])),We[e]&&e!=="transform"?(n=Xs(t,r),n=e!=="transformOrigin"?n[e]:n.svg?n.origin:Wr(ke(t,be))+" "+n.zOrigin+"px"):(n=t.style[e],(!n||n==="auto"||r||~(n+"").indexOf("calc("))&&(n=Hr[e]&&Hr[e](t,e,s)||ke(t,e)||Ql(t,e)||(e==="opacity"?1:0))),s&&!~(n+"").trim().indexOf(" ")?ri(t,e,n,s)+s:n},Lg=function(t,e,s,r){if(!s||s==="none"){var n=as(e,t,1),o=n&&ke(t,n,1);o&&o!==s?(e=n,s=o):e==="borderColor"&&(s=ke(t,"borderTopColor"))}var a=new $t(this._pt,t.style,e,0,1,Ic),h=0,l=0,c,d,u,p,f,g,m,x,y,_,v,w;if(a.b=s,a.e=r,s+="",r+="",r==="auto"&&(t.style[e]=r,r=ke(t,e)||r,t.style[e]=s),c=[s,r],yc(c),s=c[0],r=c[1],u=s.match(Vi)||[],w=r.match(Vi)||[],w.length){for(;d=Vi.exec(r);)m=d[0],y=r.substring(h,d.index),f?f=(f+1)%5:(y.substr(-5)==="rgba("||y.substr(-5)==="hsla(")&&(f=1),m!==(g=u[l++]||"")&&(p=parseFloat(g)||0,v=g.substr((p+"").length),m.charAt(1)==="="&&(m=qi(p,m)+v),x=parseFloat(m),_=m.substr((x+"").length),h=Vi.lastIndex-_.length,_||(_=_||te.units[e]||v,h===r.length&&(r+=_,a.e+=_)),v!==_&&(p=ri(t,e,g,_)||0),a._pt={_next:a._pt,p:y||l===1?y:",",s:p,c:x-p,m:f&&f<4||e==="zIndex"?Math.round:0});a.c=h<r.length?r.substring(h,r.length):""}else a.r=e==="display"&&r==="none"?kc:Mc;return jl.test(r)&&(a.e=0),this._pt=a,a},Bh={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Og=function(t){var e=t.split(" "),s=e[0],r=e[1]||"50%";return(s==="top"||s==="bottom"||r==="left"||r==="right")&&(t=s,s=r,r=t),e[0]=Bh[s]||s,e[1]=Bh[r]||r,e.join(" ")},Fg=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var s=e.t,r=s.style,n=e.u,o=s._gsap,a,h,l;if(n==="all"||n===!0)r.cssText="",h=1;else for(n=n.split(","),l=n.length;--l>-1;)a=n[l],We[a]&&(h=1,a=a==="transformOrigin"?be:dt),Hs(s,a);h&&(Hs(s,dt),o&&(o.svg&&s.removeAttribute("transform"),Xs(s,1),o.uncache=1,Bc(r)))}},Hr={clearProps:function(t,e,s,r,n){if(n.data!=="isFromStart"){var o=t._pt=new $t(t._pt,e,s,0,0,Fg);return o.u=r,o.pr=-10,o.tween=n,t._props.push(s),1}}},Ws=[1,0,0,1,0,0],Dc={},Uc=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},Lh=function(t){var e=ke(t,dt);return Uc(e)?Ws:e.substr(7).match($l).map(mt)},_a=function(t,e){var s=t._gsap||wi(t),r=t.style,n=Lh(t),o,a,h,l;return s.svg&&t.getAttribute("transform")?(h=t.transform.baseVal.consolidate().matrix,n=[h.a,h.b,h.c,h.d,h.e,h.f],n.join(",")==="1,0,0,1,0,0"?Ws:n):(n===Ws&&!t.offsetParent&&t!==Ki&&!s.svg&&(h=r.display,r.display="block",o=t.parentNode,(!o||!t.offsetParent)&&(l=1,a=t.nextElementSibling,Ki.appendChild(t)),n=Lh(t),h?r.display=h:Hs(t,"display"),l&&(a?o.insertBefore(t,a):o?o.appendChild(t):Ki.removeChild(t))),e&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},Vo=function(t,e,s,r,n,o){var a=t._gsap,h=n||_a(t,!0),l=a.xOrigin||0,c=a.yOrigin||0,d=a.xOffset||0,u=a.yOffset||0,p=h[0],f=h[1],g=h[2],m=h[3],x=h[4],y=h[5],_=e.split(" "),v=parseFloat(_[0])||0,w=parseFloat(_[1])||0,E,T,b,S;s?h!==Ws&&(T=p*m-f*g)&&(b=v*(m/T)+w*(-g/T)+(g*y-m*x)/T,S=v*(-f/T)+w*(p/T)-(p*y-f*x)/T,v=b,w=S):(E=Fc(t),v=E.x+(~_[0].indexOf("%")?v/100*E.width:v),w=E.y+(~(_[1]||_[0]).indexOf("%")?w/100*E.height:w)),r||r!==!1&&a.smooth?(x=v-l,y=w-c,a.xOffset=d+(x*p+y*g)-x,a.yOffset=u+(x*f+y*m)-y):a.xOffset=a.yOffset=0,a.xOrigin=v,a.yOrigin=w,a.smooth=!!r,a.origin=e,a.originIsAbsolute=!!s,t.style[be]="0px 0px",o&&(Je(o,a,"xOrigin",l,v),Je(o,a,"yOrigin",c,w),Je(o,a,"xOffset",d,a.xOffset),Je(o,a,"yOffset",u,a.yOffset)),t.setAttribute("data-svg-origin",v+" "+w)},Xs=function(t,e){var s=t._gsap||new wc(t);if("x"in s&&!e&&!s.uncache)return s;var r=t.style,n=s.scaleX<0,o="px",a="deg",h=getComputedStyle(t),l=ke(t,be)||"0",c,d,u,p,f,g,m,x,y,_,v,w,E,T,b,S,A,L,Y,C,I,q,Q,F,rt,Nt,R,B,G,Z,z,nt;return c=d=u=g=m=x=y=_=v=0,p=f=1,s.svg=!!(t.getCTM&&Nc(t)),h.translate&&((h.translate!=="none"||h.scale!=="none"||h.rotate!=="none")&&(r[dt]=(h.translate!=="none"?"translate3d("+(h.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(h.rotate!=="none"?"rotate("+h.rotate+") ":"")+(h.scale!=="none"?"scale("+h.scale.split(" ").join(",")+") ":"")+(h[dt]!=="none"?h[dt]:"")),r.scale=r.rotate=r.translate="none"),T=_a(t,s.svg),s.svg&&(s.uncache?(rt=t.getBBox(),l=s.xOrigin-rt.x+"px "+(s.yOrigin-rt.y)+"px",F=""):F=!e&&t.getAttribute("data-svg-origin"),Vo(t,F||l,!!F||s.originIsAbsolute,s.smooth!==!1,T)),w=s.xOrigin||0,E=s.yOrigin||0,T!==Ws&&(L=T[0],Y=T[1],C=T[2],I=T[3],c=q=T[4],d=Q=T[5],T.length===6?(p=Math.sqrt(L*L+Y*Y),f=Math.sqrt(I*I+C*C),g=L||Y?Oi(Y,L)*_i:0,y=C||I?Oi(C,I)*_i+g:0,y&&(f*=Math.abs(Math.cos(y*Zi))),s.svg&&(c-=w-(w*L+E*C),d-=E-(w*Y+E*I))):(nt=T[6],Z=T[7],R=T[8],B=T[9],G=T[10],z=T[11],c=T[12],d=T[13],u=T[14],b=Oi(nt,G),m=b*_i,b&&(S=Math.cos(-b),A=Math.sin(-b),F=q*S+R*A,rt=Q*S+B*A,Nt=nt*S+G*A,R=q*-A+R*S,B=Q*-A+B*S,G=nt*-A+G*S,z=Z*-A+z*S,q=F,Q=rt,nt=Nt),b=Oi(-C,G),x=b*_i,b&&(S=Math.cos(-b),A=Math.sin(-b),F=L*S-R*A,rt=Y*S-B*A,Nt=C*S-G*A,z=I*A+z*S,L=F,Y=rt,C=Nt),b=Oi(Y,L),g=b*_i,b&&(S=Math.cos(b),A=Math.sin(b),F=L*S+Y*A,rt=q*S+Q*A,Y=Y*S-L*A,Q=Q*S-q*A,L=F,q=rt),m&&Math.abs(m)+Math.abs(g)>359.9&&(m=g=0,x=180-x),p=mt(Math.sqrt(L*L+Y*Y+C*C)),f=mt(Math.sqrt(Q*Q+nt*nt)),b=Oi(q,Q),y=Math.abs(b)>2e-4?b*_i:0,v=z?1/(z<0?-z:z):0),s.svg&&(F=t.getAttribute("transform"),s.forceCSS=t.setAttribute("transform","")||!Uc(ke(t,dt)),F&&t.setAttribute("transform",F))),Math.abs(y)>90&&Math.abs(y)<270&&(n?(p*=-1,y+=g<=0?180:-180,g+=g<=0?180:-180):(f*=-1,y+=y<=0?180:-180)),e=e||s.uncache,s.x=c-((s.xPercent=c&&(!e&&s.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-c)?-50:0)))?t.offsetWidth*s.xPercent/100:0)+o,s.y=d-((s.yPercent=d&&(!e&&s.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-d)?-50:0)))?t.offsetHeight*s.yPercent/100:0)+o,s.z=u+o,s.scaleX=mt(p),s.scaleY=mt(f),s.rotation=mt(g)+a,s.rotationX=mt(m)+a,s.rotationY=mt(x)+a,s.skewX=y+a,s.skewY=_+a,s.transformPerspective=v+o,(s.zOrigin=parseFloat(l.split(" ")[2])||0)&&(r[be]=Wr(l)),s.xOffset=s.yOffset=0,s.force3D=te.force3D,s.renderTransform=s.svg?Dg:Oc?Gc:Ng,s.uncache=0,s},Wr=function(t){return(t=t.split(" "))[0]+" "+t[1]},Jn=function(t,e,s){var r=Lt(e);return mt(parseFloat(e)+parseFloat(ri(t,"x",s+"px",r)))+r},Ng=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Gc(t,e)},ci="0deg",ys="0px",ui=") ",Gc=function(t,e){var s=e||this,r=s.xPercent,n=s.yPercent,o=s.x,a=s.y,h=s.z,l=s.rotation,c=s.rotationY,d=s.rotationX,u=s.skewX,p=s.skewY,f=s.scaleX,g=s.scaleY,m=s.transformPerspective,x=s.force3D,y=s.target,_=s.zOrigin,v="",w=x==="auto"&&t&&t!==1||x===!0;if(_&&(d!==ci||c!==ci)){var E=parseFloat(c)*Zi,T=Math.sin(E),b=Math.cos(E),S;E=parseFloat(d)*Zi,S=Math.cos(E),o=Jn(y,o,T*S*-_),a=Jn(y,a,-Math.sin(E)*-_),h=Jn(y,h,b*S*-_+_)}m!==ys&&(v+="perspective("+m+ui),(r||n)&&(v+="translate("+r+"%, "+n+"%) "),(w||o!==ys||a!==ys||h!==ys)&&(v+=h!==ys||w?"translate3d("+o+", "+a+", "+h+") ":"translate("+o+", "+a+ui),l!==ci&&(v+="rotate("+l+ui),c!==ci&&(v+="rotateY("+c+ui),d!==ci&&(v+="rotateX("+d+ui),(u!==ci||p!==ci)&&(v+="skew("+u+", "+p+ui),(f!==1||g!==1)&&(v+="scale("+f+", "+g+ui),y.style[dt]=v||"translate(0, 0)"},Dg=function(t,e){var s=e||this,r=s.xPercent,n=s.yPercent,o=s.x,a=s.y,h=s.rotation,l=s.skewX,c=s.skewY,d=s.scaleX,u=s.scaleY,p=s.target,f=s.xOrigin,g=s.yOrigin,m=s.xOffset,x=s.yOffset,y=s.forceCSS,_=parseFloat(o),v=parseFloat(a),w,E,T,b,S;h=parseFloat(h),l=parseFloat(l),c=parseFloat(c),c&&(c=parseFloat(c),l+=c,h+=c),h||l?(h*=Zi,l*=Zi,w=Math.cos(h)*d,E=Math.sin(h)*d,T=Math.sin(h-l)*-u,b=Math.cos(h-l)*u,l&&(c*=Zi,S=Math.tan(l-c),S=Math.sqrt(1+S*S),T*=S,b*=S,c&&(S=Math.tan(c),S=Math.sqrt(1+S*S),w*=S,E*=S)),w=mt(w),E=mt(E),T=mt(T),b=mt(b)):(w=d,b=u,E=T=0),(_&&!~(o+"").indexOf("px")||v&&!~(a+"").indexOf("px"))&&(_=ri(p,"x",o,"px"),v=ri(p,"y",a,"px")),(f||g||m||x)&&(_=mt(_+f-(f*w+g*T)+m),v=mt(v+g-(f*E+g*b)+x)),(r||n)&&(S=p.getBBox(),_=mt(_+r/100*S.width),v=mt(v+n/100*S.height)),S="matrix("+w+","+E+","+T+","+b+","+_+","+v+")",p.setAttribute("transform",S),y&&(p.style[dt]=S)},Ug=function(t,e,s,r,n){var o=360,a=Rt(n),h=parseFloat(n)*(a&&~n.indexOf("rad")?_i:1),l=h-r,c=r+l+"deg",d,u;return a&&(d=n.split("_")[1],d==="short"&&(l%=o,l!==l%(o/2)&&(l+=l<0?o:-o)),d==="cw"&&l<0?l=(l+o*Rh)%o-~~(l/o)*o:d==="ccw"&&l>0&&(l=(l-o*Rh)%o-~~(l/o)*o)),t._pt=u=new $t(t._pt,e,s,r,l,wg),u.e=c,u.u="deg",t._props.push(s),u},Oh=function(t,e){for(var s in e)t[s]=e[s];return t},Gg=function(t,e,s){var r=Oh({},s._gsap),n="perspective,force3D,transformOrigin,svgOrigin",o=s.style,a,h,l,c,d,u,p,f;r.svg?(l=s.getAttribute("transform"),s.setAttribute("transform",""),o[dt]=e,a=Xs(s,1),Hs(s,dt),s.setAttribute("transform",l)):(l=getComputedStyle(s)[dt],o[dt]=e,a=Xs(s,1),o[dt]=l);for(h in We)l=r[h],c=a[h],l!==c&&n.indexOf(h)<0&&(p=Lt(l),f=Lt(c),d=p!==f?ri(s,h,l,f):parseFloat(l),u=parseFloat(c),t._pt=new $t(t._pt,a,h,d,u-d,Do),t._pt.u=f||0,t._props.push(h));Oh(a,r)};Xt("padding,margin,Width,Radius",function(i,t){var e="Top",s="Right",r="Bottom",n="Left",o=(t<3?[e,s,r,n]:[e+n,e+s,r+s,r+n]).map(function(a){return t<2?i+a:"border"+a+i});Hr[t>1?"border"+i:i]=function(a,h,l,c,d){var u,p;if(arguments.length<4)return u=o.map(function(f){return Ne(a,f,l)}),p=u.join(" "),p.split(u[0]).length===5?u[0]:p;u=(c+"").split(" "),p={},o.forEach(function(f,g){return p[f]=u[g]=u[g]||u[(g-1)/2|0]}),a.init(h,p,d)}});var Vc={name:"css",register:Go,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,s,r,n){var o=this._props,a=t.style,h=s.vars.startAt,l,c,d,u,p,f,g,m,x,y,_,v,w,E,T,b;pa||Go(),this.styles=this.styles||Lc(t),b=this.styles.props,this.tween=s;for(g in e)if(g!=="autoRound"&&(c=e[g],!(Kt[g]&&Tc(g,e,s,r,t,n)))){if(p=typeof c,f=Hr[g],p==="function"&&(c=c.call(s,r,t,n),p=typeof c),p==="string"&&~c.indexOf("random(")&&(c=Vs(c)),f)f(this,t,g,c,s)&&(T=1);else if(g.substr(0,2)==="--")l=(getComputedStyle(t).getPropertyValue(g)+"").trim(),c+="",ti.lastIndex=0,ti.test(l)||(m=Lt(l),x=Lt(c)),x?m!==x&&(l=ri(t,g,l,x)+x):m&&(c+=m),this.add(a,"setProperty",l,c,r,n,0,0,g),o.push(g),b.push(g,0,a[g]);else if(p!=="undefined"){if(h&&g in h?(l=typeof h[g]=="function"?h[g].call(s,r,t,n):h[g],Rt(l)&&~l.indexOf("random(")&&(l=Vs(l)),Lt(l+"")||(l+=te.units[g]||Lt(Ne(t,g))||""),(l+"").charAt(1)==="="&&(l=Ne(t,g))):l=Ne(t,g),u=parseFloat(l),y=p==="string"&&c.charAt(1)==="="&&c.substr(0,2),y&&(c=c.substr(2)),d=parseFloat(c),g in Pe&&(g==="autoAlpha"&&(u===1&&Ne(t,"visibility")==="hidden"&&d&&(u=0),b.push("visibility",0,a.visibility),Je(this,a,"visibility",u?"inherit":"hidden",d?"inherit":"hidden",!d)),g!=="scale"&&g!=="transform"&&(g=Pe[g],~g.indexOf(",")&&(g=g.split(",")[0]))),_=g in We,_){if(this.styles.save(g),v||(w=t._gsap,w.renderTransform&&!e.parseTransform||Xs(t,e.parseTransform),E=e.smoothOrigin!==!1&&w.smooth,v=this._pt=new $t(this._pt,a,dt,0,1,w.renderTransform,w,0,-1),v.dep=1),g==="scale")this._pt=new $t(this._pt,w,"scaleY",w.scaleY,(y?qi(w.scaleY,y+d):d)-w.scaleY||0,Do),this._pt.u=0,o.push("scaleY",g),g+="X";else if(g==="transformOrigin"){b.push(be,0,a[be]),c=Og(c),w.svg?Vo(t,c,0,E,0,this):(x=parseFloat(c.split(" ")[2])||0,x!==w.zOrigin&&Je(this,w,"zOrigin",w.zOrigin,x),Je(this,a,g,Wr(l),Wr(c)));continue}else if(g==="svgOrigin"){Vo(t,c,1,E,0,this);continue}else if(g in Dc){Ug(this,w,g,u,y?qi(u,y+c):c);continue}else if(g==="smoothOrigin"){Je(this,w,"smooth",w.smooth,c);continue}else if(g==="force3D"){w[g]=c;continue}else if(g==="transform"){Gg(this,c,t);continue}}else g in a||(g=as(g)||g);if(_||(d||d===0)&&(u||u===0)&&!bg.test(c)&&g in a)m=(l+"").substr((u+"").length),d||(d=0),x=Lt(c)||(g in te.units?te.units[g]:m),m!==x&&(u=ri(t,g,l,x)),this._pt=new $t(this._pt,_?w:a,g,u,(y?qi(u,y+d):d)-u,!_&&(x==="px"||g==="zIndex")&&e.autoRound!==!1?Sg:Do),this._pt.u=x||0,m!==x&&x!=="%"&&(this._pt.b=l,this._pt.r=Tg);else if(g in a)Lg.call(this,t,g,l,y?y+c:c);else if(g in t)this.add(t,g,l||t[g],y?y+c:c,r,n);else if(g!=="parseTransform"){na(g,c);continue}_||(g in a?b.push(g,0,a[g]):b.push(g,1,l||t[g])),o.push(g)}}T&&Rc(this)},render:function(t,e){if(e.tween._time||!ga())for(var s=e._pt;s;)s.r(t,s.d),s=s._next;else e.styles.revert()},get:Ne,aliases:Pe,getSetter:function(t,e,s){var r=Pe[e];return r&&r.indexOf(",")<0&&(e=r),e in We&&e!==be&&(t._gsap.x||Ne(t,"x"))?s&&Ih===s?e==="scale"?Ig:Cg:(Ih=s||{})&&(e==="scale"?Rg:Pg):t.style&&!ia(t.style[e])?Eg:~e.indexOf("-")?Ag:da(t,e)},core:{_removeProperty:Hs,_getMatrix:_a}};jt.utils.checkPrefix=as;jt.core.getStyleSaver=Lc;(function(i,t,e,s){var r=Xt(i+","+t+","+e,function(n){We[n]=1});Xt(t,function(n){te.units[n]="deg",Dc[n]=1}),Pe[r[13]]=i+","+t,Xt(s,function(n){var o=n.split(":");Pe[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Xt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(i){te.units[i]="px"});jt.registerPlugin(Vc);var Qt=jt.registerPlugin(Vc)||jt;Qt.core.Tween;class ya extends pt{constructor(t,e){super({id:t,styles:{width:"100%",height:"100%",color:"white",...e}})}onUpdate(t){}resize(t,e){super.resize(t,e)}async show(){Qt.killTweensOf(this),this.alpha=0,await Qt.to(this,{alpha:1,duration:.2,ease:"linear"})}async hide(){Qt.killTweensOf(this),await Qt.to(this,{alpha:0,duration:.2,ease:"linear"})}}var It={},ai={};Object.defineProperty(ai,"__esModule",{value:!0});ai.Collector=void 0;class Vg{constructor(t){this.emit=(...e)=>{t.emitCollecting(this,e)}}}ai.Collector=Vg;var an={};Object.defineProperty(an,"__esModule",{value:!0});an.CollectorArray=void 0;const zg=ai;class Hg extends zg.Collector{constructor(){super(...arguments),this.result=[]}handleResult(t){return this.result.push(t),!0}getResult(){return this.result}reset(){this.result.length=0}}an.CollectorArray=Hg;var hn={};Object.defineProperty(hn,"__esModule",{value:!0});hn.CollectorLast=void 0;const Wg=ai;class Xg extends Wg.Collector{handleResult(t){return this.result=t,!0}getResult(){return this.result}reset(){delete this.result}}hn.CollectorLast=Xg;var ln={};Object.defineProperty(ln,"__esModule",{value:!0});ln.CollectorUntil0=void 0;const $g=ai;class jg extends $g.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,this.result}getResult(){return this.result}reset(){this.result=!1}}ln.CollectorUntil0=jg;var cn={};Object.defineProperty(cn,"__esModule",{value:!0});cn.CollectorWhile0=void 0;const Yg=ai;class qg extends Yg.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,!this.result}getResult(){return this.result}reset(){this.result=!1}}cn.CollectorWhile0=qg;var un={},dn={};Object.defineProperty(dn,"__esModule",{value:!0});dn.SignalConnectionImpl=void 0;class Kg{constructor(t,e){this.link=t,this.parentCleanup=e}disconnect(){return this.link!==null?(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0):!1}set enabled(t){this.link&&this.link.setEnabled(t)}get enabled(){return this.link!==null&&this.link.isEnabled()}}dn.SignalConnectionImpl=Kg;var fn={};Object.defineProperty(fn,"__esModule",{value:!0});fn.SignalLink=void 0;class xa{constructor(t=null,e=null,s=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=t??this,this.next=e??this,this.order=s}isEnabled(){return this.enabled&&!this.newLink}setEnabled(t){this.enabled=t}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(t,e){let s=this.prev;for(;s!==this&&!(s.order<=e);)s=s.prev;const r=new xa(s,s.next,e);return r.callback=t,s.next=r,r.next.prev=r,r}}fn.SignalLink=xa;Object.defineProperty(un,"__esModule",{value:!0});un.Signal=void 0;const Zg=dn,Jg=fn;class Qg{constructor(){this.head=new Jg.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(t,e=0){this.connectionsCount++;const s=this.head.insert(t,e);return this.emitDepth>0&&(this.hasNewLinks=!0,s.newLink=!0),new Zg.SignalConnectionImpl(s,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(t){for(let e=this.head.next;e!==this.head;e=e.next)if(e.callback===t)return this.decrementConnectionCount(),e.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...t){this.emitDepth++;for(let e=this.head.next;e!==this.head;e=e.next)e.isEnabled()&&e.callback&&e.callback.apply(null,t);this.emitDepth--,this.unsetNewLink()}emitCollecting(t,e){this.emitDepth++;for(let s=this.head.next;s!==this.head;s=s.next)if(s.isEnabled()&&s.callback){const r=s.callback.apply(null,e);if(!t.handleResult(r))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let t=this.head.next;t!==this.head;t=t.next)t.newLink=!1;this.hasNewLinks=!1}}}un.Signal=Qg;var pn={};Object.defineProperty(pn,"__esModule",{value:!0});pn.SignalConnections=void 0;class tm{constructor(){this.list=[]}add(t){this.list.push(t)}disconnectAll(){for(const t of this.list)t.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}}pn.SignalConnections=tm;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.SignalConnections=i.Signal=i.CollectorWhile0=i.CollectorUntil0=i.CollectorLast=i.CollectorArray=i.Collector=void 0;var t=ai;Object.defineProperty(i,"Collector",{enumerable:!0,get:function(){return t.Collector}});var e=an;Object.defineProperty(i,"CollectorArray",{enumerable:!0,get:function(){return e.CollectorArray}});var s=hn;Object.defineProperty(i,"CollectorLast",{enumerable:!0,get:function(){return s.CollectorLast}});var r=ln;Object.defineProperty(i,"CollectorUntil0",{enumerable:!0,get:function(){return r.CollectorUntil0}});var n=cn;Object.defineProperty(i,"CollectorWhile0",{enumerable:!0,get:function(){return n.CollectorWhile0}});var o=un;Object.defineProperty(i,"Signal",{enumerable:!0,get:function(){return o.Signal}});var a=pn;Object.defineProperty(i,"SignalConnections",{enumerable:!0,get:function(){return a.SignalConnections}})})(It);let va=class{constructor(t){this.view=t,this.createEvents(),this.enabled=!0}down(t){}up(t){}hover(t){}press(t){}out(t){}upOut(t){}get isDown(){return this._isDown}set enabled(t){this._enabled=t,this.view.eventMode=t?"static":"auto",this.view.cursor=t?"pointer":"default",t||this._processUp()}get enabled(){return this._enabled}_processUp(t){this._isDown&&this.onUp.emit(this,t),this._isDown=!1}_processUpOut(t){this._isDown&&(this.onUp.emit(this,t),this.onUpOut.emit(this,t)),this._isDown=!1}_processOut(t){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,t))}_upOut(t){this.upOut(t)}_out(t){this.out(t)}createEvents(){this.onPress=new It.Signal,this.onDown=new It.Signal,this.onUp=new It.Signal,this.onHover=new It.Signal,this.onOut=new It.Signal,this.onUpOut=new It.Signal,this.view.on("pointerdown",t=>{this._isDown=!0,this.onDown.emit(this,t)}),this.view.on("pointerup",t=>{this._processUp(t)}),this.view.on("pointerupoutside",t=>{this._processUpOut(t)}),this.view.on("pointerout",t=>{this._processOut(t)}),this.view.on("pointertap",t=>{this._isDown=!1,this.onPress.emit(this,t),this.press(t)}),this.view.on("pointerover",t=>{this._isMouseIn=!0,this.onHover.emit(this,t)}),this.onDown.connect((t,e)=>{this.down(e)}),this.onUp.connect((t,e)=>{this.up(e)}),this.onUpOut.connect((t,e)=>{this._upOut(e)}),xi.any||this.onHover.connect((t,e)=>{this.hover(e)}),this.onOut.connect((t,e)=>{this._out(e)})}};function Jt(i){return typeof i=="string"?H.from(i):i}class em extends et{constructor(t,e,s=0){super(),this.active=0,this.innerView=new et,this.addChild(this.innerView),this.active=s,t.map((r,n)=>{const o=Jt(r);return this.innerView.addChild(o),o.visible=n===s,o}),this.onChange=new It.Signal,e?Array.isArray(e)?this.triggerEvents=new Set(e):this.triggerEvents=new Set([e]):this.triggerEvents=new Set(["onPress"]),this.events=new va(this),this.events.onPress.connect(()=>this.switch(this.nextActive,"onPress")),this.events.onDown.connect(()=>this.switch(this.nextActive,"onDown")),this.events.onUp.connect(()=>this.switch(this.nextActive,"onUp")),this.events.onHover.connect(()=>this.switch(this.nextActive,"onHover")),this.events.onOut.connect(()=>this.switch(this.nextActive,"onOut")),this.events.onUpOut.connect(()=>this.switch(this.nextActive,"onUpOut"))}get activeView(){return this.views[this.active]}get views(){return this.innerView.children}switch(t,e){if(!this.triggerEvents.has(e))return;this.activeView.visible=!1,this.active=t!==void 0?t:this.nextActive;const s=this.views[this.active];s.visible=!0;const r=this.views.length>2?this.active:this.active===1;this.onChange.emit(r)}forceSwitch(t){this.activeView.visible=!1,this.active=t!==void 0?t:this.nextActive;const e=this.views[this.active];e.visible=!0}get nextActive(){return this.active<this.views.length-1?this.active+1:0}}let zc=class extends em{constructor(t){var r,n,o;const e=Jt(t.style.unchecked),s=Jt(t.style.checked);super([e,s],["onPress"],t.checked?1:0),this.label=new Vt(t.text??"",t.style.text),this.label.visible=((r=t.text)==null?void 0:r.length)>0,this.label.x=e.width+10+(((n=t.style.textOffset)==null?void 0:n.x)??0),this.label.y=(e.height-this.label.height)/2+(((o=t.style.textOffset)==null?void 0:o.y)??0),this.addChild(this.label),this.onCheck=new It.Signal,this.onChange.connect(()=>this.onCheck.emit(this.checked))}get checked(){return this.active===1}set checked(t){this.switch(t?1:0,"onPress")}forceCheck(t){this.forceSwitch(t?1:0)}};class zo extends et{constructor({bg:t,fill:e,fillOffset:s,progress:r}){if(super(),this.progressStart=0,this._progress=0,this.innerView=new et,this.addChild(this.innerView),this.bg=new et,this.bg.addChild(Jt(t)),this.innerView.addChild(this.bg),e){this.fill=new et,this.fill.addChild(Jt(e));const n=(s==null?void 0:s.x)??0,o=(s==null?void 0:s.y)??0;this.fill.x=(this.bg.width-this.fill.width)/2+n,this.fill.y=(this.bg.height-this.fill.height)/2+o,this.fillMask=new ve,this.fill.addChild(this.fillMask),this.fill.mask=this.fillMask,this.addChild(this.fill)}this.progress=r}validate(t){return t=Math.round(t),t<0?0:t>100?100:t}set progress(t){this._progress=this.validate(t);const e=this.bg.width/100*this.progressStart,s=this.bg.width/100*this._progress-e;this.fillMask&&this.fillMask.clear().lineStyle(0).beginFill(16777215).drawRect(e,0,s,this.fill.height)}get progress(){return this._progress}}class im extends zo{constructor(t){super({bg:t.bg,fill:t.fill??t.bg,fillOffset:t.fillOffset}),this.dragging=0,this.min=0,this.max=100,t.slider1&&(this.slider1=this.createSlider(t.slider1),t.showValue&&(this.value1Text=new Vt("",t.valueTextStyle||{fill:16777215}),this.value1Text.anchor.set(.5),this.addChild(this.value1Text))),t.slider2&&(this.slider2=this.createSlider(t.slider2),t.showValue&&(this.value2Text=new Vt("",t.valueTextStyle||{fill:16777215}),this.value2Text.anchor.set(.5),this.addChild(this.value2Text))),this.min=t.min??0,this.max=t.max??100,this.activate()}activate(){this.bg.eventMode="static",this.bg.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this),this.slider1&&(this.slider1.eventMode="static",this.slider1.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this)),this.slider2&&(this.slider2.eventMode="static",this.slider2.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this)),this.value1Text&&(this.fill.eventMode="none"),this.value1Text&&(this.value1Text.eventMode="none"),this.value2Text&&(this.value2Text.eventMode="none")}createSlider(t){const e=Jt(t);e.x=e.width/2;const s=new et;return s.addChild(e),e instanceof H&&e.anchor.set(.5),s.y=this.bg.height/2,this.addChild(s),s}startUpdate(t){this.dragging=1,this.startUpdateValue1=this._value1,this.startUpdateValue2=this._value2,this.update(t)}endUpdate(){this.dragging&&(this.dragging=0,(this.startUpdateValue1!==this._value1||this.startUpdateValue2!==this._value2)&&this.change(),this.startUpdateValue1=null,this.startUpdateValue2=null)}update(t){}change(){}}function sm(i){return typeof i=="string"||typeof i=="number"?new Vt(String(i)):i}function Fh(i,t,e=0){let s=t.scale.x,r=t.scale.y;const n=i.width-e*2,o=i.height-e*2,a=n-Math.round(t.width),h=o-Math.round(t.height);a<0&&(s=n/(t.width*s)),h<0&&(r=o/(t.height*r)),(s<=0||r<=0)&&(t.visible=!1),t.scale.set(Math.min(s,r))}/*!
 * tweedle.js - v2.0.1
 * Compiled Tue, 20 Dec 2022 14:21:53 UTC
 *
 * tweedle.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2021, Milton Candelero <miltoncandelero@gmail.com>, All Rights Reserved
 */let Ss;typeof self>"u"&&typeof process<"u"&&process.hrtime?Ss=function(){const i=process.hrtime();return i[0]*1e3+i[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?Ss=self.performance.now.bind(self.performance):Date.now!==void 0?Ss=Date.now:Ss=function(){return new Date().getTime()};class pe{constructor(){pe.prototype.__init.call(this),pe.prototype.__init2.call(this),pe.prototype.__init3.call(this),pe.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return pe._shared||(pe._shared=new pe),pe._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=Ss}getAll(){return Object.keys(this._tweens).map(t=>this._tweens[t])}removeAll(){this._tweens={}}add(t){this._tweens[t.getId()]=t}remove(t){delete this._tweens[t.getId()]}update(t,e=!1){if(t==null&&(this._lastUpdateTime==null?(this._lastUpdateTime=this.now(),t=0):t=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;const s=Object.keys(this._tweens);if(s.length==0)return!1;for(let r=0;r<s.length;r++){const n=this._tweens[s[r]];n&&n.update(t,!0)==!1&&!e&&delete this._tweens[s[r]]}return!0}}const Sr={Step:{None(i){return i<.5?0:1}},Linear:{None(i){return i}},Quadratic:{In(i){return i*i},Out(i){return i*(2-i)},InOut(i){return(i*=2)<1?.5*i*i:-.5*(--i*(i-2)-1)}},Cubic:{In(i){return i*i*i},Out(i){return--i*i*i+1},InOut(i){return(i*=2)<1?.5*i*i*i:.5*((i-=2)*i*i+2)}},Quartic:{In(i){return i*i*i*i},Out(i){return 1- --i*i*i*i},InOut(i){return(i*=2)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2)}},Quintic:{In(i){return i*i*i*i*i},Out(i){return--i*i*i*i*i+1},InOut(i){return(i*=2)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2)}},Sinusoidal:{In(i){return 1-Math.cos(i*Math.PI/2)},Out(i){return Math.sin(i*Math.PI/2)},InOut(i){return .5*(1-Math.cos(Math.PI*i))}},Exponential:{In(i){return i==0?0:Math.pow(1024,i-1)},Out(i){return i==1?1:1-Math.pow(2,-10*i)},InOut(i){return i==0?0:i==1?1:(i*=2)<1?.5*Math.pow(1024,i-1):.5*(-Math.pow(2,-10*(i-1))+2)}},Circular:{In(i){return 1-Math.sqrt(1-i*i)},Out(i){return Math.sqrt(1- --i*i)},InOut(i){return(i*=2)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)}},Elastic:{In(i){return i==0?0:i==1?1:-Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI)},Out(i){return i==0?0:i==1?1:Math.pow(2,-10*i)*Math.sin((i-.1)*5*Math.PI)+1},InOut(i){return i==0?0:i==1?1:(i*=2,i<1?-.5*Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI):.5*Math.pow(2,-10*(i-1))*Math.sin((i-1.1)*5*Math.PI)+1)}},Back:{In(i){return i*i*((1.70158+1)*i-1.70158)},Out(i){return--i*i*((1.70158+1)*i+1.70158)+1},InOut(i){const t=2.5949095;return(i*=2)<1?.5*(i*i*((t+1)*i-t)):.5*((i-=2)*i*((t+1)*i+t)+2)}},Bounce:{In(i){return 1-Sr.Bounce.Out(1-i)},Out(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},InOut(i){return i<.5?Sr.Bounce.In(i*2)*.5:Sr.Bounce.Out(i*2-1)*.5+.5}}},V={Geom:{Linear(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=V.Utils.Linear;return t<0?n(i[0],i[1],s):t>1?n(i[e],i[e-1],e-s):n(i[r],i[r+1>e?e:r+1],s-r)},Bezier(i,t){let e=0;const s=i.length-1,r=Math.pow,n=V.Utils.Bernstein;for(let o=0;o<=s;o++)e+=n(s,o)*r(1-t,s-o)*r(t,o)*i[o];return e},QuadraticBezier(i,t){let e=0;const s=i.length-1;if(t==1)return i[s];const r=Math.pow,n=V.Utils.Bernstein,o=s*t,a=Math.floor(o),h=(o-a)*.5+.5*(a%2),l=a-a%2,c=l+1,d=l+2;return e+=n(2,0)*r(1-h,2-0)*r(h,0)*i[l],e+=n(2,1)*r(1-h,2-1)*r(h,1)*i[c],e+=n(2,2)*r(1-h,2-2)*r(h,2)*i[d],e},CubicBezier(i,t){let e=0;const s=i.length-1;if(t==1)return i[s];const r=Math.pow,n=V.Utils.Bernstein,o=s*t,a=Math.floor(o),h=(o-a)*(1/3)+1/3*(a%3),l=a-a%3,c=l+1,d=l+2,u=l+3;return e+=n(3,0)*r(1-h,3-0)*r(h,0)*i[l],e+=n(3,1)*r(1-h,3-1)*r(h,1)*i[c],e+=n(3,2)*r(1-h,3-2)*r(h,2)*i[d],e+=n(3,3)*r(1-h,3-3)*r(h,3)*i[u],e},CatmullRom(i,t){const e=i.length-1;let s=e*t,r=Math.floor(s);const n=V.Utils.CatmullRom;return i[0]==i[e]?(t<0&&(r=Math.floor(s=e*(1+t))),n(i[(r-1+e)%e],i[r],i[(r+1)%e],i[(r+2)%e],s-r)):t<0?i[0]-(n(i[0],i[0],i[1],i[1],-s)-i[0]):t>1?i[e]-(n(i[e],i[e],i[e-1],i[e-1],s-e)-i[e]):n(i[r?r-1:0],i[r],i[e<r+1?e:r+1],i[e<r+2?e:r+2],s-r)}},Angle:{Radians(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=V.Utils.WrapLinear;return t<0?n(i[0],i[1],s,2*Math.PI):t>1?n(i[e],i[e-1],e-s,2*Math.PI):n(i[r],i[r+1>e?e:r+1],s-r,2*Math.PI)},Degrees(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=V.Utils.WrapLinear;return t<0?n(i[0],i[1],s,360):t>1?n(i[e],i[e-1],e-s,360):n(i[r],i[r+1>e?e:r+1],s-r,360)}},Color:{RGB(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=V.Utils.RGBLinear;return t<0?n(i[0],i[1],s):t>1?n(i[e],i[e-1],e-s):n(i[r],i[r+1>e?e:r+1],s-r)},HSV(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=V.Utils.HSVLinear;return t<0?n(i[0],i[1],s):t>1?n(i[e],i[e-1],e-s):n(i[r],i[r+1>e?e:r+1],s-r)},HCL(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=V.Utils.HCLLinear;return t<0?n(i[0],i[1],s):t>1?n(i[e],i[e-1],e-s):n(i[r],i[r+1>e?e:r+1],s-r)}},Utils:{RGBsplit(i){const t=i>>24&255,e=i>>16&255,s=i>>8&255,r=i&255;return{a:t,r:e,g:s,b:r}},HSVsplit(i){const t=V.Utils.RGBsplit(i);t.r/=255,t.g/=255,t.b/=255;const e=Math.max(t.r,t.g,t.b),s=Math.min(t.r,t.g,t.b);let r;const n=e,o=e-s,a=e==0?0:o/e;if(e==s)r=0;else{switch(e){case t.r:r=(t.g-t.b)/o+(t.g<t.b?6:0);break;case t.g:r=(t.b-t.r)/o+2;break;case t.b:r=(t.r-t.g)/o+4;break}r/=6}return{a:t.a,h:r,s:a,v:n}},HSVJoin(i){let t,e,s;const r=Math.floor(i.h*6),n=i.h*6-r,o=i.v*(1-i.s),a=i.v*(1-n*i.s),h=i.v*(1-(1-n)*i.s);switch(r%6){case 0:t=i.v,e=h,s=o;break;case 1:t=a,e=i.v,s=o;break;case 2:t=o,e=i.v,s=h;break;case 3:t=o,e=a,s=i.v;break;case 4:t=h,e=o,s=i.v;break;case 5:t=i.v,e=o,s=a;break}return i.a<<24|t<<16|e<<8|s},HCLSplit(i){const s=.530454533953517,r=V.Utils.RGBsplit(i),n={a:r.a,h:0,c:0,l:0};let o=0;const a=Math.min(r.r,Math.min(r.g,r.b)),h=Math.max(r.r,Math.max(r.g,r.b));let l=3/100;return n.c=h-a,n.c!=0&&(o=Math.atan2(r.g-r.b,r.r-r.g)/Math.PI,l*=a/h),l=Math.exp(l),n.h=(o/2-Math.min(o%1,-o%1)/6)%1,n.c*=l,n.l=V.Utils.Linear(-a,h,l)/(s*2),n},HCLJoin(i){const s=.530454533953517,r={a:i.a,r:0,g:0,b:0};if(i.l!=0){let n=i.h;const o=i.c,a=i.l*s,h=Math.exp((1-o/(2*a))*(3/100)),l=(2*a-o)/(2*h-1),c=o/h,d=(n+Math.min(2*n%1/4,-2*n%1/8))*Math.PI*2;let u;n*=6,n<=.999?(u=Math.tan(d),r.r=1,r.g=u/(1+u)):n<=1.001?(r.r=1,r.g=1):n<=2?(u=Math.tan(d),r.r=(1+u)/u,r.g=1):n<=3?(u=Math.tan(d),r.g=1,r.b=1+u):n<=3.999?(u=Math.tan(d),r.g=1/(1+u),r.b=1):n<=4.001?(r.g=0,r.b=1):n<=5?(u=Math.tan(d),r.r=-1/u,r.b=1):(u=Math.tan(d),r.r=1,r.b=-u),r.r=r.r*c+l,r.g=r.g*c+l,r.b=r.b*c+l}return r.a<<24|r.r<<16|r.g<<8|r.b},WrapLinear(i,t,e,s){let r;return i=(i+s*Math.trunc(Math.abs(i/s)))%s,t=(t+s*Math.trunc(Math.abs(t/s)))%s,Math.abs(i-t)<=.5*s?r=V.Utils.Linear(i,t,e):(i<t?r=V.Utils.Linear(i+s,t,e):r=V.Utils.Linear(i,t+s,e),r=r%s),r},RGBLinear(i,t,e){const s=V.Utils.RGBsplit(i),r=V.Utils.RGBsplit(t),n=V.Utils.Linear(s.a,r.a,e),o=V.Utils.Linear(s.r,r.r,e),a=V.Utils.Linear(s.g,r.g,e),h=V.Utils.Linear(s.b,r.b,e);return n<<24|o<<16|a<<8|h},HSVLinear(i,t,e){const s=V.Utils.HSVsplit(i),r=V.Utils.HSVsplit(t);let n;Math.abs(s.h-r.h)<=.5?n=V.Utils.Linear(s.h,r.h,e):(s.h<r.h?n=V.Utils.Linear(s.h+1,r.h,e):n=V.Utils.Linear(s.h,r.h+1,e),n=n%1);const o=V.Utils.Linear(s.s,r.s,e),a=V.Utils.Linear(s.v,r.v,e),h=V.Utils.Linear(s.a,r.a,e);return V.Utils.HSVJoin({a:h,h:n,s:o,v:a})},HCLLinear(i,t,e){const s=V.Utils.HCLSplit(i),r=V.Utils.HCLSplit(t);let n;Math.abs(s.h-r.h)<=.5?n=V.Utils.Linear(s.h,r.h,e):(s.h<r.h?n=V.Utils.Linear(s.h+1,r.h,e):n=V.Utils.Linear(s.h,r.h+1,e),n=n%1);const o=V.Utils.Linear(s.c,r.c,e),a=V.Utils.Linear(s.l,r.l,e),h=V.Utils.Linear(s.a,r.a,e);return V.Utils.HSVJoin({a:h,h:n,s:o,v:a})},Linear(i,t,e){return(t-i)*e+i},Bernstein(i,t){const e=V.Utils.Factorial;return e(i)/e(t)/e(i-t)},Factorial:function(){const i=[1];return function(t){let e=1;if(i[t])return i[t];for(let s=t;s>1;s--)e*=s;return i[t]=e,e}}(),CatmullRom(i,t,e,s,r){const n=(e-i)*.5,o=(s-t)*.5,a=r*r,h=r*a;return(2*t-2*e+n+o)*h+(-3*t+3*e-2*n-o)*a+n*r+t}}};class gn{static __initStatic(){this._nextId=0}static nextId(){return gn._nextId++}}gn.__initStatic();class at{__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!==0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=t=>!0}__init15(){this._easingFunction=Sr.Linear.None}__init16(){this._yoyoEasingFunction=void 0}__init17(){this._interpolationFunction=V.Geom.Linear}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=gn.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:pe.shared}set _group(t){this._groupRef=t}constructor(t,e){at.prototype.__init.call(this),at.prototype.__init2.call(this),at.prototype.__init3.call(this),at.prototype.__init4.call(this),at.prototype.__init5.call(this),at.prototype.__init6.call(this),at.prototype.__init7.call(this),at.prototype.__init8.call(this),at.prototype.__init9.call(this),at.prototype.__init10.call(this),at.prototype.__init11.call(this),at.prototype.__init12.call(this),at.prototype.__init13.call(this),at.prototype.__init14.call(this),at.prototype.__init15.call(this),at.prototype.__init16.call(this),at.prototype.__init17.call(this),at.prototype.__init18.call(this),at.prototype.__init19.call(this),at.prototype.__init20.call(this),at.prototype.__init21.call(this),at.prototype.__init22.call(this),this._object=t,this._group=e}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(t){try{JSON.stringify(t)}catch{throw new Error("The object you provided to the from() method has a circular reference!")}return this._setupProperties(t,this._valuesStart,t,this._valuesStartRepeat,!0),this}to(t,e){try{this._valuesEnd=JSON.parse(JSON.stringify(t))}catch{return console.warn("The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting"),this.dynamicTo(t,e)}return e!==void 0&&(this._duration=e),this}dynamicTo(t,e){return this._valuesEnd=t,e!==void 0&&(this._duration=e),this}duration(t){return this._duration=t,this}start(t){return this._isPlaying?this:(t!=null&&(this._delayTime=t),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1),this)}restart(t){return this.reset(),this.start(t)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);const t=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,t),this}_setupProperties(t,e,s,r,n){for(const o in s){const a=t[o],h=Array.isArray(a),l=!Number.isNaN(Number(a)),c=h?"array":typeof a,d=c=="object",u=typeof s[o]=="object",p=!h&&Array.isArray(s[o]);c=="undefined"||c=="function"||s[o]==null||!h&&!l&&!d||((d||h||u)&&a&&!p?(typeof e[o]>"u"&&(e[o]=h?[]:{}),typeof r[o]>"u"&&(r[o]=h?[]:{}),this._setupProperties(a,e[o],s[o],r[o],n)):((typeof e[o]>"u"||n)&&(e[o]=a),(typeof r[o]>"u"||n)&&(p?r[o]=s[o].slice().reverse()[0]:r[o]=e[o]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(t=!1){let e=[];if(t||(e=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!t){this._chainedTweens=e;for(let s=0,r=this._chainedTweens.length;s<r;s++)this._chainedTweens[s].start()}return this}skip(t,e=!1){return this.resume(),this.update(t*this._duration-(e?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._group.remove(this),this)}resume(){return!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._group.add(this),this)}stopChainedTweens(){for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this}startChainedTweens(t=!1){t&&this.stop();for(let e=0,s=this._chainedTweens.length;e<s;e++)this._chainedTweens[e].start();return this}group(t){return this._group=t,this}delay(t){return this._delayTime=t,this}timescale(t){return this._timescale=t,this}repeat(t=1/0){return this._repeat=t,this}repeatDelay(t){return this._repeatDelayTime=t,this}yoyo(t=!0){return this._yoyo=t,this}easing(t){return this._easingFunction=t,this}safetyCheck(t){return this._safetyCheckFunction=t,this}yoyoEasing(t){return this._yoyoEasingFunction=t,this}interpolation(t){return this._interpolationFunction=t,this}chain(...t){return this._chainedTweens=t,this}onStart(t){return this._onStartCallback=t,this}onAfterDelay(t){return this._onAfterDelayCallback=t,this}onUpdate(t){return this._onUpdateCallback=t,this}onRepeat(t){return this._onRepeatCallback=t,this}onComplete(t){return this._onCompleteCallback=t,this}onStop(t){return this._onStopCallback=t,this}update(t,e=!1){const s=this._internalUpdate(t);return!s&&!e&&this._group.remove(this),s}_internalUpdate(t){if(!this._safetyCheckFunction(this._object)||this._isPaused)return!1;t*=this._timescale;let e;this._elapsedTime+=t;const s=this._duration,r=this._startTime+this._elapsedTime;if(r>s&&!this._isPlaying)return!1;this.isPlaying||this.start(),this._onStartCallbackFired==!1&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),this._onAfterDelayCallbackFired==!1&&r>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),e=r/this._duration,this._duration==0&&(r>=0?e=1:e=0),e=Math.min(1,e),e=Math.max(0,e);let n=Number.isFinite(r)?r%this._duration:r;Number.isNaN(n)&&(n=0);const o=Math.floor(r/this._duration);let a;if(this._reversed&&this._yoyoEasingFunction?a=this._yoyoEasingFunction(e):a=this._easingFunction(e),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,a),this._onUpdateCallback&&(e!=1||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,e,this),e==1){if(this._repeat-this._repeatCount>0){const h=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+o),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||n<=0)&&this._onUpdateCallback(this._object,e,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),this._repeatDelayTime!==void 0?this._startTime=-this._repeatDelayTime:this._startTime=0,this._onRepeatCallback){let l=1;Number.isFinite(o)?l=this._repeatCount-h:Number.isFinite(this._repeat)&&(l=this._repeat-h);for(let c=0;c<l;c++)this._onRepeatCallback(this._object,h+1+c,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return n>0&&Number.isFinite(this._repeat)&&this._internalUpdate(n),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let h=0,l=this._chainedTweens.length;h<l;h++)this._chainedTweens[h].start(),n>0&&this._chainedTweens[h].update(n);return this._isPlaying=!1,!1}return!0}_updateProperties(t,e,s,r){for(const n in s){if(e[n]==null)continue;const o=e[n];let a=s[n];const h=Array.isArray(t[n]),l=Array.isArray(a);!h&&l?this._reversed?t[n]=this._interpolationFunction(a.concat([o]),r):t[n]=this._interpolationFunction([o].concat(a),r):typeof a=="object"&&a?this._updateProperties(t[n],o,a,r):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(typeof o=="number"||typeof o=="string")&&(t[n]=Number(o)+(a-Number(o))*r,typeof o=="string"&&(t[n]=String(t[n]))))}}_handleRelativeValue(t,e){return typeof e!="string"?e:e.charAt(0)=="+"||e.charAt(0)=="-"?t+Number(e):Number(e)}_swapEndStartRepeatValues(t,e){for(const s in t){const r=!Array.isArray(t[s])&&Array.isArray(e[s]);if(typeof t[s]=="object")this._swapEndStartRepeatValues(t[s],e[s]);else{const n=t[s];if(typeof e[s]=="string")t[s]=Number(t[s])+Number(e[s]),e[s]=n;else if(r){const o=e[s].slice().reverse();t[s]=o[0],e[s]=o}else t[s]=e[s],e[s]=n}}}_moveForwardStartRepeatValues(t,e){for(const s in t)typeof e[s]=="object"?this._moveForwardStartRepeatValues(t[s],e[s]):typeof e[s]=="string"&&(t[s]=Number(t[s])+Number(e[s]))}}class mn extends et{constructor({defaultView:t,hoverView:e,pressedView:s,disabledView:r,text:n,padding:o,offset:a,textOffset:h,iconOffset:l,scale:c,anchor:d,anchorX:u,anchorY:p,icon:f,animations:g}){super(),this.defaultDuration=100,this.createViews({defaultView:t,hoverView:e,pressedView:s,disabledView:r,text:n,icon:f}),this.anchor=new Ye(this.updateAnchor,this),this.anchor.set(u??d??0,p??d??0),this.padding=o??0,this.offset=a,this.textOffset=h,this.iconOffset=l,this.scale.set(c??1),g&&(this.animations=g,Ut.shared.add(()=>pe.shared.update())),this.setState("default"),this.addEvents()}set text(t){this.textView.text=t,this.adjustTextView(this.state)}get text(){var t;return(t=this.textView)==null?void 0:t.text}set enabled(t){this.events.enabled=t,this.setState(t?"default":"disabled")}get enabled(){return this.events.enabled}setState(t){if(this.state===t)return;const e=this.getStateView(this.state),s=this.getStateView(t);e.visible=!1,s.visible=!0,this.state=t,this.updateAnchor(),this.setOffset(s,t,this.offset),this.playAnimations(t)}createTextView(t){this.textView=sm(t),this.innerView.addChild(this.textView),this.textView.anchor.set(0),this.adjustTextView(this.state)}createIconView(t){this.iconView=Jt(t),this.innerView.addChild(this.iconView)}setOffset(t,e,s){const r=s?s[e]:{x:0,y:0},n=s==null?void 0:s.default;r?(t.x+=r.x??0,t.y+=r.y??0):n?(t.x+=n.x??0,t.y+=n.y??0):(s.x||s.y)&&(t.x+=s.x??0,t.y+=s.y??0)}getStateView(t){switch(t){case"hover":return this.hoverView??this.defaultView;case"pressed":return this.pressedView??this.defaultView;case"disabled":return this.disabledView??this.defaultView;case"default":default:return this.defaultView}}adjustTextView(t){if(!this.textView||(this.textView.visible=this.textView.text!=="",!this.textView.visible))return;const e=this.getStateView(this.state);Fh(e,this.textView,this.padding),this.textView.anchor.set(.5),this.textView.x=e.x+e.width/2,this.textView.y=e.y+e.height/2,this.setOffset(this.textView,t,this.textOffset)}adjustIconView(t){var s;if(!this.iconView)return;const e=this.getStateView(t);Fh(e,this.iconView,this.padding),(s=this.iconView.anchor)==null||s.set(0),this.iconView.x=e.x+e.width/2-this.iconView.width/2,this.iconView.y=e.y+e.height/2-this.iconView.height/2,this.setOffset(this.iconView,t,this.iconOffset)}updateAnchor(){const t=this.anchor.x??0,e=this.anchor.y??0;[this.defaultView,this.hoverView,this.pressedView,this.disabledView].forEach(h=>{var l;h&&((l=h.anchor)==null||l.set(0),h.x=-h.width*t,h.y=-h.height*e)});const{x:r,y:n,width:o,height:a}=this.defaultView;this.hitArea=new j(r,n,o,a),this.adjustIconView(this.state),this.adjustTextView(this.state)}createViews(t){const{defaultView:e,hoverView:s,pressedView:r,disabledView:n,text:o,icon:a}=t;this.innerView=new et,this.addChild(this.innerView),this.defaultView=Jt(e),this.innerView.addChild(this.defaultView),s&&(this.hoverView=Jt(s),this.innerView.addChild(this.hoverView),this.hoverView.visible=!1),r&&(this.pressedView=Jt(r),this.innerView.addChild(this.pressedView),this.pressedView.visible=!1),n&&(this.disabledView=Jt(n),this.innerView.addChild(this.disabledView),this.disabledView.visible=!1),a&&this.createIconView(a),o&&this.createTextView(o)}addEvents(){this.events=new va(this),this.onPress=new It.Signal,this.onDown=new It.Signal,this.onUp=new It.Signal,this.onHover=new It.Signal,this.onOut=new It.Signal,this.onUpOut=new It.Signal,this.events.onPress.connect((t,e)=>{this.onPress.emit(this,e),this.press(),this.setState("hover")}),this.events.onDown.connect((t,e)=>{this.onDown.emit(this,e),this.down(),this.setState("pressed")}),this.events.onUp.connect((t,e)=>{this.onUp.emit(this,e),this.up(),this.setState("hover")}),this.events.onHover.connect((t,e)=>{this.onHover.emit(this,e),this.hover(),this.setState("hover")}),this.events.onOut.connect((t,e)=>{this.onOut.emit(this,e),this.out(),this.setState("default")}),this.events.onUpOut.connect((t,e)=>{this.onUpOut.emit(this,e),this.upOut(),this.setState("default")})}playAnimations(t){var s;if(!this.animations)return;if(t==="default"){this.originalInnerViewState||(this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}});const r=(s=this.animations)==null?void 0:s.default;if(r){this.innerView.x=r.props.x??this.originalInnerViewState.x,this.innerView.y=r.props.y??this.originalInnerViewState.y,this.innerView.width=r.props.width??this.originalInnerViewState.width,this.innerView.height=r.props.height??this.originalInnerViewState.height,this.innerView.scale.x=r.props.scale.x??this.originalInnerViewState.scale.x,this.innerView.scale.y=r.props.scale.y??this.originalInnerViewState.scale.y;return}}if(this.animations[t]??this.animations.default){const r=this.animations[t];this.defaultDuration=r.duration,new at(this.innerView).to(r.props,r.duration).start();return}new at(this.innerView).to(this.originalInnerViewState,this.defaultDuration).start()}down(t){}up(t){}hover(t){}press(t){}out(t){}upOut(t){}}class Hc extends et{constructor(t){super(),this.children=[],this.options=t,t!=null&&t.type&&(this.type=t.type),t!=null&&t.children&&t.children.map(e=>this.addChild(e)),this.on("added",()=>this.arrangeChildren())}onChildrenChange(){this.arrangeChildren()}arrangeChildren(){var n,o,a,h,l;let t=((n=this.options)==null?void 0:n.horPadding)??0,e=((o=this.options)==null?void 0:o.vertPadding)??0;const s=((a=this.options)==null?void 0:a.elementsMargin)??0,r=((h=this.parent)==null?void 0:h.width)-((l=this.options)==null?void 0:l.horPadding);this.children.forEach((c,d)=>{var u;switch(this.type){case"vertical":c.y=e,c.x=t,e+=s+c.height;break;case"horizontal":c.x=t,c.y=e,t+=s+c.width;break;default:c.x=t,c.y=e,c.x+c.width>=r&&d>0&&(e+=s+c.height,t=((u=this.options)==null?void 0:u.horPadding)??0,c.x=t,c.y=e),t+=s+c.width;break}})}}class rm extends ve{constructor({target:t,mask:e,borderWidth:s,borderColor:r}){if(super(),this.borderColor=r,this.borderWidth=s,this.target=Jt(t),this.targetMask=Jt(e),this.target.addChild(this.targetMask),this.target.mask=this.targetMask,s){this.showBorder(),this.target.x=s,this.target.y=s;const n=typeof e=="string"?new H(U.from(e)):e.clone();n.width+=s*2,n.height+=s*2,this.mask=n,this.addChild(n)}this.addChild(this.target)}showBorder(){this.beginFill(this.borderColor);const t=this.borderWidth*2;this.drawRect(0,0,this.target.width+t,this.target.height+t)}hideBorder(){this.clear()}}class nm extends et{constructor(t){super(),this.items=[],this.options=t,this.value=t.items[t.selectedItem||0].label.text,this.selected=t.selectedItem??0,this.innerView=new Hc({type:t.type,elementsMargin:t.elementsMargin}),t.items.forEach((e,s)=>{e.onChange.connect(()=>this.selectItem(s)),this.items.push(e),this.innerView.addChild(e)}),this.selectItem(this.selected),this.addChild(this.innerView),this.onChange=new It.Signal}selectItem(t){this.items.forEach((e,s)=>{e.forceCheck(s===t)}),this.selected!==t&&this.onChange.emit(t,this.items[t].label.text),this.value=this.options.items[t].label.text,this.selected=t}}class om{constructor(t={}){this.x=0,this.ax=0,this.dx=0,this.tx=0,this._options=t,this._options.max=t.max||160,this._options.damp=t.damp||.8,this._options.springiness=t.springiness||.1}update(){this.ax=(this.tx-this.x)*this._options.springiness,this.dx+=this.ax,this.dx*=this._options.damp,this.dx<-this._options.max?this.dx=-this._options.max:this.dx>this._options.max&&(this.dx=this._options.max),this.x+=this.dx}reset(){this.x=0,this.ax=0,this.dx=0,this.tx=0}get max(){return this._options.max}set max(t){this._options.max=t}get damp(){return this._options.damp}set damp(t){this._options.damp=t}get springiness(){return this._options.springiness}set springiness(t){this._options.springiness=t}}class Wc{constructor(){this._spring=new om,this._pos=0,this.to=0}start(t,e,s){this._speed=t,this._pos=e,this.to=s,this.done=!1,this._spring.x=this._pos,this._spring.tx=this.to;const r=this.to-this._pos,n=Math.abs(r)/r,o=Math.abs(this._speed)/this._speed;n!==o?this._correctSpeed=!0:this._correctSpeed=!1}update(){if(this._correctSpeed)this._speed*=.6,Math.abs(this._speed)<2&&(this._correctSpeed=!1),this._pos+=this._speed,this._spring.x=this._pos;else{const t=this.to-this._pos;Math.abs(t)<.05?(this._pos=this.to,this.done=!0):(this._spring.tx=this.to,this._spring.update(),this._pos=this._spring.x)}return this._pos}cancel(){}}class Nh{constructor(t={}){this.position=0,this.constrain=!0,this.min=0,this.max=0,this.maxSpeed=400,this._offset=0,this._prev=0,this._speed=0,this._targetSpeed=0,this._speedChecker=0,this._grab=0,this.constrain=t.constrain??!0,this.maxSpeed=t.maxSpeed??400,this._ease=t.ease??new Wc}set value(t){this._speed=0,this.position=t}get value(){return this.position}grab(t){this._grab=t,this._offset=this.position-t,this._speedChecker=0,this._targetSpeed=this._speed=0,this._hasStopped=!1}hold(t){this._speedChecker++,this.position=t+this._offset,this._speedChecker>1&&(this._targetSpeed=this.position-this._prev),this._speed+=(this._targetSpeed-this._speed)/2,this._speed>this.maxSpeed?this._speed=this.maxSpeed:this._speed<-this.maxSpeed&&(this._speed=-this.maxSpeed),this._prev=this.position,this.constrain&&(this._activeEase=null,this.position>this.min?this.position-=(this.position-this.min)/1.5:this.position<this.max&&(this.position+=(this.max-this.position)/1.5))}slide(){this._hasStopped||(this.constrain?this._updateConstrain():this._updateDefault())}get moveAmount(){return-(this.position-this._offset-this._grab)}_updateDefault(){this._speed*=.9,this.position+=this._speed,(this._speed<0?this._speed*-1:this._speed)<.01&&(this._hasStopped=!0)}_updateConstrain(){const t=this.max;this.position>this.min||this.position<t||this._activeEase?(this._activeEase||(this._activeEase=this._ease,this.position>this.min?this._activeEase.start(this._speed,this.position,this.min):this._activeEase.start(this._speed,this.position,t)),this.position=this._activeEase.update(),this._activeEase.done&&(this.position=this._activeEase.to,this._speed=0,this._activeEase=null)):this._updateDefault()}}class am{constructor(t){this.xAxis=new Nh({ease:t.xEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this.yAxis=new Nh({ease:t.yEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this._frame=new j,this._bounds=new j,this._globalPosition=new tt}pointerDown(t){this.xAxis.grab(t.x),this.yAxis.grab(t.y),this._isDown=!0}pointerUp(){this._isDown=!1}pointerMove(t){this._globalPosition=t}update(){this._dirty&&(this._dirty=!1,this.xAxis.min=this._bounds.left,this.xAxis.min=this._bounds.right-this._frame.width,this.xAxis.min=this._bounds.top,this.xAxis.min=this._bounds.bottom-this._frame.height),this._isDown?(this.xAxis.hold(this._globalPosition.x),this.yAxis.hold(this._globalPosition.y)):(this.xAxis.slide(),this.yAxis.slide())}resize(t,e){this._frame.x=0,this._frame.width=t,this._frame.y=0,this._frame.height=e,this._dirty=!0}setBounds(t,e,s,r){this._bounds.x=t,this._bounds.width=e-t,this._bounds.y=s,this._bounds.height=r-s,this._dirty=!0}get x(){return this.xAxis.value}get y(){return this.yAxis.value}}class Xc extends et{constructor(t){var s;super(),this.__width=0,this.__height=0,this.freeSlot={x:0,y:0},this.isDragging=0,this.interactiveStorage=[],this.ticker=Ut.shared,this.options=t,this.addBackground(),this.__width=t.width|this.background.width,this.__height=t.height|this.background.height,t.vertPadding||(t.vertPadding=t.padding??0),t.horPadding||(t.horPadding=t.padding??0),this.list=new Hc({type:t.type,elementsMargin:t.elementsMargin,vertPadding:t.vertPadding,horPadding:t.horPadding}),super.addChild(this.list),(s=t.items)!=null&&s.length&&t.items.forEach(r=>{this.addItem(r)}),this.hasBounds&&(this.addMask(),this.makeScrollable()),this.onMouseScrollBinded=this.onMouseScroll.bind(this);const e=new Wc;this._trackpad=new am({constrain:!0,yEase:e}),this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0,this.resize(),this.ticker.add(this.update,this)}get hasBounds(){return!!this.__width||!!this.__height}onChildrenChange(){}addItem(...t){var e;if(t.length>1)t.forEach(s=>this.addItem(s));else{const s=t[0];(!s.width||!s.height)&&console.error("ScrollBox item should have size"),s.x=this.freeSlot.x,s.y=this.freeSlot.y,this.list.addChild(s),this.options.disableDynamicRendering||(s.renderable=this.isItemVisible(s));const r=((e=this.options)==null?void 0:e.elementsMargin)??0;switch(this.options.type){case"horizontal":this.freeSlot.x+=r+s.width;break;default:this.freeSlot.y+=r+s.height;break}}return this.resize(),t[0]}removeItem(t){const e=this.list.children[t];e&&(this.list.removeChild(e),this.resize())}isItemVisible(t){const e=this.options.type==="vertical"||!this.options.type;let s=!1;const r=this.list;if(e){const n=t.y+r.y;n+t.height+this.options.vertPadding>=0&&n-this.options.vertPadding-this.options.elementsMargin<=this.options.height&&(s=!0)}else{const n=t.x+r.x;n+t.width>=0&&n<=this.options.width&&(s=!0)}return s}get items(){var t;return((t=this.list)==null?void 0:t.children)??[]}addBackground(){this.background=typeof this.options.background=="string"?H.from(this.options.background):new ve,this.addChild(this.background),this.resize()}addMask(){this.borderMask=new ve,super.addChild(this.borderMask),this.mask=this.borderMask,this.resize()}makeScrollable(){this.on("pointerdown",s=>{this.isDragging=1,this._trackpad.pointerDown(s.global)}),this.on("pointerup",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreInteractivity()}),this.on("pointerupoutside",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreInteractivity()}),this.on("globalpointermove",s=>{this._trackpad.pointerMove(s.global),this.isDragging&&this.recursiveDisableInteractivity(this.items)});const{onMouseHover:t,onMouseOut:e}=this;this.on("mouseover",t,this).on("mouseout",e,this)}recursiveDisableInteractivity(t){t.forEach(e=>{e.interactive&&(this.interactiveStorage.push(e),e.eventMode="auto"),e instanceof et&&this.recursiveDisableInteractivity(e.children)})}restoreInteractivity(){this.interactiveStorage.forEach((t,e)=>{t.eventMode="static",delete this.interactiveStorage[e]})}setInteractive(t){this.eventMode=t?"static":"auto"}get listHeight(){return this.list.height+this.options.vertPadding*2}get listWidth(){return this.list.width+this.options.horPadding*2}resize(){if(this.renderAllItems(),this.borderMask&&(this.lastWidth!==this.listWidth||this.lastHeight!==this.listHeight)){const t=this.options.vertPadding,e=this.options.horPadding;this.options.width||(this.__width+=this.listWidth),this.options.height||(this.__height+=this.listHeight),this.borderMask.clear().lineStyle(0).beginFill(16777215).drawRoundedRect(0,0,this.__width,this.__height,this.options.radius|0),this.borderMask.eventMode="none",this.background instanceof ve&&typeof this.options.background=="number"&&this.background.clear().lineStyle(0).beginFill(this.options.background).drawRect(0,0,this.__width+e,this.__height+t),this.options.type==="horizontal"?this.setInteractive(this.listWidth>this.__width):this.setInteractive(this.listHeight>this.__height),this.lastWidth=this.listWidth,this.lastHeight=this.listHeight}if(this._trackpad){const t=this.borderMask.width-this.list.width-this.options.horPadding*2,e=this.borderMask.height-this.list.height-this.options.vertPadding*2;this.options.type==="vertical"?this._trackpad.yAxis.max=-Math.abs(e):this.options.type==="horizontal"?this._trackpad.xAxis.max=-Math.abs(t):(this._trackpad.yAxis.max=-Math.abs(e),this._trackpad.xAxis.max=-Math.abs(t))}this.stopRenderHiddenItems()}onMouseHover(){this.renderAllItems(),document.addEventListener("mousewheel",this.onMouseScrollBinded),document.addEventListener("DOMMouseScroll",this.onMouseScrollBinded)}onMouseOut(){this.stopRenderHiddenItems(),document.removeEventListener("mousewheel",this.onMouseScrollBinded),document.removeEventListener("DOMMouseScroll",this.onMouseScrollBinded)}onMouseScroll(t){if(this.renderAllItems(),this.options.type==="horizontal"&&(typeof t.deltaX<"u"||typeof t.deltaY<"u")){const e=t.deltaY?this.list.x-t.deltaY:this.list.x-t.deltaX;e<0&&e+this.listWidth+this.options.horPadding<this.__width?this._trackpad.xAxis.value=this.__width-this.listWidth:e>this.options.horPadding?this._trackpad.xAxis.value=0:this._trackpad.xAxis.value=e}else if(typeof t.deltaY<"u"){const e=this.list.y-t.deltaY;e<0&&e+this.listHeight+this.options.vertPadding<this.__height?this._trackpad.yAxis.value=this.__height-this.listHeight:e>this.options.vertPadding?this._trackpad.yAxis.value=0:this._trackpad.yAxis.value=e}this.stopRenderHiddenItems()}scrollBottom(){this.interactive?this.scrollTo(this.list.children.length-1):this.scrollTop()}scrollTop(){this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0}renderAllItems(){this.options.disableDynamicRendering||this.items.forEach(t=>{t.renderable=!0})}stopRenderHiddenItems(){this.options.disableDynamicRendering||this.items.forEach(t=>{t.renderable=this.isItemVisible(t)})}scrollTo(t){if(!this.interactive)return;const e=this.list.children[t];e&&(this._trackpad.xAxis.value=this.options.type==="horizontal"?this.__width-e.x-e.width-this.options.horPadding:0,this._trackpad.yAxis.value=!this.options.type||this.options.type==="vertical"?this.__height-e.y-e.height-this.options.vertPadding:0)}get height(){return this.__height}get width(){return this.__width}update(){this._trackpad.update(),this.options.type==="horizontal"?this.list.x!==this._trackpad.x?(this.renderAllItems(),this.list.x=this._trackpad.x):this.stopRenderHiddenItems():this.list.y!==this._trackpad.y?(this.renderAllItems(),this.list.y=this._trackpad.y):this.stopRenderHiddenItems()}}let hm=class extends im{constructor(t){super({bg:t.bg,slider1:t.slider,fill:t.fill??"",min:t.min,max:t.max,value1:t.value,valueTextStyle:t.valueTextStyle,showValue:t.showValue,valueTextOffset:t.valueTextOffset,fillOffset:t.fillOffset}),this.onUpdate=new It.Signal,this.onChange=new It.Signal,this.options=t,this.progress=((t.value??this.min)-this.min)/(this.max-this.min)*100,this.value=t.value??this.min}get value(){return this._value1}set value(t){var e,s,r;if(t!==this._value1){if(t<this.min&&(t=this.min),t>this.max&&(t=this.max),this._value1=t,this.slider1.x=(this.bg.width-this.slider1.width)/100*this.progress,this.options.showValue){this.value1Text.text=`${Math.round(this.value)}`;const n=this.slider1.x+this.slider1.width/2,o=this.slider1.y;this.value1Text.x=n+(((e=this.options.valueTextOffset)==null?void 0:e.x)??0),this.value1Text.y=o+(((s=this.options.valueTextOffset)==null?void 0:s.y)??0)}(r=this.onUpdate)==null||r.emit(this.value)}}update(t){if(!this.dragging)return;const e=t.currentTarget,{x:s}=e.parent.worldTransform.applyInverse(t.global);this.progress=this.validate(s/this.bg.width*100),this.value=this.min+(this.max-this.min)/100*this.progress}change(){var t;(t=this.onChange)==null||t.emit(this.value)}};const ft={bg:6734298,text:16777215,defaultStroke:8570914,hoverStroke:13932544,pressedStroke:13904914,disabledStroke:4671303,levelBG:16114601,border:16777215};class lm extends et{constructor(e){super();ot(this,"number");const s=H.from("Radio-hover");s.anchor.set(.5),this.number=new Vt(String(e),{fill:ft.text,fontSize:25,fontFamily:"debussy",stroke:ft.hoverStroke,strokeThickness:5}),this.number.anchor.set(.5),this.addChild(s,this.number)}}class $s extends mn{constructor(e,s,r=0){super({defaultView:"SmallButton",hoverView:"SmallButton-hover",pressedView:"SmallButton-pressed",disabledView:"SmallButton-disabled",icon:e,iconOffset:{y:-10},animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:100},pressed:{props:{scale:{x:.9,y:.9},y:10},duration:100}}});ot(this,"counter");this.onPress.connect(s),r&&(this.counter=new lm(r),this.counter.x=this.width/2-20,this.counter.y=-this.height/2+20,this.innerView.addChild(this.counter)),this.anchor.set(.5)}set notifications(e){this.counter.number.text=String(e)}}var zt=(i=>(i[i.pause=1]="pause",i[i.levels=2]="levels",i[i.settings=3]="settings",i[i.info=4]="info",i))(zt||{});class cm{constructor(){ot(this,"history",[]);ot(this,"windows",{});ot(this,"active")}add(t,e,s=!1){this.windows[t]=e,s||e.hide(!0)}remove(t){delete this.windows[t]}async show(t,e=!1){if(!this.windows[t])throw new Error(`Window "${zt[t]}" does not exist`);if(this.active!==t){this.history.push(t),this.active=t;for(const s in this.windows)await this.windows[s].hide();await this.windows[t].show(e)}}async hide(t,e=!1){await this.windows[t].hide(e)}get(t){return this.windows[t]}async goBack(){this.history.length>1&&this.history.pop(),await this.show(this.history[this.history.length-1])}}function $c(i){const t=window.location.search;return new URLSearchParams(t).get(i)}class um extends mn{constructor(t,e,s=!1){let r;s&&(r=H.from("LockIcon"));const n=s?void 0:new Vt(t,{fill:ft.text,fontSize:75,fontFamily:"debussy",stroke:ft.disabledStroke,strokeThickness:8});super({defaultView:"SmallButton",hoverView:"SmallButton-hover",pressedView:"SmallButton-pressed",disabledView:"SmallButton-disabled",text:n,icon:r,iconOffset:{y:-10},padding:11,animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:100},pressed:{props:{scale:{x:.9,y:.9},y:10},duration:100}}}),this.enabled=!s,this.scale.set(.9),this.anchor.set(.5),this.onPress.connect(e)}}class _n extends pt{constructor(t){super({id:`Window-${t.title}`,content:{ribbon:{content:{id:"title",content:t.title,styles:{color:"white",fontFamily:"debussy",fontSize:60,position:"center",marginTop:-6,stroke:ft.disabledStroke,strokeThickness:10,maxWidth:"83%",maxHeight:"70%",overflow:"hidden"}},styles:{background:H.from("Ribbon"),display:"inline",position:"topCenter",marginTop:-53,zIndex:100,...t.ribbonStyles}}},styles:{background:H.from("Window"),maxWidth:"100%",maxHeight:"100%",position:"center",marginTop:20,marginBottom:100,...t.styles}}),this.createContent()}createContent(){}async show(t=!1){if(this.alpha!==1){if(Qt.killTweensOf(this),t){this.alpha=1,this.visible=!0;return}this.alpha=0,this.y+=100,this.visible=!0,await Qt.to(this,{alpha:1,y:"-=100",duration:.2,ease:zr.easeOut.config(1.7)})}}async hide(t=!1){if(this.alpha!==0){if(Qt.killTweensOf(this),t){this.alpha=0,this.visible=!1;return}await Qt.to(this,{alpha:0,y:"+=100",duration:.2,ease:zr.easeIn.config(1.7)}),this.visible=!1,this.y-=100}}}class jc extends pt{constructor(e,s="down"){const r=s==="down"?H.from("HintDown"):H.from("Hint");super({content:{text:{content:e,styles:{position:s==="down"?"center":"centerTop",color:ft.text,fontSize:45,fontFamily:"debussy",stroke:ft.disabledStroke,strokeThickness:8,marginTop:18}}},styles:{position:"left",background:r,marginLeft:25,marginTop:120}});ot(this,"startY");this.startY=r.height-20}async show(e=!1){if(this.alpha!==1){if(Qt.killTweensOf(this),e){this.alpha=1;return}this.alpha=0,this.y=this.startY+20,await Qt.to(this,{alpha:1,y:"-=20",duration:.2,ease:zr.easeOut.config(1.7)})}}async hide(e=!1){if(this.alpha!==0){if(Qt.killTweensOf(this),e){this.alpha=0;return}await Qt.to(this,{alpha:0,y:"+=20",duration:.2,ease:zr.easeIn.config(1.7)}),this.y=this.startY-20}}}class gr extends pt{constructor(t,e,s,r=0){const n=new $s(t,s,r),o=new jc(e);o.hide(!0),n.onHover.connect(()=>o.show()),n.onOut.connect(()=>o.hide()),super({content:{button:n,buttonHint:{content:o,styles:{position:"center",marginTop:-90,marginLeft:10}}},styles:{textAlign:"center",width:155,marginRight:50,marginLeft:50}})}}class dm extends _n{constructor(t){super({title:J.titleScreen.levels,styles:{maxWidth:"80%",marginTop:-30,marginBottom:350}}),this.views=t}createContent(){this.createLevelButtons(),this.createNavigationButtons()}createLevelButtons(){this.addContent({levels:{content:new Xc({width:800,height:558,items:this.levels,radius:70,horPadding:7,elementsMargin:6,background:ft.levelBG}),styles:{position:"center",width:"85%",height:"70%",marginTop:-20,zIndex:-10}}})}get levels(){const t=[];for(let r=0;r<50;r+=1){const n=H.from("SmallButton-substrate"),o=13<r+1,a=new um(`${r+1}`,()=>Re.showScreen(js,{level:r+1}),o);a.x=n.width/2,a.y=n.height/2-15,n.addChild(a),n.scale.set(.87);const h=[];for(let l=0;l<3;l++){const c=H.from("Radio-bg");c.anchor.set(.5),l===0&&(c.x=40,c.y=n.height-5),l===1&&(c.x=n.width/2+10,c.y=n.height+5),l===2&&(c.x=n.width-20,c.y=n.height-5),h.push(c),n.addChild(c)}if(!o){const l=Math.round(Math.random()*3);for(let c=0;c<l;c++){const d=H.from("StarIcon"),u=h[c];d.anchor.set(.5),d.scale.set(.5),d.x=u.width/2-12,d.y=u.height/2-10,h[c].addChild(d)}}t.push(n)}return t}createNavigationButtons(){const t=new gr("HomeIcon",J.titleScreen.iconsMenu.home,()=>this.views.show(zt.pause)),e=new gr("InfoIcon",J.titleScreen.iconsMenu.info,()=>this.views.show(zt.info),Math.floor(Math.random()*10)+1),s=new gr("SettingsIcon",J.titleScreen.iconsMenu.settings,()=>this.views.show(zt.settings)),r=new gr("PlayIcon",J.titleScreen.iconsMenu.play,()=>Re.showScreen(js));this.addContent({bottomMenu:{content:{homeButton:{content:t,styles:{position:"left"}},infoButton:{content:e,styles:{position:"left",marginLeft:190}},settingsButton:{content:s,styles:{position:"right",marginRight:20}},playButton:{content:r,styles:{position:"right",marginRight:-170}}},styles:{position:"bottomCenter",marginBottom:-110,marginLeft:-10,width:"70%",height:100}}})}}class Hi extends pt{constructor(t,e){const s=new mn({defaultView:"Button",hoverView:"Button-hover",pressedView:"Button-pressed",disabledView:"Button-disabled",text:new Vt(t,{fill:ft.text,fontSize:60,fontFamily:"debussy",stroke:ft.disabledStroke,strokeThickness:8}),padding:11,animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:100},pressed:{props:{scale:{x:.9,y:.9},y:10},duration:100}}});s.onPress.connect(e),s.anchor.set(.5),super({content:s,styles:{marginTop:80,marginLeft:180,marginBottom:10}})}}class fm extends _n{constructor(t){super({title:J.titleScreen.menu.title,styles:{background:H.from("MenuWindow"),maxHeight:"80%",maxWidth:"95%"},ribbonStyles:{marginTop:-27,scale:.7}}),this.views=t}createContent(){const t=new Hi(J.titleScreen.menu.items.levels,()=>this.views.show(zt.levels)),e=new Hi(J.titleScreen.menu.items.replay,()=>{Re.showScreen(js,{restart:!0})}),s=new Hi(J.titleScreen.menu.items.settings,()=>this.views.show(zt.settings)),r=new Hi(J.titleScreen.menu.items.exit,()=>console.log("exit"));this.addContent({menu:{content:{levels:{content:t,styles:{marginTop:10}},replay:{content:e,styles:{marginTop:10}},settings:{content:s,styles:{marginTop:10}},exit:{content:r,styles:{marginTop:10}}},styles:{position:"centerTop",marginTop:120,width:"66%"}}})}}class ba extends mn{constructor(e){super({defaultView:"SmallButton-pressed",hoverView:"SmallButton-hover",disabledView:"SmallButton-disabled",icon:"CloseIcon",iconOffset:{y:-10},animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:100},pressed:{props:{scale:{x:.9,y:.9},y:10},duration:100}}});ot(this,"counter");this.onPress.connect(e),this.anchor.set(.5),this.scale.set(.8)}set notifications(e){this.counter.number.text=String(e)}}class Dh extends zc{constructor(t){super({style:{checked:Uh(t.checkboxBG,t.checkboxFG),unchecked:Uh(t.checkboxBG),text:{fill:"white",fontFamily:"debussy",fontSize:35,stroke:ft.hoverStroke,strokeThickness:6,...t.textStyle},textOffset:t.textOffset},checked:t.checked,text:t.text}),t.onChange&&this.onCheck.connect(t.onChange)}}function Uh(i,t){const e=H.from(i);if(i==="RoundSubstrate"&&e.scale.set(.4),t){const s=H.from(t);s.anchor.set(.5),s.x=e.width/2,s.y=e.height/2,i==="RoundSubstrate"&&t==="Radio"&&(s.scale.set(1.85),s.x+=37,s.y+=38),i==="RoundSubstrate"&&t==="CheckBox"&&(s.scale.set(2),s.x+=50,s.y+=30),e.addChild(s)}return e}class pm extends zc{constructor(t,e,s){super({style:{checked:Gh(!0),unchecked:Gh(!1),text:mm,textOffset:{x:-300,y:6}},checked:e,text:t}),s&&this.onCheck.connect(s)}}function Gh(i){const t=H.from("SwitchBG"),e=H.from("PauseIcon"),s=H.from("PauseIcon"),r=H.from(i?"SmallButton":"SmallButton-pressed"),n=new Vt(i?"ON":"OFF",gm);return n.anchor.set(.5),t.addChild(n),n.x=t.width/2+(i?-n.width/2-5:n.width/2+5),n.y=t.height/2,e.anchor.set(.5),e.scale.set(.8),e.x=r.width/2-13-r.width/2,e.y=r.height/2-7-r.width/2,s.anchor.set(.5),s.scale.set(.8),s.x=r.width/2+13-r.width/2,s.y=r.height/2-7-r.width/2,r.scale.set(.4),r.anchor.set(.5),r.y=t.height/2,r.x=t.width/2+(i?r.width/2:-r.width/2),t.addChild(r),r.addChild(e),r.addChild(s),t}const gm={fill:"white",fontFamily:"debussy",fontSize:27,stroke:ft.hoverStroke,strokeThickness:4},mm={fill:"white",fontFamily:"debussy",fontSize:60,stroke:ft.hoverStroke,strokeThickness:10};class _m extends hm{constructor(t){const e=new $s("SliderIcon",()=>{});e.scale.set(.45),super({bg:"SliderBG",slider:e,min:t.min,max:t.max,value:t.value}),this.onChange.connect(t.onChange)}}class ym extends pt{constructor(e){const s=[];for(let o=0;o<e.steps;o++){const a=new va(H.from("ProgressBlock"));a.onDown.connect(()=>{this.val=o+1}),s.push({id:`dot${o}`,content:{bg:{content:a.view,styles:{position:"center"}},fill:{content:H.from("ProgressBlock-fill"),styles:{position:"center"}}},styles:{width:60,height:120}})}const r=new $s("MinusIcon",()=>{this._val>0&&this.val--});r.scale.set(.65);const n=new $s("PlusIcon",()=>{this.val<e.steps&&this.val++});n.scale.set(.65);super({content:{minusButton:{content:r,styles:{position:"left",marginTop:70,marginLeft:60}},dots:{content:s,styles:{marginLeft:130,marginTop:10}},plusButton:{content:n,styles:{position:"right",marginTop:70,marginRight:-40}}},styles:{width:"77%",height:"100%",marginLeft:187}});ot(this,"_val",0);this.options=e,this.val=e.value,this.updateState()}set val(e){this._val=e,this.options.onChange(e),this.updateState()}get val(){return this._val}updateState(){var s;((s=this.content.getByID("dots"))==null?void 0:s.children).forEach((r,n)=>{const o=r.content.getByID("fill");o.visible=n<this._val})}}class xm extends _n{constructor(t){super({title:J.titleScreen.settings.title,styles:{maxWidth:"80%",marginTop:-30,marginBottom:350}}),this.views=t}createContent(){const{SFX:t,GPU:e,subtitles:s,cutScenes:r,antiAliasing:n}=J.titleScreen.settings;this.addCloseButton(),this.addSaveButton(),this.addGFX(),this.addBGM(),this.addSwitcher(t,60,420,o=>console.log(t,o),!0),this.addSwitcher(e,-290,520,o=>console.log(e,o)),this.addRadio(["2x","4x","16x"],400,470,(o,a)=>console.log(`${n} ${a}`)),this.addCheckBox(s,430,510,o=>console.log(`${s} ${o}`),!0),this.addCheckBox(r,430,570,o=>console.log(`${r} ${o}`))}addSaveButton(){const t=new Hi(J.titleScreen.settings.save,()=>{console.log("Save settings"),this.views.goBack()});this.addContent({saveButton:{content:t,styles:{position:"bottomCenter",marginBottom:-80,width:360}}})}addCloseButton(){const t=new ba(()=>this.views.goBack());this.addContent({content:t,styles:{position:"right",marginTop:50,marginRight:-80,width:t.width}})}addGFX(){this.addContent({content:{title:{content:J.titleScreen.settings.GFX,styles:{color:"white",fontFamily:"debussy",fontSize:60,position:"leftCenter",stroke:ft.hoverStroke,strokeThickness:10,maxWidth:"83%",maxHeight:"70%",overflow:"hidden",marginLeft:30,marginTop:7}},slider:{content:{low:{content:J.titleScreen.settings.low,styles:{color:"white",fontFamily:"debussy",fontSize:30}},medium:{content:J.titleScreen.settings.medium,styles:{color:"white",fontFamily:"debussy",fontSize:30,position:"centerTop"}},high:{content:J.titleScreen.settings.high,styles:{color:"white",fontFamily:"debussy",fontSize:30,position:"rightTop"}},slider:{content:new _m({min:1,max:3,value:2,onChange:t=>{console.log(`${J.titleScreen.settings.GFX} ${Math.round(t)}`)}}),styles:{position:"centerBottom",marginBottom:-40}}},styles:{width:"70%",height:"60%",position:"topRight",marginRight:30,marginTop:20}}},styles:{marginTop:120,position:"centerTop",background:H.from("Substrate")}})}addBGM(){this.addContent({content:{title:{content:J.titleScreen.settings.BGM,styles:{color:"white",fontFamily:"debussy",fontSize:60,position:"leftCenter",stroke:ft.hoverStroke,strokeThickness:10,maxWidth:"83%",maxHeight:"70%",overflow:"hidden",marginLeft:30,marginTop:7}},soundControl:{content:new ym({steps:6,value:3,onChange:t=>{console.log(`${J.titleScreen.settings.BGM} ${t}`)}}),styles:{position:"rightCenter"}}},styles:{marginTop:275,position:"centerTop",background:H.from("Substrate")}})}addSwitcher(t,e,s,r,n=!1){const o=new pm(t,n,r);this.addContent({content:{switch:{content:o,styles:{marginLeft:180,marginTop:25}}},styles:{marginTop:s,marginLeft:e,width:350,height:120}})}addCheckBox(t,e,s,r,n=!1){this.addContent({content:{switch:{content:new Dh({text:t,checked:n,checkboxBG:"RoundSubstrate",checkboxFG:"CheckBox",onChange:r,textOffset:{x:-300,y:3}}),styles:{marginLeft:280,marginTop:25}}},styles:{marginTop:s,marginLeft:e,height:80,position:"left",display:"inline"}})}addRadio(t,e,s,r){const n=t.map((o,a)=>new Dh({text:o,checked:!1,checkboxBG:"RoundSubstrate",checkboxFG:"Radio",onChange:()=>{console.log(`antiAliasing ${o}`),r(a,o)},textStyle:{fontSize:30,strokeThickness:5}}));this.addContent({aniAliasing:{content:{title:{content:J.titleScreen.settings.antiAliasing,styles:{color:"white",fontFamily:"debussy",fontSize:60,position:"leftCenter",stroke:ft.hoverStroke,strokeThickness:10,maxWidth:"83%",maxHeight:"70%",overflow:"hidden",marginTop:7,marginLeft:50}},switch:{content:new nm({items:n,type:"horizontal",elementsMargin:40,selectedItem:1}),styles:{marginTop:70,width:400,height:70}}},styles:{position:"left",marginTop:e,marginLeft:s}}})}}class vm extends _n{constructor(t){super({title:J.titleScreen.info.title,styles:{maxWidth:"80%",marginTop:-30,marginBottom:350}}),this.views=t}createContent(){this.addCloseButton(),this.addText("Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),this.addButton(J.titleScreen.info.accept,()=>{console.log(J.titleScreen.info.accept),this.views.goBack()},"Left"),this.addButton(J.titleScreen.info.decline,()=>{console.log(J.titleScreen.info.decline),this.views.goBack()},"Right")}addButton(t,e,s="Center"){const r=new Hi(t,()=>e());this.addContent({content:r,styles:{position:`bottom${s}`,marginBottom:-80,width:360,marginLeft:80,marginRight:80}})}addCloseButton(){const t=new ba(()=>{this.views.goBack()});this.addContent({content:t,styles:{position:"right",marginTop:50,marginRight:-80,width:t.width}})}addText(t){const e=H.from("SmallSubstrate");e.scale.set(1.2),this.addContent({text:{content:new Xc({width:e.width-40,height:e.height-50,radius:100,elementsMargin:20,type:"vertical",padding:50,items:[new Vt(t,{fill:ft.text,fontSize:45,fontFamily:"debussy",stroke:ft.hoverStroke,strokeThickness:3,wordWrap:!0,wordWrapWidth:e.width-100})]}),styles:{position:"center",width:e.width,height:e.height,padding:25,overflow:"hidden",background:e}}})}}const wa=class extends ya{constructor(e){super("TitleScreen");ot(this,"views");Re.addBG(),this.views=new cm,this.createWindows(e==null?void 0:e.window)}createWindows(e){this.addWindow(zt.levels,new dm(this.views)),this.addWindow(zt.pause,new fm(this.views)),this.addWindow(zt.settings,new xm(this.views)),this.addWindow(zt.info,new vm(this.views)),this.showActiveWindow(e)}addWindow(e,s){this.views.add(e,s),this.addContent({[e]:this.views.get(e)})}async showActiveWindow(e){const s=$c("window");if(s)try{await this.views.show(zt[s]);return}catch(r){console.error(r.message.replace('"undefined"',s))}await this.views.show(e??wa.defaultWindow)}};let Wi=wa;ot(Wi,"assetBundles",["game"]),ot(Wi,"defaultWindow",zt.levels);class js extends ya{constructor(e){super("GameScreen");ot(this,"energy");ot(this,"health");ot(this,"energyModificator",0);ot(this,"healthModificator",0);ot(this,"tutorialMessage");ot(this,"level",1);e!=null&&e.level&&(this.level=e.level),this.addLevel(),this.addPauseButton(),this.addHealthBar(),this.addEnergyBar(),this.addTutorialBlock()}addLevel(){this.addContent({content:`${J.gameScreen.level} ${this.level}`,styles:{position:"centerTop",color:ft.text,fontSize:50,marginTop:10,fontFamily:"debussy",maxWidth:"30%",maxHeight:"10%"}})}addPauseButton(){const e=new $s("PauseIcon",()=>{Re.showScreen(Wi,{window:zt.pause})});this.addContent({content:e,styles:{position:"bottomRight",scale:.35,maxWidth:"20%",maxHeight:"20%",marginRight:-30+10,marginBottom:-30+10}})}addHealthBar(){this.health=new zo({bg:"SmallProgressBarBG",fill:"SmallProgress-pink",fillOffset:{y:-10,x:30},progress:0}),this.addContent({content:{healthProgress:this.health,health:{content:H.from("HardIcon"),styles:{position:"left",marginLeft:-40}}},styles:{position:"right",maxWidth:"30%",maxHeight:"10%",margin:10,marginRight:10,scale:.5}})}addEnergyBar(){this.energy=new zo({bg:"SmallProgressBarBG",fill:"SmallProgress-blue",fillOffset:{y:-10,x:30},progress:0}),this.addContent({content:{energyProgress:{content:this.energy},energy:{content:H.from("EnergyIcon"),styles:{position:"left",marginLeft:-10,marginTop:-5}}},styles:{position:"left",maxWidth:"30%",maxHeight:"10%",margin:10,marginLeft:20,scale:.5}})}addTutorialBlock(){const e=new rm({target:H.from("avatar-05"),mask:"avatar_mask",borderWidth:5,borderColor:ft.border});this.tutorialMessage=new jc(J.gameScreen.tutorial.hello,"up"),this.tutorialMessage.hide(!0),setTimeout(()=>{this.tutorialMessage.show()},1e3),this.addContent({tutorialBlock:{content:{avatar:e,message:{content:this.tutorialMessage,styles:{height:1,position:"right",marginRight:-130,marginTop:-230}},closeButton:{content:new ba(()=>{const s=this.getChildByID("tutorialBlock");s.visible=!1}),styles:{position:"rightTop",marginRight:-35,marginTop:25,scale:.5}}},styles:{marginLeft:8,marginBottom:8,maxWidth:"30%",maxHeight:"30%",position:"leftBottom"}}})}onUpdate(){this.energy&&(this.energy.progress===100?this.energyModificator=-1:this.energy.progress===0&&(this.energyModificator=1),this.energy.progress+=this.energyModificator),this.health&&(this.health.progress===100?this.healthModificator=-1:this.health.progress===0&&(this.healthModificator=1),this.health.progress+=this.healthModificator)}}ot(js,"assetBundles",["game"]);class bm extends pt{constructor(){const t=H.from("spinner");t.anchor.set(.5),super({id:"LoadingSpinner",content:{spinner:{content:t,styles:{marginLeft:t.width/2,marginTop:t.height/2,marginRight:-t.width/2}},loadingText:{content:J.loadingScreen.loading,styles:{position:"center",color:ft.text,marginTop:100,fontFamily:"debussy"}}},styles:{position:"center",maxHeight:"50%",maxWidth:"60%"}})}}class Ho extends ya{constructor(){super("LoadScreen"),this.addContent({spinnerLayout:new bm,pixiLogo:zl()}),this.setStyles({background:ft.bg})}onUpdate(){const t=this.getChildByID("spinner");if(t&&t instanceof pt){const e=t.content.firstChild;e.rotation+=.05}}}ot(Ho,"assetBundles",["preload"]);const Ve=new Zo({resolution:Math.max(window.devicePixelRatio,2),backgroundColor:ft.bg});globalThis.__PIXI_APP__=Ve;function Vh(){const i=window.innerWidth,t=window.innerHeight;Ve.renderer.view.style.width=`${i}px`,Ve.renderer.view.style.height=`${t}px`,window.scrollTo(0,0),Ve.renderer.resize(i,t),Re.resize(i,t)}async function wm(){switch(document.body.appendChild(Ve.view),window.addEventListener("resize",Vh),Vh(),await np(),Re.setLoadScreen(Ho),$c("scene")){case"game":await Re.showScreen(js);break;case"load":await Re.showScreen(Ho);break;default:await Re.showScreen(Wi);break}}window.onload=wm;
